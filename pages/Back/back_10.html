<!DOCTYPE html>

<html  dir="ltr" lang="es" xml:lang="es">
<head>
    <title>D10. Autenticación, cookies y sesiones | DGHPEF</title>
    <link rel="shortcut icon" href="https://aulasvirtuales.bue.edu.ar/theme/image.php/academiaba/theme/1760202135/favicon" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="keywords" content="moodle, D10. Autenticación, cookies y sesiones | DGHPEF" />
<link rel="stylesheet" type="text/css" href="https://aulasvirtuales.bue.edu.ar/theme/yui_combo.php?rollup/3.17.2/yui-moodlesimple.css" /><script id="firstthemesheet" type="text/css">/** Required in order to fix style inclusion problems in IE with YUI **/</script><link rel="stylesheet" type="text/css" href="https://aulasvirtuales.bue.edu.ar/theme/styles.php/academiaba/1760202135_1757558579/all" />
<link rel="stylesheet" type="text/css" href="https://aulasvirtuales.bue.edu.ar/mod/book/tool/print/print.css" />
<link rel="stylesheet" href="../font.css">
<script>
//<![CDATA[
var M = {}; M.yui = {};
M.pageloadstarttime = new Date();
M.cfg = {"wwwroot":"https:\/\/aulasvirtuales.bue.edu.ar","homeurl":{},"sesskey":"zfkLncOJGS","sessiontimeout":"7200","sessiontimeoutwarning":1200,"themerev":"1760202135","slasharguments":1,"theme":"academiaba","iconsystemmodule":"core\/icon_system_fontawesome","jsrev":"1757558299","admin":"admin","svgicons":true,"usertimezone":"Am\u00e9rica\/Argentina\/Buenos_Aires","language":"es","courseId":22553,"courseContextId":2800956,"contextid":2801042,"contextInstanceId":712899,"langrev":1760772244,"templaterev":"1757558299","developerdebug":true};var yui1ConfigFn = function(me) {if(/-skin|reset|fonts|grids|base/.test(me.name)){me.type='css';me.path=me.path.replace(/\.js/,'.css');me.path=me.path.replace(/\/yui2-skin/,'/assets/skins/sam/yui2-skin')}};
var yui2ConfigFn = function(me) {var parts=me.name.replace(/^moodle-/,'').split('-'),component=parts.shift(),module=parts[0],min='-min';if(/-(skin|core)$/.test(me.name)){parts.pop();me.type='css';min=''}
if(module){var filename=parts.join('-');me.path=component+'/'+module+'/'+filename+min+'.'+me.type}else{me.path=component+'/'+component+'.'+me.type}};
YUI_config = {"debug":true,"base":"https:\/\/aulasvirtuales.bue.edu.ar\/lib\/yuilib\/3.17.2\/","comboBase":"https:\/\/aulasvirtuales.bue.edu.ar\/theme\/yui_combo.php?","combine":true,"filter":"RAW","insertBefore":"firstthemesheet","groups":{"yui2":{"base":"https:\/\/aulasvirtuales.bue.edu.ar\/lib\/yuilib\/2in3\/2.9.0\/build\/","comboBase":"https:\/\/aulasvirtuales.bue.edu.ar\/theme\/yui_combo.php?","combine":true,"ext":false,"root":"2in3\/2.9.0\/build\/","patterns":{"yui2-":{"group":"yui2","configFn":yui1ConfigFn}}},"moodle":{"name":"moodle","base":"https:\/\/aulasvirtuales.bue.edu.ar\/theme\/yui_combo.php?m\/1757558299\/","combine":true,"comboBase":"https:\/\/aulasvirtuales.bue.edu.ar\/theme\/yui_combo.php?","ext":false,"root":"m\/1757558299\/","patterns":{"moodle-":{"group":"moodle","configFn":yui2ConfigFn}},"filter":"DEBUG","modules":{"moodle-core-formchangechecker":{"requires":["base","event-focus","moodle-core-event"]},"moodle-core-lockscroll":{"requires":["plugin","base-build"]},"moodle-core-blocks":{"requires":["base","node","io","dom","dd","dd-scroll","moodle-core-dragdrop","moodle-core-notification"]},"moodle-core-tooltip":{"requires":["base","node","io-base","moodle-core-notification-dialogue","json-parse","widget-position","widget-position-align","event-outside","cache-base"]},"moodle-core-maintenancemodetimer":{"requires":["base","node"]},"moodle-core-languninstallconfirm":{"requires":["base","node","moodle-core-notification-confirm","moodle-core-notification-alert"]},"moodle-core-notification":{"requires":["moodle-core-notification-dialogue","moodle-core-notification-alert","moodle-core-notification-confirm","moodle-core-notification-exception","moodle-core-notification-ajaxexception"]},"moodle-core-notification-dialogue":{"requires":["base","node","panel","escape","event-key","dd-plugin","moodle-core-widget-focusafterclose","moodle-core-lockscroll"]},"moodle-core-notification-alert":{"requires":["moodle-core-notification-dialogue"]},"moodle-core-notification-confirm":{"requires":["moodle-core-notification-dialogue"]},"moodle-core-notification-exception":{"requires":["moodle-core-notification-dialogue"]},"moodle-core-notification-ajaxexception":{"requires":["moodle-core-notification-dialogue"]},"moodle-core-popuphelp":{"requires":["moodle-core-tooltip"]},"moodle-core-chooserdialogue":{"requires":["base","panel","moodle-core-notification"]},"moodle-core-dragdrop":{"requires":["base","node","io","dom","dd","event-key","event-focus","moodle-core-notification"]},"moodle-core-actionmenu":{"requires":["base","event","node-event-simulate"]},"moodle-core-handlebars":{"condition":{"trigger":"handlebars","when":"after"}},"moodle-core-event":{"requires":["event-custom"]},"moodle-core_availability-form":{"requires":["base","node","event","event-delegate","panel","moodle-core-notification-dialogue","json"]},"moodle-backup-confirmcancel":{"requires":["node","node-event-simulate","moodle-core-notification-confirm"]},"moodle-backup-backupselectall":{"requires":["node","event","node-event-simulate","anim"]},"moodle-course-categoryexpander":{"requires":["node","event-key"]},"moodle-course-dragdrop":{"requires":["base","node","io","dom","dd","dd-scroll","moodle-core-dragdrop","moodle-core-notification","moodle-course-coursebase","moodle-course-util"]},"moodle-course-management":{"requires":["base","node","io-base","moodle-core-notification-exception","json-parse","dd-constrain","dd-proxy","dd-drop","dd-delegate","node-event-delegate"]},"moodle-course-util":{"requires":["node"],"use":["moodle-course-util-base"],"submodules":{"moodle-course-util-base":{},"moodle-course-util-section":{"requires":["node","moodle-course-util-base"]},"moodle-course-util-cm":{"requires":["node","moodle-course-util-base"]}}},"moodle-form-passwordunmask":{"requires":[]},"moodle-form-shortforms":{"requires":["node","base","selector-css3","moodle-core-event"]},"moodle-form-dateselector":{"requires":["base","node","overlay","calendar"]},"moodle-question-chooser":{"requires":["moodle-core-chooserdialogue"]},"moodle-question-searchform":{"requires":["base","node"]},"moodle-question-preview":{"requires":["base","dom","event-delegate","event-key","core_question_engine"]},"moodle-availability_completion-form":{"requires":["base","node","event","moodle-core_availability-form"]},"moodle-availability_coursecompleted-form":{"requires":["base","node","event","moodle-core_availability-form"]},"moodle-availability_coursecompletioneabc-form":{"requires":["base","node","event","moodle-core_availability-form"]},"moodle-availability_date-form":{"requires":["base","node","event","io","moodle-core_availability-form"]},"moodle-availability_grade-form":{"requires":["base","node","event","moodle-core_availability-form"]},"moodle-availability_group-form":{"requires":["base","node","event","moodle-core_availability-form"]},"moodle-availability_grouping-form":{"requires":["base","node","event","moodle-core_availability-form"]},"moodle-availability_language-form":{"requires":["base","node","event","node-event-simulate","moodle-core_availability-form"]},"moodle-availability_profile-form":{"requires":["base","node","event","moodle-core_availability-form"]},"moodle-mod_assign-history":{"requires":["node","transition"]},"moodle-mod_attendance-groupfilter":{"requires":["base","node"]},"moodle-mod_checklist-linkselect":{"requires":["node","event-valuechange"]},"moodle-mod_customcert-rearrange":{"requires":["dd-delegate","dd-drag"]},"moodle-mod_mediagallery-base":{"requires":["base","node","selector-css3","dd-constrain","dd-proxy","dd-drop","dd-plugin","moodle-core-notification","event"]},"moodle-mod_mediagallery-mediabox":{"requires":["base","node","selector-css3"]},"moodle-mod_quiz-toolboxes":{"requires":["base","node","event","event-key","io","moodle-mod_quiz-quizbase","moodle-mod_quiz-util-slot","moodle-core-notification-ajaxexception"]},"moodle-mod_quiz-modform":{"requires":["base","node","event"]},"moodle-mod_quiz-autosave":{"requires":["base","node","event","event-valuechange","node-event-delegate","io-form"]},"moodle-mod_quiz-dragdrop":{"requires":["base","node","io","dom","dd","dd-scroll","moodle-core-dragdrop","moodle-core-notification","moodle-mod_quiz-quizbase","moodle-mod_quiz-util-base","moodle-mod_quiz-util-page","moodle-mod_quiz-util-slot","moodle-course-util"]},"moodle-mod_quiz-questionchooser":{"requires":["moodle-core-chooserdialogue","moodle-mod_quiz-util","querystring-parse"]},"moodle-mod_quiz-util":{"requires":["node","moodle-core-actionmenu"],"use":["moodle-mod_quiz-util-base"],"submodules":{"moodle-mod_quiz-util-base":{},"moodle-mod_quiz-util-slot":{"requires":["node","moodle-mod_quiz-util-base"]},"moodle-mod_quiz-util-page":{"requires":["node","moodle-mod_quiz-util-base"]}}},"moodle-mod_quiz-quizbase":{"requires":["base","node"]},"moodle-message_airnotifier-toolboxes":{"requires":["base","node","io"]},"moodle-block_xp-rulepicker":{"requires":["base","node","handlebars","moodle-core-notification-dialogue"]},"moodle-block_xp-notification":{"requires":["base","node","handlebars","button-plugin","moodle-core-notification-dialogue"]},"moodle-block_xp-filters":{"requires":["base","node","moodle-core-dragdrop","moodle-core-notification-confirm","moodle-block_xp-rulepicker"]},"moodle-filter_glossary-autolinker":{"requires":["base","node","io-base","json-parse","event-delegate","overlay","moodle-core-event","moodle-core-notification-alert","moodle-core-notification-exception","moodle-core-notification-ajaxexception"]},"moodle-filter_mathjaxloader-loader":{"requires":["moodle-core-event"]},"moodle-editor_atto-rangy":{"requires":[]},"moodle-editor_atto-editor":{"requires":["node","transition","io","overlay","escape","event","event-simulate","event-custom","node-event-html5","node-event-simulate","yui-throttle","moodle-core-notification-dialogue","moodle-core-notification-confirm","moodle-editor_atto-rangy","handlebars","timers","querystring-stringify"]},"moodle-editor_atto-plugin":{"requires":["node","base","escape","event","event-outside","handlebars","event-custom","timers","moodle-editor_atto-menu"]},"moodle-editor_atto-menu":{"requires":["moodle-core-notification-dialogue","node","event","event-custom"]},"moodle-format_trail-trailkeys":{"requires":["event-nav-keys"]},"moodle-report_eventlist-eventfilter":{"requires":["base","event","node","node-event-delegate","datatable","autocomplete","autocomplete-filters"]},"moodle-report_loglive-fetchlogs":{"requires":["base","event","node","io","node-event-delegate"]},"moodle-gradereport_history-userselector":{"requires":["escape","event-delegate","event-key","handlebars","io-base","json-parse","moodle-core-notification-dialogue"]},"moodle-qbank_editquestion-chooser":{"requires":["moodle-core-chooserdialogue"]},"moodle-tool_capability-search":{"requires":["base","node"]},"moodle-tool_lp-dragdrop-reorder":{"requires":["moodle-core-dragdrop"]},"moodle-tool_monitor-dropdown":{"requires":["base","event","node"]},"moodle-assignfeedback_editpdf-editor":{"requires":["base","event","node","io","graphics","json","event-move","event-resize","transition","querystring-stringify-simple","moodle-core-notification-dialog","moodle-core-notification-alert","moodle-core-notification-warning","moodle-core-notification-exception","moodle-core-notification-ajaxexception"]},"moodle-atto_accessibilitychecker-button":{"requires":["color-base","moodle-editor_atto-plugin"]},"moodle-atto_accessibilityhelper-button":{"requires":["moodle-editor_atto-plugin"]},"moodle-atto_align-button":{"requires":["moodle-editor_atto-plugin"]},"moodle-atto_bold-button":{"requires":["moodle-editor_atto-plugin"]},"moodle-atto_charmap-button":{"requires":["moodle-editor_atto-plugin"]},"moodle-atto_clear-button":{"requires":["moodle-editor_atto-plugin"]},"moodle-atto_collapse-button":{"requires":["moodle-editor_atto-plugin"]},"moodle-atto_emojipicker-button":{"requires":["moodle-editor_atto-plugin"]},"moodle-atto_emoticon-button":{"requires":["moodle-editor_atto-plugin"]},"moodle-atto_equation-button":{"requires":["moodle-editor_atto-plugin","moodle-core-event","io","event-valuechange","tabview","array-extras"]},"moodle-atto_fontfamily-button":{"requires":["moodle-editor_atto-plugin"]},"moodle-atto_fullscreen-button":{"requires":["event-resize","moodle-editor_atto-plugin"]},"moodle-atto_h5p-button":{"requires":["moodle-editor_atto-plugin"]},"moodle-atto_html-codemirror":{"requires":["moodle-atto_html-codemirror-skin"]},"moodle-atto_html-beautify":{},"moodle-atto_html-button":{"requires":["promise","moodle-editor_atto-plugin","moodle-atto_html-beautify","moodle-atto_html-codemirror","event-valuechange"]},"moodle-atto_htmlbootstrapeditor-button":{"requires":["moodle-editor_atto-plugin"]},"moodle-atto_image-button":{"requires":["moodle-editor_atto-plugin"]},"moodle-atto_indent-button":{"requires":["moodle-editor_atto-plugin"]},"moodle-atto_italic-button":{"requires":["moodle-editor_atto-plugin"]},"moodle-atto_link-button":{"requires":["moodle-editor_atto-plugin"]},"moodle-atto_managefiles-usedfiles":{"requires":["node","escape"]},"moodle-atto_managefiles-button":{"requires":["moodle-editor_atto-plugin"]},"moodle-atto_media-button":{"requires":["moodle-editor_atto-plugin","moodle-form-shortforms"]},"moodle-atto_mediagallery-button":{"requires":["moodle-editor_atto-plugin"]},"moodle-atto_noautolink-button":{"requires":["moodle-editor_atto-plugin"]},"moodle-atto_orderedlist-button":{"requires":["moodle-editor_atto-plugin"]},"moodle-atto_preview-button":{"requires":["moodle-editor_atto-plugin"]},"moodle-atto_recordrtc-recording":{"requires":["moodle-atto_recordrtc-button"]},"moodle-atto_recordrtc-button":{"requires":["moodle-editor_atto-plugin","moodle-atto_recordrtc-recording"]},"moodle-atto_rtl-button":{"requires":["moodle-editor_atto-plugin"]},"moodle-atto_snippet-button":{"requires":["moodle-editor_atto-plugin"]},"moodle-atto_strike-button":{"requires":["moodle-editor_atto-plugin"]},"moodle-atto_styles-button":{"requires":["moodle-editor_atto-plugin"]},"moodle-atto_subscript-button":{"requires":["moodle-editor_atto-plugin"]},"moodle-atto_superscript-button":{"requires":["moodle-editor_atto-plugin"]},"moodle-atto_table-button":{"requires":["moodle-editor_atto-plugin","moodle-editor_atto-menu","event","event-valuechange"]},"moodle-atto_title-button":{"requires":["moodle-editor_atto-plugin"]},"moodle-atto_underline-button":{"requires":["moodle-editor_atto-plugin"]},"moodle-atto_undo-button":{"requires":["moodle-editor_atto-plugin"]},"moodle-atto_unorderedlist-button":{"requires":["moodle-editor_atto-plugin"]},"moodle-atto_wordimport-button":{"requires":["moodle-editor_atto-plugin"]}}},"gallery":{"name":"gallery","base":"https:\/\/aulasvirtuales.bue.edu.ar\/lib\/yuilib\/gallery\/","combine":true,"comboBase":"https:\/\/aulasvirtuales.bue.edu.ar\/theme\/yui_combo.php?","ext":false,"root":"gallery\/1757558299\/","patterns":{"gallery-":{"group":"gallery"}}}},"modules":{"core_filepicker":{"name":"core_filepicker","fullpath":"https:\/\/aulasvirtuales.bue.edu.ar\/lib\/javascript.php\/1757558299\/repository\/filepicker.js","requires":["base","node","node-event-simulate","json","async-queue","io-base","io-upload-iframe","io-form","yui2-treeview","panel","cookie","datatable","datatable-sort","resize-plugin","dd-plugin","escape","moodle-core_filepicker","moodle-core-notification-dialogue"]},"core_comment":{"name":"core_comment","fullpath":"https:\/\/aulasvirtuales.bue.edu.ar\/lib\/javascript.php\/1757558299\/comment\/comment.js","requires":["base","io-base","node","json","yui2-animation","overlay","escape"]},"mathjax":{"name":"mathjax","fullpath":"https:\/\/cdnjs.cloudflare.com\/ajax\/libs\/mathjax\/2.7.1\/MathJax.js?config=TeX-AMS_SVG%22&delayStartupUntil=configured"}}};
M.yui.loader = {modules: {}};

//]]>
</script>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const usernameInput = document.getElementById('username');
    const placeholderText = "Nombre de usuario (El nombre de usuario es el nombre de documento, sin comas ni puntos)";
    const updatedPlaceholder = placeholderText.replace(/\(.*\)/, ""); // Remove text inside parentheses
    usernameInput.placeholder = updatedPlaceholder.trim();
  });
</script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>

<body  id="page-mod-book-print" class="format-tiles  path-mod path-mod-book chrome dir-ltr lang-es yui-skin-sam yui3-skin-sam aulasvirtuales-bue-edu-ar pagelayout-embedded course-22553 context-2801042 cmid-712899 cm-type-book category-3279 ">
<div class="toast-wrapper mx-auto py-0 fixed-top" role="status" aria-live="polite"></div>

<div>
    <a class="sr-only sr-only-focusable" href="#maincontent">Salta al contenido principal</a>
</div><script src="https://aulasvirtuales.bue.edu.ar/lib/javascript.php/1757558299/lib/polyfills/polyfill.js"></script>
<script src="https://aulasvirtuales.bue.edu.ar/theme/yui_combo.php?rollup/3.17.2/yui-moodlesimple.js"></script><script src="https://aulasvirtuales.bue.edu.ar/lib/javascript.php/1757558299/lib/javascript-static.js"></script>
<script>
//<![CDATA[
document.body.className += ' jsenabled';
//]]>
</script>


<div id="page" >
    <section class="embedded-main">
        <div role="main"><div class="book p-4">
    <div class="text-right"><a onclick="window.print();return false;" class="hidden-print" href="#"><img class="icon icon" alt="Imprimir el Libro Completo" title="Imprimir el Libro Completo" src="https://aulasvirtuales.bue.edu.ar/theme/image.php/academiaba/booktool_print/1760202135/book" />Imprimir el Libro Completo</a></div>
    <div class="text-center pb-3 book_title"><h1>D10. Autenticación, cookies y sesiones</h1></div>
    <div class="book_info w-100 pt-6 d-inline-block">
        <div class="w-50 float-left">
            <table>
                <tr>
                    <td>
                        Sitio:
                    </td>
                    <td class="pl-3">
                        <a href="https://aulasvirtuales.bue.edu.ar">Agencia de Habilidades para el Futuro</a>
                    </td>
                </tr>
                <tr>
                    <td>
                        Curso:
                    </td>
                    <td class="pl-3">
                        Desarrollo de Sistemas Web (Back End) - 2° A
                    </td>
                </tr>
                <tr>
                    <td>
                        Libro:
                    </td>
                    <td class="pl-3">
                        D10. Autenticación, cookies y sesiones
                    </td>
                </tr>
            </table>
        </div>
        <div class="w-50 float-left">
            <table class="float-right">
                <tr>
                    <td>
                        Imprimido por:
                    </td>
                    <td class="pl-3">
                        Román Ríos
                    </td>
                </tr>
                <tr>
                    <td>
                        Día:
                    </td>
                    <td class="pl-3">
                        lunes, 20 de octubre de 2025, 08:24
                    </td>
                </tr>
            </table>
        </div>
    </div>
    <div class="w-100 book_description">
        <div class="py-5">
            <h2 class="text-center pb-5">Descripción</h2>
             <p class="book_summary"><article class="flex_titulo_botonera">
    <p class="titulo_principal"></p>

    <section class="botonera_posicion" id="botonera">
        <section class="columna_centrada">
            <!-- <p>Barra de navegación</p> -->
            <article class="touch_point">

                <a href="https://aulasvirtuales.bue.edu.ar/course/view.php?id=22553&amp;section=14" class="link">
                    <section class="boton_texto_centrado">
                        <div class="circulo_inicio">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-house" viewBox="0 0 16 16">
                                <path d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V8.207l.646.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293zM13 7.207V13.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V7.207l5-5z"></path>
                              </svg>
                        </div>
                        <p>Inicio</p>
                    </section>
                </a>
                <a href="https://aulasvirtuales.bue.edu.ar/mod/page/view.php?id=712898" class="link">
                    <section class="boton_texto_centrado link">
                        <div class="circulo_apertura">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-book" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M5.828 10.172a.5.5 0 0 0-.707 0l-4.096 4.096V11.5a.5.5 0 0 0-1 0v3.975a.5.5 0 0 0 .5.5H4.5a.5.5 0 0 0 0-1H1.732l4.096-4.096a.5.5 0 0 0 0-.707zm4.344 0a.5.5 0 0 1 .707 0l4.096 4.096V11.5a.5.5 0 1 1 1 0v3.975a.5.5 0 0 1-.5.5H11.5a.5.5 0 0 1 0-1h2.768l-4.096-4.096a.5.5 0 0 1 0-.707zm0-4.344a.5.5 0 0 0 .707 0l4.096-4.096V4.5a.5.5 0 1 0 1 0V.525a.5.5 0 0 0-.5-.5H11.5a.5.5 0 0 0 0 1h2.768l-4.096 4.096a.5.5 0 0 0 0 .707zm-4.344 0a.5.5 0 0 1-.707 0L1.025 1.732V4.5a.5.5 0 0 1-1 0V.525a.5.5 0 0 1 .5-.5H4.5a.5.5 0 0 1 0 1H1.732l4.096 4.096a.5.5 0 0 1 0 .707z"></path>
</svg>
                        </div>
                        <p>Apertura</p></section></a><section class="boton_texto_centrado"><a href="https://aulasvirtuales.bue.edu.ar/mod/book/view.php?id=712899" class="link">
                        <div class="circulo_desarrollo_activa">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-layout-text-sidebar-reverse" viewBox="0 0 16 16">
   <path d="M3.05 3.05a7 7 0 0 0 0 9.9.5.5 0 0 1-.707.707 8 8 0 0 1 0-11.314.5.5 0 0 1 .707.707zm2.122 2.122a4 4 0 0 0 0 5.656.5.5 0 1 1-.708.708 5 5 0 0 1 0-7.072.5.5 0 0 1 .708.708zm5.656-.708a.5.5 0 0 1 .708 0 5 5 0 0 1 0 7.072.5.5 0 1 1-.708-.708 4 4 0 0 0 0-5.656.5.5 0 0 1 0-.708zm2.122-2.12a.5.5 0 0 1 .707 0 8 8 0 0 1 0 11.313.5.5 0 0 1-.707-.707 7 7 0 0 0 0-9.9.5.5 0 0 1 0-.707zM10 8a2 2 0 1 1-4 0 2 2 0 0 1 4 0z"></path>
</svg>
                        </div>
                        </a><p>Desarrollo</p></section>

                <a href="https://aulasvirtuales.bue.edu.ar/mod/book/view.php?id=712900" class="link">
                    <section class="boton_texto_centrado">
                        <div class="circulo_practicas">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-chat-square-text" viewBox="0 0 16 16">
                      <path d="M8 9.5a2 2 0 1 0 0-4 2 2 0 0 0 0 4z"></path>
  <path d="M9.5 2c-.9 0-1.75.216-2.501.6A5 5 0 0 1 13 7.5a6.5 6.5 0 1 1-13 0 .5.5 0 0 1 1 0 5.5 5.5 0 0 0 8.001 4.9A5 5 0 0 1 3 7.5a6.5 6.5 0 0 1 13 0 .5.5 0 0 1-1 0A5.5 5.5 0 0 0 9.5 2zM8 3.5a4 4 0 1 0 0 8 4 4 0 0 0 0-8z"></path>
</svg>
                        </div>
                        <p>Práctica</p>
                    </section>
                </a>

                <a href="https://aulasvirtuales.bue.edu.ar/mod/page/view.php?id=712901" class="link">
                    <section class="boton_texto_centrado">
                        <div class="circulo_cierre">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-eject" viewBox="0 0 16 16">
 <path fill-rule="evenodd" d="M0 3.5A.5.5 0 0 1 .5 3H1c2.202 0 3.827 1.24 4.874 2.418.49.552.865 1.102 1.126 1.532.26-.43.636-.98 1.126-1.532C9.173 4.24 10.798 3 13 3v1c-1.798 0-3.173 1.01-4.126 2.082A9.624 9.624 0 0 0 7.556 8a9.624 9.624 0 0 0 1.317 1.918C9.828 10.99 11.204 12 13 12v1c-2.202 0-3.827-1.24-4.874-2.418A10.595 10.595 0 0 1 7 9.05c-.26.43-.636.98-1.126 1.532C4.827 11.76 3.202 13 1 13H.5a.5.5 0 0 1 0-1H1c1.798 0 3.173-1.01 4.126-2.082A9.624 9.624 0 0 0 6.444 8a9.624 9.624 0 0 0-1.317-1.918C4.172 5.01 2.796 4 1 4H.5a.5.5 0 0 1-.5-.5z"></path>
  <path d="M13 5.466V1.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384l-2.36 1.966a.25.25 0 0 1-.41-.192zm0 9v-3.932a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384l-2.36 1.966a.25.25 0 0 1-.41-.192z"></path>
</svg>
                        </div>

                        <p st="">Cierre</p>

                    </section>
                </a>

            </article>
        </section>
    </section>
</article>
<script>
    document.addEventListener("DOMContentLoaded", function() {

        let pantallaDesktop = window.innerWidth;
        let pantallaCelular = 700;

        if (pantallaDesktop < pantallaCelular) {
            document.getElementById("botonera").style.display = "none"
        }
    });
</script></p>
        </div>
    </div>
    <div class="w-100">
        <div class="py-5"><div class="book_toc_numbered"><a name="toc"></a><h2 class="text-center pb-5">Tabla de contenidos</h2><ul><li><a title="1. Preguntas Iniciales" class="font-weight-bold text-decoration-none" href="#ch209511">1. Preguntas Iniciales</a></li><li><a title="2. Autenticación y autorización" class="font-weight-bold text-decoration-none" href="#ch209472">2. Autenticación y autorización</a></li><li><a title="3. Autenticación" class="font-weight-bold text-decoration-none" href="#ch209473">3. Autenticación</a></li><li><a title="4. Autorización" class="font-weight-bold text-decoration-none" href="#ch209474">4. Autorización</a></li><li><a title="5. Json Web Token (JWT)" class="font-weight-bold text-decoration-none" href="#ch209475">5. Json Web Token (JWT)</a><ul><li><a title="5.1. Base 64" class="text-decoration-none" href="#ch209476">5.1. Base 64</a></li><li><a title="5.2. Campos" class="text-decoration-none" href="#ch209477">5.2. Campos</a></li><li><a title="5.3. Token JWT en Node" class="text-decoration-none" href="#ch209478">5.3. Token JWT en Node</a></li><li><a title="5.4. RSA 256" class="text-decoration-none" href="#ch209479">5.4. RSA 256</a></li><li><a title="5.5. ¿Cómo firmar un token JWT con RSA 256?" class="text-decoration-none" href="#ch209480">5.5. ¿Cómo firmar un token JWT con RSA 256?</a></li><li><a title="5.6. Expiración de tokens" class="text-decoration-none" href="#ch209481">5.6. Expiración de tokens</a></li><li><a title="5.7. Buenas prácticas al utilizar JWT" class="text-decoration-none" href="#ch209482">5.7. Buenas prácticas al utilizar JWT</a></li></ul></li><li><a title="6. Ejemplo de autenticación y autorización con nodejs, express, JWT y mongoDB" class="font-weight-bold text-decoration-none" href="#ch209483">6. Ejemplo de autenticación y autorización con nodejs, express, JWT y mongoDB</a><ul><li><a title="6.1. Creación del proyecto" class="text-decoration-none" href="#ch209484">6.1. Creación del proyecto</a></li><li><a title="6.2. Referencias entre colecciones" class="text-decoration-none" href="#ch209485">6.2. Referencias entre colecciones</a></li><li><a title="6.3. Esquema de Mongoose para usuarios" class="text-decoration-none" href="#ch209486">6.3. Esquema de Mongoose para usuarios</a></li><li><a title="6.4. Creando usuarios" class="text-decoration-none" href="#ch209487">6.4. Creando usuarios</a></li><li><a title="6.5. Usuarios únicos" class="text-decoration-none" href="#ch209488">6.5. Usuarios únicos</a></li><li><a title="6.6. Creación de una nueva publicación" class="text-decoration-none" href="#ch209489">6.6. Creación de una nueva publicación</a></li><li><a title="6.7. Combinar usuarios y posts" class="text-decoration-none" href="#ch209490">6.7. Combinar usuarios y posts</a></li><li><a title="6.8. Autenticación de usuarios con token" class="text-decoration-none" href="#ch209491">6.8. Autenticación de usuarios con token</a></li><li><a title="6.9. Limitación de la creación de nuevos posts a los usuarios registrados" class="text-decoration-none" href="#ch209492">6.9. Limitación de la creación de nuevos posts a los usuarios registrados</a></li><li><a title="6.10. Bearer" class="text-decoration-none" href="#ch209493">6.10. Bearer</a></li><li><a title="6.11. Manejo de errores" class="text-decoration-none" href="#ch209494">6.11. Manejo de errores</a></li></ul></li><li><a title="7. Caché, cookies y sesiones" class="font-weight-bold text-decoration-none" href="#ch209495">7. Caché, cookies y sesiones</a><ul><li><a title="7.1. Qué son las cookies y las sesiones" class="text-decoration-none" href="#ch209496">7.1. Qué son las cookies y las sesiones</a></li></ul></li><li><a title="8. Passport" class="font-weight-bold text-decoration-none" href="#ch209497">8. Passport</a><ul><li><a title="8.1. Autenticar Aplicaciones Node.js con Passport" class="text-decoration-none" href="#ch209498">8.1. Autenticar Aplicaciones Node.js con Passport</a></li><li><a title="8.2. Creación del modelo de Mongoose" class="text-decoration-none" href="#ch209499">8.2. Creación del modelo de Mongoose</a></li><li><a title="8.3. Configuración" class="text-decoration-none" href="#ch209500">8.3. Configuración</a></li><li><a title="8.4. Serializar y deserializar instancias de usuario" class="text-decoration-none" href="#ch209501">8.4. Serializar y deserializar instancias de usuario</a></li><li><a title="8.5. Uso de estrategias de Passport" class="text-decoration-none" href="#ch209502">8.5. Uso de estrategias de Passport</a></li><li><a title="8.6. Estrategia de acceso" class="text-decoration-none" href="#ch209503">8.6. Estrategia de acceso</a></li><li><a title="8.7. Estrategia de registro" class="text-decoration-none" href="#ch209504">8.7. Estrategia de registro</a></li><li><a title="8.8. Creación de rutas" class="text-decoration-none" href="#ch209505">8.8. Creación de rutas</a></li><li><a title="8.9. Creación de vistas de Jade" class="text-decoration-none" href="#ch209506">8.9. Creación de vistas de Jade</a></li><li><a title="8.10. Continuando con vistas de Jade" class="text-decoration-none" href="#ch209507">8.10. Continuando con vistas de Jade</a></li><li><a title="8.11. Implementación de la funcionalidad de cierre de sesión" class="text-decoration-none" href="#ch209508">8.11. Implementación de la funcionalidad de cierre de sesión</a></li><li><a title="8.12. Proteger las rutas" class="text-decoration-none" href="#ch209509">8.12. Proteger las rutas</a></li><li><a title="8.13. Probar la aplicación con Passport" class="text-decoration-none" href="#ch209510">8.13. Probar la aplicación con Passport</a></li></ul></li></ul></div></div>
    </div>
    <div class="w-100">
            <div class="pb-5">
            <div class="book_chapter pt-3" id="ch209511"><article class="flex_titulo_botonera" style="background-color: #E6E1E5;">
    <p class="titulo_principal" style="margin: 0 3%;">Preguntas iniciales</p>
</article>

<div style="background-color: rgb(250, 250, 250);">
    <br>
    <div style="margin-left: 3%; margin-right: 3%;">
        <p style="color: rgb(1, 6, 20); font-size: large;">En esta semana aprenderemos sobre la autenticación y autorización de usuarios, y cómo implementarlas en nuestros servidores web.&nbsp;</p>

        <!-- Título de la sección de preguntas orientadoras -->
        <div style="color: rgb(1, 6, 20); font-size: large; display: inline-block; border-radius: 8px; overflow: hidden; border: 1px solid rgb(154, 50, 130);">
            <p style="background-color: #9A3282; color: white; padding: 4px 16px; margin: 0;"><span style="font-size: large;"><b>¿Que es una autenticacion?</b></span></p>
            <div style="background-color: white; padding: 16px;">
                <p style="font-size: large; color: #010614;">Es el proceso de confirmación de identidad de una persona o servicio, y la&nbsp;<span>autorización</span>&nbsp;es el proceso de revisión de permisos para utilizar algún recurso o realizar una acción. Crearemos la típica página de login
                    para registrar a nuestros usuarios. Utilizaremos&nbsp;<span><span class="" style="color: rgb(0, 61, 245);">Passport</span></span>&nbsp;para realizar esta tarea y veremos algunos conceptos de seguridad como&nbsp;<span class="" style="color: rgb(0, 61, 245);">JSON Web Token</span>&nbsp;para
                    dar más seguridad a nuestras APIs.</p>
            </div>
        </div>

        <br>

        <!-- Preguntas orientadoras con estilo de viñetas -->
        <div style="background-color: rgb(250, 250, 250);"><br></div>
        <div style="background-color:#87CEEB; display: inline-flex; height: 6px;">
    <p style="font-size: x-large; color: #010614; margin-top: -22px; padding-right: 4px;">Preguntas Orientadoras</p>
</div>

        <div style="background-color: rgb(250, 250, 250);"><br></div>
        <div style="background-color: rgb(250, 250, 250);">
            <ul>
                <li><span style="color: rgb(1, 6, 20); font-size: large;">¿Qué es la autenticación y cómo se puede implementar en una aplicación Node.js?</span></li>
                <li><span style="color: rgb(1, 6, 20); font-size: large;">¿Cómo se implementa la autenticación y autorización en una aplicación web basada en Node.js, Express y MongoDB?</span></li>
                <li><span style="color: rgb(1, 6, 20); font-size: large;">¿Qué es JSON Web Token (JWT) y cómo se utiliza en el proceso de autenticación?</span></li>
                <li><span style="color: rgb(1, 6, 20); font-size: large;">¿Cómo funciona Passport en Node.js y cómo se integra para manejar la autenticación de usuarios?</span></li>
                <li><span style="color: rgb(1, 6, 20); font-size: large;">¿Qué medidas de seguridad deben tomarse para proteger las contraseñas de los usuarios en la base de datos MongoDB?</span></li>
                <li><span style="color: rgb(1, 6, 20); font-size: large;">¿Cómo manejar los permisos y roles de los usuarios en una aplicación web y cómo se implementa la autorización</span></li>
            </ul>

        </div>
    </div>
</div>

<script>
    function copyCodeToClipboard(index) {
        var codeToCopy = document.getElementById("codeContainer" + index).innerText;
        navigator.clipboard.writeText(codeToCopy).then(function() {
            var copyIcon = document.getElementById('copyIcon' + index);
            var copyText = document.getElementById('copyText' + index);
            copyIcon.innerHTML = `
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check" viewBox="0 0 16 16" style="vertical-align: middle;">
                    <path fill-rule="evenodd" d="M10.854 7.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7.5 9.793l2.646-2.647a.5.5 0 0 1 .708 0"/>
                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"/>
                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"></path>
            `;
            copyText.textContent = 'Copiado';
            setTimeout(function() {
                copyIcon.innerHTML = `
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16" style="vertical-align: middle;">
                        <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"/>
                        <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"></path>
                `;
                copyText.textContent = 'Copiar código';
            }, 2000);
        }, function(err) {
            console.error('Error al copiar el código: ', err);
        });
    }
</script></div>
            </div>
            <div class="pb-5">
            <div class="book_chapter pt-3" id="ch209472"><article class="flex_titulo_botonera" style="background-color: #E6E1E5;">
    <p class="titulo_principal">Autenticación y autorización</p>
</article>
<div style="background-color: #FAFAFA; font-size: large; color: #010614 ;">
    <br>
    <div style="margin-left: 3%; margin-right: 3%;">



        <p></p><span id="docs-internal-guid-4f2cf2db-7fff-b4ff-649a-ba4ffbb8a431"><p dir="ltr" style="">Solemos confundir los conceptos <span class="" style="color: rgb(0, 46, 184);">autenticación </span>y <span class="" style="color: rgb(0, 46, 184);">autorización </span>con
        bastante frecuencia. Si bien son igual de importantes, la realidad es que son muy diferentes. Como dijimos, autenticación es el proceso de verificación de la identidad de un individuo o servicio, mientras que autorización es el proceso de evaluar
        los permisos necesarios para acceder a un recurso específico o realizar una acción específica.&nbsp;&nbsp;</p>
        <div style="background-color: #FFFEEB; border-right: 6px solid #5811BB; padding: 10px;">
            <p style="text-align: right;">Mientras que la autenticación se enfoca en determinar que el usuario es quien dice ser, la autorización se encarga de controlar qué acciones ese usuario puede realizar.</p>
        </div>

        <p dir="ltr" style=""><br></p>
        <p dir="ltr" style="">En otras palabras, la autenticación se utiliza para iniciar sesión en un sistema y la autorización se utiliza para determinar qué acciones puede realizar un usuario una vez que se ha autenticado.&nbsp;</p>
        <p dir="ltr" style="text-align: center; font-weight: bold;"><img src="https://aulasvirtuales.bue.edu.ar/pluginfile.php/2801042/mod_book/chapter/209472/00101010.png" alt="" width="865" height="318" role="presentation" class="img-responsive atto_image_button_text-bottom"></p>
       <!--Caja + Ejemplo + sin imagen + texto-->
<div style="position: relative; border-radius: 8px; border: 1px solid #ae11a0; background-color: white; padding-top: 16px;">
    <p style="color: white; background-color: #ae11a0; padding: 4px 16px; border-radius: 8px; position: absolute; top: -16px; left: 16px; z-index: 1;">
        <span class="" style="font-size: large;"><b><span class="" style="font-size: large;">Ejemplo</span></b></span>
    </p>
    <div style="margin: 32px 8px 16px 8px; display: flex; align-items: center;">
        <div class="col" style="">
            <p style="">En un sitio web de una universidad, los profesores podrían tener acceso para cargar las notas de los estudiantes, mientras que los estudiantes sólo podrían ver las notas cargadas, pero no editarlas. En este caso, se autenticaría a los usuarios al momento del inicio de sesión y se autorizaría a los usuarios de acuerdo a su rol (profesor o alumno) para acceder a los recursos correspondientes.<br></p>
            <ul style="color: rgb(1, 6, 20);">
            </ul>
            <p style="color: rgb(1, 6, 20);"></p>
        </div>
    </div>
</div>
<!--Fin Caja + Ejemplo + imagen + texto-->
<br>



        <!-- nada puede haber abajo -->
        <br>
    </span></div>
</div></div>
            </div>
            <div class="pb-5">
            <div class="book_chapter pt-3" id="ch209473"><article class="flex_titulo_botonera" style="background-color: #E6E1E5;">
    <p class="titulo_principal">Autenticación</p>
</article>

<div style="background-color: #FAFAFA; font-size: large; color: #010614;">
    <br>
    <div style="margin-left: 3%; margin-right: 3%;">

        <p>Pensemos, por ejemplo, en una aplicación como Facebook y en cómo maneja la autenticación. Cuando iniciamos sesión con nuestro correo electrónico y clave, Facebook está autenticándonos, es decir, está comprobando que la contraseña ingresada coincide
            con la contraseña que se asoció a nuestro correo electrónico. En tanto la contraseña coincida, podremos acceder a la aplicación. Pero si no coincide, Facebook no nos permitirá iniciar sesión porque no puede asegurar que somos quienes decimos
            ser.
        </p>

        <div style="display: inline-block; border-radius: 8px; overflow: hidden; border: 1px solid #9A3282;">
            <p style="background-color: #9A3282; color: white; padding: 4px 16px; margin: 0;">
                <span style="font-size: large;"><b>Autenticación</b></span>
            </p>
            <div style="background-color: white; padding: 16px;">
                <p><span style="font-size: large; color: #010614;">Es el proceso mediante el cual se verifica la identidad de una persona que intenta acceder a un sistema. Esto se logra proporcionando credenciales, como un nombre de usuario y contraseña. Una vez que el sistema recibe estas credenciales, determina si la persona es quien afirma ser. La forma más común de autenticación es a través de una página de inicio de sesión, pero también existen métodos más avanzados y seguros que utilizan varios factores de verificación. Por ejemplo, es común recibir un código de verificación enviado a través de un mensaje de texto o correo electrónico para confirmar la identidad del usuario.</span></p>
            </div>
        </div>
        <br>
     <br>
        <div style="background-color:#87CEEB; display: inline-flex; height: 6px;">
       
            <p style="font-size: x-large; color: #010614; margin-top: -22px; padding-right: 4px">Métodos de autenticación más utilizados</p>
        </div>

        <p><br></p>
        <p>Hemos mencionado uno de los métodos más utilizados: el <span style="color: rgb(0, 46, 184);">MFA o autenticación multifactor</span>. Veamos otros métodos populares:</p>

        <br>

        <!-- 1 -->
        <div class="row" style="margin-left: 32px">
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-1-circle-fill" viewBox="0 0 16 16" style="color: #3c80b3;">
                    <path d="M5 3.5h6A1.5 1.5 0 0 1 12.5 5v6a1.5 1.5 0 0 1-1.5 1.5H5A1.5 1.5 0 0 1 3.5 11V5A1.5 1.5 0 0 1 5 3.5"></path>
                </svg>
            </div>
            <div class="col">
                <p><span style="font-weight: 600; font-size: large; color: rgb(51, 51, 51);">Sin contraseña o Passwordless:</span> Uno de los métodos modernos más prácticos. Un ejemplo de aplicación es el uso de un enlace mágico (magic link), que consiste
                    en que, cada vez que queramos iniciar sesión a un recurso o servicio, se enviará a nuestro correo electrónico un enlace que nos permitirá acceder sin necesidad de contraseña. Este es un método recomendable, ya que se necesita del acceso
                    al correo electrónico y, por ende, hay más garantías de asegurar que es el propio usuario quien está accediendo. Sin embargo, corre el riesgo de que, si el usuario pierde el acceso al correo electrónico, o este es vulnerado por un
                    atacante, ya no pueda ingresar a la aplicación.</p>
            </div>
        </div>

        <!-- 2 -->
        <div class="row" style="margin-left: 32px">
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-2-circle-fill" viewBox="0 0 16 16" style="color: #3c80b3;">
                    <path d="M5 3.5h6A1.5 1.5 0 0 1 12.5 5v6a1.5 1.5 0 0 1-1.5 1.5H5A1.5 1.5 0 0 1 3.5 11V5A1.5 1.5 0 0 1 5 3.5"></path>
                </svg>
            </div>
            <div class="col">
                <p><span style="font-weight: 600; font-size: large; color: rgb(51, 51, 51);">Por redes sociales:</span> Varias aplicaciones y servicios dan como opción iniciar sesión directamente con alguna cuenta social. La ventaja principal es que no hace
                    falta crear una cuenta aparte de forma manual, directamente los datos de esa cuenta social hacen ese paso al iniciar la sesión. Las plataformas sociales más utilizadas son Facebook, Twitter y Google. De esta forma podremos iniciar
                    sesión en programas o páginas de forma más rápida, sin tener que registrarnos.</p>
            </div>
        </div>

        <!-- 3 -->
        <div class="row" style="margin-left: 32px">
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-3-circle-fill" viewBox="0 0 16 16" style="color: #3c80b3;">
                    <path d="M5 3.5h6A1.5 1.5 0 0 1 12.5 5v6a1.5 1.5 0 0 1-1.5 1.5H5A1.5 1.5 0 0 1 3.5 11V5A1.5 1.5 0 0 1 5 3.5"></path>
                </svg>
            </div>
            <div class="col">
                <p><span style="font-weight: 600; font-size: large; color: rgb(51, 51, 51);">Autenticación API:</span> Este es el proceso de certificar la identidad de un usuario que quiera acceder a recursos y/o servicios en el servidor. Para tener en cuenta,
                    alguna de las APIs de autenticación más populares son: autenticación básica por HTTP, de Core (núcleo) API y OAuth.</p>
            </div>
        </div>

        <!-- 4 -->
        <div class="row" style="margin-left: 32px">
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-4-circle-fill" viewBox="0 0 16 16" style="color: #3c80b3;">
                    <path d="M5 3.5h6A1.5 1.5 0 0 1 12.5 5v6a1.5 1.5 0 0 1-1.5 1.5H5A1.5 1.5 0 0 1 3.5 11V5A1.5 1.5 0 0 1 5 3.5"></path>
                </svg>
            </div>
            <div class="col">
                <p><span style="font-weight: 600; font-size: large; color: rgb(51, 51, 51);">Autenticación Biométrica:</span> Se vale de las huellas dactilares para validar la identidad del usuario. Esa huella es validada mediante un previo registro de la
                    misma que se almacena en la base de datos. Es cada vez más utilizado este método en dispositivos móviles, para iniciar sesión, realizar un pago, etc.</p>
            </div>
        </div>

    </div>
</div></div>
            </div>
            <div class="pb-5">
            <div class="book_chapter pt-3" id="ch209474"><article class="flex_titulo_botonera" style="background-color: #E6E1E5;">
    <p class="titulo_principal">Autorización</p>
</article>

<div style="background-color: #FAFAFA; font-size: large; color: #010614;">
    <br>
    <div style="margin-left: 3%; margin-right: 3%;">

        <p>La autorización es el proceso de evaluar los permisos necesarios para acceder a un recurso específico o realizar una acción específica. Es lo que define a qué recursos de sistema el usuario autenticado podrá acceder.</p>

        <div style="background-color:#87CEEB; display: inline-flex; height: 6px;">
            <p style="font-size: x-large; color: #010614; margin-top: -22px; padding-right: 4px;">Métodos de autorización más utilizados</p>
        </div>

        <div style="margin-left: 3%; margin-right: 3%;"><br></div>

        <!-- 1 -->
        <div class="row" style="margin-left: 32px">
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-1-circle-fill" viewBox="0 0 16 16" style="color: #3c80b3;">
                    <path d="M5 3.5h6A1.5 1.5 0 0 1 12.5 5v6a1.5 1.5 0 0 1-1.5 1.5H5A1.5 1.5 0 0 1 3.5 11V5A1.5 1.5 0 0 1 5 3.5"></path>
                </svg>
            </div>
            <br>
            <div class="col">
                <p><span style="font-weight: 600; font-size: large; color: rgb(51, 51, 51);">Autorización HTTP:</span> Así como la autenticación, existe la autorización de tipo HTTP. ¿En qué consiste? La persona ingresa su nombre de usuario y contraseña
                    para poder autenticarse. Es bueno tener presente que este método no implica a las cookies, IDs de sesiones o páginas de inicio de sesión. Este puede ser usado por servidores para revisar solicitudes, y por parte de un cliente para
                    proveer información de autentificación. Para realizar esto, el servidor responde al usuario con un 401 «Unauthorized», el cual también le proporciona al usuario toda la información para que conozca el método de autorización. Luego,
                    el cliente que se quiera autorizar puede hacerlo con una solicitud «Authorization», y sus credenciales. Lo más normal es que el cliente haga una solicitud mediante un usuario y contraseña, en donde se incluye un encabezado «Authorization»
                    directo al servidor.</p>
            </div>
        </div>

        <!-- 2 -->
        <div class="row" style="margin-left: 32px">
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-2-circle-fill" viewBox="0 0 16 16" style="color: #3c80b3;">
                    <path d="M5 3.5h6A1.5 1.5 0 0 1 12.5 5v6a1.5 1.5 0 0 1-1.5 1.5H5A1.5 1.5 0 0 1 3.5 11V5A1.5 1.5 0 0 1 5 3.5"></path>
                </svg>
            </div>
            <div class="col">
                <p><span style="font-weight: 600; font-size: large; color: rgb(51, 51, 51);">Autorización API:</span> Así como la autenticación, existe la autorización de tipo API. Cuando el usuario intenta ganar acceso a recursos de un sistema durante su
                    registro, se genera una clave API. Esa misma clave se empareja con un token (una ficha identificadora) que se encuentra oculto. Entonces, esa combinación de clave API y token oculto es la que se utiliza constantemente cada vez que
                    el usuario se autentica e ingresa a su entorno de recursos y servicios que puede utilizar. Estas se implementan para definir lo que el cliente debe hacer para enviar una solicitud al servidor, y para definir la respuesta que este recibe.</p>
            </div>
        </div>

        <!-- 3 -->
        <div class="row" style="margin-left: 32px">
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-3-circle-fill" viewBox="0 0 16 16" style="color: #3c80b3;">
                    <path d="M5 3.5h6A1.5 1.5 0 0 1 12.5 5v6a1.5 1.5 0 0 1-1.5 1.5H5A1.5 1.5 0 0 1 3.5 11V5A1.5 1.5 0 0 1 5 3.5"></path>
                </svg>
            </div>
            <div class="col">
                <p><span style="font-weight: 600; font-size: large; color: rgb(51, 51, 51);">OAuth 2.0:</span> Este método permite que la API se autentique y acceda a los recursos del sistema que necesita. La versión 2.0 de OAuth es uno de los métodos más
                    seguros tanto de autenticación como autorización. Funciona de forma que el usuario delega la función de realizar algunas acciones, a las cuales da su consentimiento para realizarlas a su nombre.</p>
            </div>
        </div>

        <!-- 4 -->
        <div class="row" style="margin-left: 32px">
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-4-circle-fill" viewBox="0 0 16 16" style="color: #3c80b3;">
                    <path d="M5 3.5h6A1.5 1.5 0 0 1 12.5 5v6a1.5 1.5 0 0 1-1.5 1.5H5A1.5 1.5 0 0 1 3.5 11V5A1.5 1.5 0 0 1 5 3.5"></path>
                </svg>
            </div>
            <div class="col">
                <p><span style="font-weight: 600; font-size: large; color: rgb(51, 51, 51);">Autorización JWT (Json Web Token):</span> Es un estándar abierto que se utiliza para la transmisión segura de datos entre distintas partes. Tiene soporte tanto para
                    la autenticación como para la autorización. JWT es utilizada comúnmente para la autorización, y se vale un par de claves público-privada. Es decir, ese par contiene una clave privada y una pública.</p>
            </div>
        </div>

        <!-- Cuadro amarillo borde violeta -->
        <br>

        <div style="background-color: #FFFEEB; border-top: 2px solid #460E95; width: 96%; margin: 0 auto;">
            <div style="margin:16px">
                <p style="color: #5811BB; font-size: large; font-weight: 600">Seguridad del Sistema</p>
                <p style="color: #010614 ; font-size: large; padding-bottom: 16px; margin-top: -12px">
                    Es el resultado de la combinación de autenticación y autorización, por lo que es importante considerar ambos aspectos al desarrollar un proyecto web. Ambos procesos de seguridad proveen capas adicionales de protección a los sistemas y los recursos. Esta
                    protección extra permite que se prevengan numerosos ciberataques que perjudican especialmente a los usuarios.
                </p>
            </div>
        </div>
        <br>
        <!-- Fin Cuadro amarillo borde violeta -->


    </div>
</div></div>
            </div>
            <div class="pb-5">
            <div class="book_chapter pt-3" id="ch209475"><article class="flex_titulo_botonera" style="background-color: #E6E1E5;">
    <p class="titulo_principal">Json Web Token (JWT)</p>
</article>
<div style="background-color: #FAFAFA; font-size: large; color: #010614;">
    <br>
    <div style="margin-left: 3%; margin-right: 3%;">

        <p><span><span style=""><span class="" style="color: rgb(0, 61, 245);">JSON Web Token (JWT)</span></span><span class="" style="color: rgb(0, 61, 245);"> </span></span>es un estándar abierto que permite la creación de tokens de seguridad para autenticar y autorizar a los usuarios en aplicaciones web y servicios. JWT puede ser utilizado en dos formas: como <span class="" style="color: rgb(0, 61, 245);">JSON Web Signature (JWS) o como JSON Web Encryption (JWE).</span></p>

        <!-- Inicio de viñetas personalizadas -->
        <!-- 1 -->
        <div class="row" style="margin-left: 32px">
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-1-circle-fill" viewBox="0 0 16 16" style=" color: #3c80b3">
                    <path d="M5 3.5h6A1.5 1.5 0 0 1 12.5 5v6a1.5 1.5 0 0 1-1.5 1.5H5A1.5 1.5 0 0 1 3.5 11V5A1.5 1.5 0 0 1 5 3.5"></path>
                </svg>
            </div>
            <div class="col">
                <p><span class="" style="color: rgb(0, 46, 184);">JSON Web Signature (JWS)</span> es una forma de firmar digitalmente un token JWT para garantizar su integridad y autenticidad. La firma se basa en un algoritmo de hash y una clave secreta compartida. El receptor del token puede verificar la firma utilizando la clave secreta y el algoritmo de hash especificado en el encabezado del token.</p>
            </div>
        </div>

        <!-- 2 -->
        <div class="row" style="margin-left: 32px">
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-1-circle-fill" viewBox="0 0 16 16" style=" color: #3c80b3">
                    <path d="M5 3.5h6A1.5 1.5 0 0 1 12.5 5v6a1.5 1.5 0 0 1-1.5 1.5H5A1.5 1.5 0 0 1 3.5 11V5A1.5 1.5 0 0 1 5 3.5"></path>
                </svg>
            </div>
            <div class="col">
                <p><span class="" style="color: rgb(0, 46, 184);">JSON Web Encryption (JWE)</span> es una forma de cifrar el contenido de un token JWT para proteger la privacidad de los datos. El contenido cifrado se puede descifrar solo con una clave secreta específica. JWE utiliza algoritmos de cifrado para proteger la información.</p>
            </div>
        </div>
        <!-- Fin de viñetas personalizadas -->

        <p>Podemos utilizar dos tipos de algoritmos para codificar nuestros tokens, los simétricos nos permiten encriptar y desencriptar los tokens utilizando una única llave privada, o podemos utilizar algoritmos asimétricos que utilizan una llave privada y una publica para tener mayor seguridad y evitar problemas si alguna de las llaves es interceptada.</p>

        <!--Inicio Caja violeta-->
        <br>
        <div class="col" style="border-left: solid  #460E95 3px; background-color: #F3ECFD; width: 92%; margin: 0 auto; border-radius: 8px">

            <p style="color: #460E95; font-size: large; padding: 14px; font-weight: 600">Estructura de un JWT</p>
            <ul style="color: #010614 ; font-size: large; padding-left: 16px; padding-bottom:16px; margin-top: -24px; list-style-type: none;">
                <li>- La primera parte es el header y contiene el algoritmo y el tipo de token que utilizamos para firmar.</li>
                <li>- La segunda parte es el payload, contiene información como la identificación del usuario, fechas de creación y expiración del token, entre otras (debemos tener cuidado de no transmitir información sensible ya que puede ser decodificada por alguna otra aplicación).</li>
                <li>- Por último, la signature es la tercera parte del token y se genera codificando los anteriores campos más una firma secreta. Gracias a esta parte del token podemos verificar su autenticidad e invalidar el token si alguno de los campos cambia.</li>
            </ul>
        </div>
        <br>
        <!--Fin Caja violeta-->

        <p>Las partes de un JWT se codifican como un objeto JSON que está firmado digitalmente utilizando JSON Web Signature (JWS). Los JWT se dividen en 3 cadenas de texto separadas por puntos. Cada una de las partes está codificada en base64Url.</p>

        <p style="text-align: center;"><img src="https://aulasvirtuales.bue.edu.ar/pluginfile.php/2801042/mod_book/chapter/209475/555555.png" alt="" width="720" height="747" role="presentation" class="img-responsive atto_image_button_text-bottom"></p>

        <p>Los tokens JWT se componen de tres secciones: un algoritmo de firmado, el payload (información) y la firma (llave que permite al receptor verificar que el mensaje no ha sido modificado durante la transmisión).</p>
    </div>
</div></div>
            </div>
            <div class="pb-5">
            <div class="book_chapter pt-3" id="ch209476"><article class="flex_titulo_botonera" style="background-color: #E6E1E5;">
    <p class="titulo_principal">Base 64</p>
</article>
<div style="background-color: #FAFAFA; font-size: large; color: #010614;">
    <br>
    <div style="margin-left: 3%; margin-right: 3%;">

        <p>La codificación en <span class="" style="color: rgb(0, 61, 245);">base 64</span>, se llama así porque genera una cadena <span class="" style="color: rgb(0, 61, 245);">ASCII</span> para representar cualquier dato binario, usando para ello un alfabeto de 64 caracteres. La versión URL elimina del alfabeto los caracteres "=", "/" y "+".</p>

        <!-- Inicio Cuadro amarillo borde violeta -->
        <br>
        <div style="background-color: #FFFEEB; border-top: 2px solid #460E95; width: 96%; margin: 0 auto;">
            <div style="margin:16px">
                <p style="color: #5811BB; font-size: large; font-weight: 600">¿Como Funciona?</p>
                <p style="color: #010614 ; font-size: large; padding-bottom: 16px; margin-top: -12px">
                    El algoritmo toma cualquier dato, lo pasa a binario, y va tomando porciones de 6 bits (ya que 2^6=64), que en decimal nos indica el índice (empezando en 0) del carácter equivalente en el alfabeto elegido.
                </p>
            </div>
        </div>
        <br>
        <!-- Fin Cuadro amarillo borde violeta -->

    </div>
</div></div>
            </div>
            <div class="pb-5">
            <div class="book_chapter pt-3" id="ch209477"><article class="flex_titulo_botonera" style="background-color: #E6E1E5;">
    <p class="titulo_principal">Campos</p>
</article>

<div style="background-color: #FAFAFA; font-size: large; color: #010614;">
    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
</div>

<div style="background-color: rgb(250, 250, 250);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<span style="color: rgb(1, 6, 20); font-size: large;">Estos son los diferentes campos que podemos encontrar:&nbsp;</span></div>
<div style="background-color: rgb(250, 250, 250);"><span style="color: rgb(1, 6, 20); font-size: large;"><br></span></div>
<div style="background-color: rgb(250, 250, 250);">
    <div style="margin-left: 3%; margin-right: 3%;">
        <ul style="color: rgb(1, 6, 20); font-size: large;">
            <div class="row" style="margin-left: 32px">
                <div>
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-1-circle-fill" viewBox="0 0 16 16" style="color: #062558">
                        <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0ZM9.283 4.002H7.971L6.072 5.385v1.271l1.834-1.318h.065V12h1.312V4.002Z"></path>
                    </svg></div>
                <div class="col">
                    <p><b>header o cabecera:</b> Es el encabezado dónde se indica, al menos, el algoritmo y el tipo de token:</p>

                    <!-- Inicio de caja de código -->
                    <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 5px 5px 0 0; display: flex; justify-content: space-between;">
                        <span style="align-self: center;">JSON</span>
                        <span style="align-self: center; cursor: pointer;" onclick="copyCodeToClipboard('codeContainer1', 'copyText1', 'copyIcon1')">
                            <span id="copyText1">Copiar código</span>
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16" id="copyIcon1">
                                <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"></path>
                                <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"></path>
                            </svg>
                        </span>
                    </div>
                    <div style="background-color: #000; color: #fff; padding: 10px; border-radius: 0 0 5px 5px;">
                        <pre style="background-color: #000; color: #fff; padding: 10px; border-radius: 5px; font-size: large; margin-top: 0;" id="codeContainer1">{
    "alg": "HS256",
    "typ": "JWT"
}<br></pre>
                    </div>
                </div>
            </div>
            <div class="row" style="margin-left: 32px">
                <p><b></b></p>
            </div>
            <div class="row" style="margin-left: 32px">
                <div>
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-2-circle-fill" viewBox="0 0 16 16" style="color: #062558">
                        <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0ZM6.646 6.24c0-.691.493-1.306 1.336-1.306.756 0 1.313.492 1.313 1.236 0 .697-.469 1.23-.902 1.705l-2.971 3.293V12h5.344v-1.107H7.268v-.077l1.974-2.22.096-.107c.688-.763 1.287-1.428 1.287-2.43 0-1.266-1.031-2.215-2.613-2.215-1.758 0-2.637 1.19-2.637 2.402v.065h1.271v-.07Z"></path>
                    </svg>
                </div>
                <div class="col">
                    <p><b>payload:</b> Contiene los privilegios o claims, y los datos del usuario.&nbsp;</p>


                    <!-- Inicio de caja de código -->
                    <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 5px 5px 0 0; display: flex; justify-content: space-between;">
                        <span style="align-self: center;">JWT</span>
                        <span style="align-self: center; cursor: pointer;" onclick="copyCodeToClipboard('codeContainer2', 'copyText2', 'copyIcon2')">
                            <span id="copyText2">Copiar código</span>
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16" id="copyIcon2">
                                <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"></path>
                                <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"></path>
                            </svg>
                        </span>
                    </div>
                    <div style="background-color: #000; color: #fff; padding: 10px; border-radius: 0 0 5px 5px;">
                        <pre style="background-color: #000; color: #fff; padding: 10px; border-radius: 5px; font-size: large; margin-top: 0;" id="codeContainer2"><span class="" style="font-size: x-small;">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjkyMDAyMSIsIm5hbWUiOiJLcmlzaG5hIn0.tvORZ0xRXmRhVB_sYnckoEN8HYe-q4YUlZJ-ZNaWBiM
</span></pre>
                    </div>
                </div>
            </div>
            <div class="row" style="margin-left: 32px">
                <p><br></p>
            </div>
            <div class="row" style="margin-left: 32px">
                <p>Y estas 3 partes, cuando se combinan, forman un JW-Token que tiene un aspecto similar al siguiente:</p>
            </div>
        </ul>

        <p style="text-align: center;">
            <img src="https://aulasvirtuales.bue.edu.ar/pluginfile.php/2801042/mod_book/chapter/209477/5%20-%20Semana%2011.png" alt="" width="65%" height="65%" class="img-responsive atto_image_button_text-bottom">
        </p>
    </div>
</div>

<!-- Script para copiar el código -->
<script>
    function copyCodeToClipboard(containerId, copyTextId, copyIconId) {
        var codeToCopy = document.getElementById(containerId).innerText;
        navigator.clipboard.writeText(codeToCopy).then(function() {
            var copyText = document.getElementById(copyTextId);
            var copyIcon = document.getElementById(copyIconId);
            copyText.textContent = 'Copiado';
            copyIcon.innerHTML = `
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M10.854 7.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7.5 9.793l2.646-2.647a.5.5 0 0 1 .708 0"/>
                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"/>
                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"></path>
                </svg>`;
            setTimeout(function() {
                copyText.textContent = 'Copiar código';
                copyIcon.innerHTML = `
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16">
                        <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"/>
                        <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"></path>`;
            }, 2000);
        });
    }
</script></div>
            </div>
            <div class="pb-5">
            <div class="book_chapter pt-3" id="ch209478"><article class="flex_titulo_botonera" style="background-color: #E6E1E5;">
    <p class="titulo_principal">Token JWT en Node</p>
</article>

<div style="background-color: #FAFAFA; font-size: large; color: #010614;">
    <br>
    <div style="margin-left: 3%; margin-right: 3%;">

        <p><span class="" style="font-size: large;"><span class="" style="font-size: large;">Una de las opciones más reconocidas en </span><span class="" style="color: rgb(0, 61, 245); font-size: large;">Node</span><span class="" style="font-size: large;"> para firmar </span>
            <span class="" style="font-size: large;">
                </span><span class="" style="color: rgb(0, 61, 245); font-size: large;">tokens JWT</span><span class="" style="font-size: large;"> es la librería </span></span><code><span class="" style="font-size: large;">jsonwebtoken</span></code><span class="" style="font-size: large;">. Podemos instalarla con:</span></p>

        <!-- Inicio de caja de código -->
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 5px 5px 0 0; display: flex; justify-content: space-between;">
            <span style="align-self: center;">JavaScript</span>
            <span style="align-self: center; cursor: pointer;" onclick="copyCodeToClipboard('codeContainer1', 'copyText1', 'copyIcon1')">
                <span id="copyText1">Copiar código</span>
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16" id="copyIcon1">
                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"></path>
                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"></path>
                </svg>
            </span>
        </div>
        <div style="background-color: #000; color: #fff; padding: 10px; border-radius: 0 0 5px 5px;">
            <pre id="codeContainer1" style="background-color: #000; color: #fff; padding: 10px; border-radius: 5px; font-size: large; margin-top: 0;">npm install jsonwebtoken
            </pre>
        </div>

        <p><code><span class="" style="font-size: large;"></span></code></p>
        <p><code><span class="" style="font-size: large;">jsonwebtoken</span></code><span class="" style="font-size: large;"> es un estándar abierto que se utiliza para compartir información entre dos partes: un cliente y un servidor. Usaremos dos funciones de </span><code><span class="" style="font-size: large;">JWT</span></code>
            <span class="" style="font-size: large;">
                </span><span class="" style="font-size: large;">. La primera función es </span><code><span class="" style="font-size: large;">sign</span></code><span class="" style="font-size: large;"> para crear un nuevo </span><code><span class="" style="font-size: large;">token</span></code>
                <span class="" style="font-size: large;"> y la segunda función es </span><code><span class="" style="font-size: large;">verify</span></code><span class="" style="font-size: large;">
            </span><span class="" style="font-size: large;"> para verificar el </span><code><span class="" style="font-size: large;">token</span></code><span class="" style="font-size: large;">.</span><br></p>
        <p><span class=""><code><span class="" style="font-size: large;">jwt.sign()</span></code><span class="" style="font-size: large;">&nbsp;es un método que recibe dos parámetros:</span><br></span>
        </p>

  <!-- Formato con íconos numerados -->
        <!-- 1 -->
        <div class="row" style="margin-left: 32px">
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-1-circle-fill" viewBox="0 0 16 16" style="color: #3c80b3">
                    <path d="M5 3.5h6A1.5 1.5 0 0 1 12.5 5v6a1.5 1.5 0 0 1-1.5 1.5H5A1.5 1.5 0 0 1 3.5 11V5A1.5 1.5 0 0 1 5 3.5"></path>
                </svg>
            </div>
            <div class="col">
                <p data-sider-select-id="a9cb5e26-405f-40b1-b48e-5408a2774d36"><span class="" style="color: rgb(51, 51, 51);">El primer parámetro es el payload, que es un objeto con la información de autenticación y/o autorización que queremos incluir en el token, en este caso contiene una propiedad </span><code><span class="" style="font-size: large;">username</span></code><span style="color: rgb(51, 51, 51);">
                    </span><span class="" style="color: rgb(51, 51, 51);"> con el valor '<span class="" style="color: rgb(0, 61, 245);">admin</span>'.</span><br></p>
            </div>
        </div>

        <!-- 2 -->
        <div class="row" style="margin-left: 32px">
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-1-circle-fill" viewBox="0 0 16 16" style="color: #3c80b3">
                    <path d="M5 3.5h6A1.5 1.5 0 0 1 12.5 5v6a1.5 1.5 0 0 1-1.5 1.5H5A1.5 1.5 0 0 1 3.5 11V5A1.5 1.5 0 0 1 5 3.5"></path>
                </svg>
            </div>
            <div class="col">
                <p><span style="font-size: large; color: rgb(51, 51, 51);">El segundo parámetro es la clave secreta que se utilizará para firmar el token.</span></p>
            </div>
        </div>
        <!-- Inicio de caja de código -->
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 5px 5px 0 0; display: flex; justify-content: space-between;">
            <span style="align-self: center;">JWT</span>
            <span style="align-self: center; cursor: pointer;" onclick="copyCodeToClipboard('codeContainer2', 'copyText2', 'copyIcon2')">
                        <span id="copyText2">Copiar código</span>
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16" id="copyIcon2">
                            <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"></path>
                            <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"></path>
                        </svg>
            </span>
        </div>
        <div style="background-color: #000; color: #fff; padding: 10px; border-radius: 0 0 5px 5px;">
            <pre id="codeContainer2" style="background-color: #000; color: #fff; padding: 10px; border-radius: 5px; font-size: large; margin-top: 0;"><span class="" style="font-size: x-small;">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjkyMDAyMSIsIm5hbWUiOiJLcmlzaG5hIn0.tvORZ0xRXmRhVB_sYnckoEN8HYe-q4YUlZJ-ZNaWBiM</span></pre>
        </div>
        <!-- Fin de caja de código -->

    </div>
</div>
<div class="row" style="margin-left: 32px">
    <p><br></p>
</div>
<div class="row" style="margin-left: 32px">
    <p><span class="" style="font-size: large;">Y estas 3 partes, cuando se combinan, forman un JW-Token que tiene un aspecto similar al siguiente:</span></p>
</div>

<p style="text-align: center;">
    <img src="https://aulasvirtuales.bue.edu.ar/pluginfile.php/2801042/mod_book/chapter/209478/5%20-%20Semana%2011.png" alt="" width="65%" height="65%" class="img-responsive atto_image_button_text-bottom">
</p>



<script>
    function copyCodeToClipboard(id, copyTextId, copyIconId) {
        var codeToCopy = document.getElementById(id).innerText;
        navigator.clipboard.writeText(codeToCopy).then(function() {
            var copyIcon = document.getElementById(copyIconId);
            var copyText = document.getElementById(copyTextId);
            copyIcon.innerHTML = `
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M10.854 7.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7.5 9.793l2.646-2.647a.5.5 0 0 1 .708 0"/>
                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"/>
                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"/>
                </svg>`;
            copyText.textContent = 'Copiado';
            setTimeout(function() {
                copyIcon.innerHTML = `
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16" id="copyIcon2">
                        <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"/>
                        <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"/>
                    </svg>`;
                copyText.textContent = 'Copiar código';
            }, 2000);
        }, function(err) {
            console.error('Error al copiar el código: ', err);
        });
    }
</script></div>
            </div>
            <div class="pb-5">
            <div class="book_chapter pt-3" id="ch209479"><article class="flex_titulo_botonera" style="background-color: #E6E1E5;">
    <p class="titulo_principal">RSA 256</p>
</article>

<div style="background-color: #FAFAFA; font-size: large; color: #010614;">
    <div style="margin-left: 3%; margin-right: 3%;">
        <div class="row" style="margin-left: 32px">

        </div>
    </div>
</div>
<div style="background-color: #FAFAFA; font-size: large; color: #010614;">
    <div style="margin-left: 3%; margin-right: 3%;">
        <div class="row" style="margin-left: 16px">
            <p><span style="color: rgb(51, 51, 51);"><code><span class="" style="color: rgb(0, 61, 245); font-size: large;"><br></span></code>
                </span>
            </p>
            <p><span style="color: rgb(51, 51, 51);"><code><span class="" style="color: rgb(0, 61, 245); font-size: large;">RSA</span></code><b><span class=""> (Rivest-Shamir-Adleman)</span></b></span>
                <span class=""> es un algoritmo de cifrado de clave pública desarrollado en 1977. </span><code><span class="" style="color: rgb(0, 61, 245); font-size: large;">RSA 256</span></code><span class="" style="color: rgb(0, 61, 245);"> </span>
                <span class="">es una variante de </span><code><span class="" style="color: rgb(0, 61, 245); font-size: large;">RSA</span></code><span class=""> que utiliza una clave de 256 bits (32 bytes) para cifrar y descifrar los datos. </span><code><span class="" style="color: rgb(0, 61, 245); font-size: large;">RSA 256</span></code>
                <span class=""> es considerado seguro y es utilizado en muchos sistemas de seguridad, incluyendo la seguridad de la información en internet.</span></p>
        </div>
    </div>
</div>
<div style="background-color: #FAFAFA; font-size: large; color: #010614;">
    <div style="margin-left: 3%; margin-right: 3%;">
        <div class="row" style="margin-left: 16px">
            <p><span class="" style="font-size: large;"><br>Genera dos claves: una clave pública y una clave privada. La clave pública se utiliza para cifrar los datos, mientras que la clave privada se utiliza para descifrarlos. Los datos cifrados con la clave pública sólo pueden ser descifrados con la clave privada correspondiente.</span></p>
        </div>
    </div>

    <!-- Cuadro amarillo borde violeta -->
    <br>
    <div style="background-color: #FFFEEB; border-top: 2px solid #460E95; width: 96%; margin: 0 auto;">
        <div style="margin:16px">
            <p style="color: #5811BB; font-size: large; font-weight: 600">Importante</p>
            <p style="color: #010614 ; font-size: large; padding-bottom: 16px; margin-top: -12px">Esto permite a los usuarios compartir información de manera segura con solo compartir su clave pública.</p>
        </div>
    </div>
    <br>
    <!-- Fin Cuadro amarillo borde violeta -->

</div></div>
            </div>
            <div class="pb-5">
            <div class="book_chapter pt-3" id="ch209480"><article class="flex_titulo_botonera" style="background-color: #E6E1E5;">
    <p class="titulo_principal">¿Cómo firmar un token JWT con RSA 256?</p>
</article>

<div style="background-color: #FAFAFA; font-size: large; color: #010614;">
    <br>
    <div style="margin-left: 3%; margin-right: 3%;">

        <!-- Modificación del título con el nuevo formato -->
        <div style="background-color:#87CEEB; display: inline-flex; height: 6px;">
            <p style="font-size: x-large; color: #010614; margin-top: -22px; padding-right: 4px" data-sider-select-id="93101215-b3ea-463e-83f8-5745366f7f57">Verificar un token JWT firmado con RSA 256</p>
        </div>

        <p></p>
        <p><span class="" style="font-size: large;">La forma de verificar tokens JWT firmados con un algoritmo asimétrico como RSA, es usando la llave pública. En nuestro caso será usando la llave que está dentro del archivo </span><code><span class="" style="font-size: large;">jwtRS256.key.pub</span></code>
            <span class="" style="font-size: large;">:</span>
        </p>

        <!-- Inicio de caja de código -->
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 5px 5px 0 0;">
            <span style="float: left;">JavaScript</span>
            <span style="float: right; cursor: pointer;" onclick="copyCodeToClipboard()">
                <span id="copyText">Copiar código</span>
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16" id="copyIcon">
                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"></path>
                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"></path>
                </svg>
            </span>
        </div>
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 0;"></div>
        <div style="background-color: #000; color: #fff; padding: 10px; border-radius: 0 0 5px 5px;">
            <pre style="background-color: #000; color: #fff; padding: 10px; border-radius: 5px; font-size: large; margin-top: 0;" id="codeContainer">const jwt = require('jsonwebtoken');
const fs = require('fs');
var token = `<reemplazar con="" token="">`;
const publicKey = fs.readFileSync('jwtRS256.key.pub');
jwt.verify(token, publicKey, { algorithm: 'RS256' }, (err, decoded) =&gt; {
  if (err) throw new Error('Invalid token');
  console.log(decoded.twitter_account);
});
            </reemplazar></pre>
        </div>
        <!-- Fin de caja de código -->
        <br>
        <!-- Modificación de la sección ¿Podemos ver el contenido de un token JWT sin tener la llave pública? con el nuevo formato -->
        <p style="color: white; background-color: #8b82d7; padding: 4px 16px; border-radius: 8px 8px 0px 0px; display: inline-block; margin-bottom: -1px;">
            <span class="" style="font-size: large;"><b><span class="" style="font-size: large;">¿Podemos ver el contenido de un token JWT sin tener la llave pública?</span></b>
            </span>
        </p>

        <div style="border: 1px solid #8b82d7; border-radius: 0px 8px 8px; background-color: white;">
            <div class="row" style="margin: 16px 8px; display: flex; align-items: center;">
                <div class=" col-auto" style="color: rgb(1, 6, 20);"><br></div>

                <div class="col" style="">
                    <p><span><span style=""><span class="" style="font-size: large;">Si. La misión de los tokens </span><code style=""><span class="" style="font-size: large; color: rgb(0, 61, 245);">JWS</span></code><span class="" style="font-size: large;"> es garantizar que la información que es enviada desde el emisor hasta el receptor no sea modificada durante la transmisión.</span></span><span class="" style="font-size: large;"> Esto no quiere decir que esta información vaya
                        cifrada, por el contrario, quien obtenga un token </span><code style=""><span class="" style="font-size: large; color: rgb(0, 61, 245);">JWT</span></code><span class="" style="font-size: large;"><span class="" style="color: rgb(0, 61, 245);"> </span>puede ver todo su contenido, lo cual no debería ser un problema si se está utilizando esta estrategia.</span></span></p>

                    <p><span><span class="" style="font-size: large;">Para ver el contenido de un token </span><code style=""><span class="" style="font-size: large; color: rgb(0, 61, 245);">JWT</span></code><span class="" style="font-size: large;">, podemos copiarlo e ingresar al sitio:
                        </span><a href="https://jwt.io/" target="_blank" style=""><span style="color: rgb(0, 46, 184);"><u style=""><span class="" style="font-size: large;">https://jwt.io/</span></u></span></a></span></p>
                </div>
            </div>
        </div>
        <!-- Fin de la caja con título y texto -->
    </div>
</div>

<script>
    function copyCodeToClipboard() {
        var codeToCopy = document.getElementById("codeContainer").innerText;
        navigator.clipboard.writeText(codeToCopy).then(function() {
            var copyIcon = document.getElementById('copyIcon');
            var copyText = document.getElementById('copyText');
            copyIcon.innerHTML = `
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check" viewBox="0 0 16 16">
                <path fill-rule="evenodd" d="M10.854 7.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7.5 9.793l2.646-2.647a.5.5 0 0 1 .708 0"/>
                <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"/>
            </svg>`;
            copyText.textContent = 'Copiado';
            setTimeout(function() {
                copyIcon.innerHTML = `
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16" id="copyIcon">
                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"/>
                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"/>
                </svg>`;
                copyText.textContent = 'Copiar código';
            }, 2000); // Cambiar de nuevo a "Copiar código" después de 2 segundos
        }, function(err) {
            console.error('Error al copiar el código: ', err);
        });
    }

    document.getElementById("codeContainer").addEventListener("paste", function(e) {
        e.preventDefault();
        var text = e.clipboardData.getData("text/plain");
        var coloredText = text.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');
        document.getElementById("codeContainer").innerHTML = coloredText;
    });
</script></div>
            </div>
            <div class="pb-5">
            <div class="book_chapter pt-3" id="ch209481"><article class="flex_titulo_botonera" style="background-color: #E6E1E5;">
    <p class="titulo_principal">Expiración de tokens</p>
</article>

<div style="background-color: #FAFAFA; font-size: large; color: #010614;">
    <br>
    <div style="margin-left: 3%; margin-right: 3%;">

        <p><span class="" style="font-size: large;"><span class="" style="font-size: large;">Si no se define nada alrededor de la expiración, los </span><span class="" style="color: rgb(0, 61, 245); font-size: large;">tokens </span><span class="" style="font-size: large;">generados nunca vencen. La forma de establecer la duración es a través del atributo </span></span><code><span class="" style="font-size: large;">expiresIn</span></code>
            <span class="" style="font-size: large;">
                </span><span class="" style="font-size: large;"> al momento de realizar la firma del token:</span>
        </p>

        <!-- Inicio de caja de código -->
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 5px 5px 0 0; display: flex; justify-content: space-between;">
            <span style="align-self: center;">JavaScript</span>
            <span style="align-self: center; cursor: pointer;" onclick="copyCodeToClipboard('codeContainer1', 'copyText1', 'copyIcon1')">
                <span id="copyText1">Copiar código</span>
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16" id="copyIcon1">
                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"></path>
                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"></path>
                </svg>
            </span>
        </div>
        <div style="background-color: #000; color: #fff; padding: 10px; border-radius: 0 0 5px 5px;">
            <pre id="codeContainer1" style="background-color: #000; color: #fff; padding: 10px; border-radius: 5px; font-size: large; margin-top: 0;">const jwt = require('jsonwebtoken');
const fs = require('fs');
const privateKey = fs.readFileSync('jwtRS256.key');
var token = jwt.sign({ username: 'admin' }, privateKey, {
  algorithm: 'RS256',
  expiresIn: 3600
});
console.log(token);
            </pre>
        </div>
        <!-- Fin de caja de código -->

        <p><br></p>
        <p><span class="" style="font-size: large;">El atributo </span><code><span class="" style="font-size: large;">expiresIn</span></code><span class="" style="font-size: large;"> está dado en segundos, por tanto, en la anterior implementación el token durará una hora. También es posible indicar este valor en otras unidades, como por ejemplo “1h” o “150ms”</span>
            <span class="" style="font-size: large;">.</span>
        </p>

        <!-- Formato de la sección Audiencia -->
        <div style="background-color:#87CEEB; display: inline-flex; height: 6px;">
            <p style="font-size: x-large; color: #010614; margin-top: -22px; padding-right: 4px">Audiencia</p>
        </div>
        <p></p>
        <p><span class="" style="font-size: large;">Imaginemos un escenario donde creamos nuestro propio servicio de manejo de identidad. El objetivo es que diferentes aplicaciones utilicen ese servicio para manejar la autenticación basada en tokens </span><code><span class="" style="font-size: large;">JWT</span></code>
            <span class="" style="font-size: large;">
                </span><span class="" style="font-size: large;"><span class="" style="font-size: large;">. Dado que emitimos los tokens con la misma llave privada </span><span class="" style="color: rgb(0, 61, 245); font-size: large;">RSA</span><span class="" style="font-size: large;">, si alguien genera un token en la aplicación A, este también será un token válido
            para la aplicación B, lo cual estaría dejando expuestas todas las aplicaciones que usan el servicio a una vulnerabilidad grave</span></span><span class="" style="font-size: large;">.</span></p>

        <!-- Cuadro amarillo borde violeta -->
        <br>
        <div style="background-color: #FFFEEB; border-top: 2px solid #460E95; width: 96%; margin: 0 auto;">
            <div style="margin:16px">
                <p style="color: #5811BB; font-size: large; font-weight: 600">Nuevas</p>
                <p style="color: #010614 ; font-size: large; padding-bottom: 16px; margin-top: -12px">
                    <span class="" style="font-size: large;">La audiencia de los tokens busca mitigar esta vulnerabilidad, haciendo que cuando se emita un token, se indique para quién fue generado. Por tanto, si se emite un token para la aplicación A no podrá ser utilizado para consumir recursos de la aplicación B.</span></p>
            </div>
        </div>
        <!-- Fin Cuadro amarillo borde violeta -->

        <p><span class="" style="font-size: large;">En muchas ocasiones en la audiencia se define el </span><code><span class="" style="font-size: large;">clientId</span></code><span class="" style="font-size: large;"><span class="" style="font-size: large;"> de la aplicación para la cual se está generando el token (pero en realidad puede ser cualquier </span>
            <span class="" style="color: rgb(0, 61, 245); font-size: large;">String</span><span class="" style="font-size: large;">).</span></span><span class="" style="font-size: large;">
        </span></p>

        <!-- Inicio de caja de código -->
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 5px 5px 0 0; display: flex; justify-content: space-between;">
            <span style="align-self: center;">JavaScript</span>
            <span style="align-self: center; cursor: pointer;" onclick="copyCodeToClipboard('codeContainer3', 'copyText3', 'copyIcon3')">
                <span id="copyText3">Copiar código</span>
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16" id="copyIcon3">
                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"></path>
                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"></path>
                </svg>
            </span>
        </div>
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 0;"></div>
        <div style="background-color: #000; color: #fff; padding: 10px; border-radius: 0 0 5px 5px;">
            <pre id="codeContainer3" style="background-color: #000; color: #fff; padding: 10px; border-radius: 5px; font-size: large; margin-top: 0;">const jwt = require('jsonwebtoken');
const fs = require('fs');
const privateKey = fs.readFileSync('jwtRS256.key');
var token = jwt.sign({ username: 'admin' }, privateKey, {
  algorithm: 'RS256',
  expiresIn: 3600,
  audience: 'f2a1ed52710d4533bde25be6da03b6e3'
});
console.log(token);
            </pre>
        </div>
        <!-- Fin de caja de código -->


        <p style="text-align: center;"><img src="https://aulasvirtuales.bue.edu.ar/pluginfile.php/2801042/mod_book/chapter/209481/ggfgtyt.png" alt="" width="926" height="524" class="img-responsive atto_image_button_text-bottom"></p>
    </div>

    <!-- Script para copiar código -->
    <script>
        function copyCodeToClipboard(id, copyTextId, copyIconId) {
            var codeToCopy = document.getElementById(id).innerText;
            navigator.clipboard.writeText(codeToCopy).then(function() {
                var copyIcon = document.getElementById(copyIconId);
                var copyText = document.getElementById(copyTextId);
                copyIcon.innerHTML = `
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check" viewBox="0 0 16 16">
                        <path fill-rule="evenodd" d="M10.854 7.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7.5 9.793l2.646-2.647a.5.5 0 0 1 .708 0"/>
                        <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"/>
                        <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"/>
                    </svg>`;
                copyText.textContent = 'Copiado';
                setTimeout(function() {
                    copyIcon.innerHTML = `
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16" id="copyIcon">
                            <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"/>
                            <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"/>
                        </svg>`;
                    copyText.textContent = 'Copiar código';
                }, 2000);
            }, function(err) {
                console.error('Error al copiar el código: ', err);
            });
        }
    </script>
</div></div>
            </div>
            <div class="pb-5">
            <div class="book_chapter pt-3" id="ch209482"><article class="flex_titulo_botonera" style="background-color: #E6E1E5;">
    <p class="titulo_principal">Buenas prácticas al utilizar JWT</p>
</article>

<div style="background-color: #FAFAFA; font-size: large; color: #010614;">
    <br>
    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Acá te dejamos para tener en cuenta:</div><div style="background-color: #FAFAFA; font-size: large; color: #010614;">&nbsp;
    <br>
    <div style="margin-left: 3%; margin-right: 3%;">
        <!-- 1 -->
        <div class="row" style="margin-left: 32px">
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-1-circle-fill" viewBox="0 0 16 16" style="color: #3c80b3;">
                    <path d="M5 3.5h6A1.5 1.5 0 0 1 12.5 5v6a1.5 1.5 0 0 1-1.5 1.5H5A1.5 1.5 0 0 1 3.5 11V5A1.5 1.5 0 0 1 5 3.5"></path>
                </svg></div>
            <div class="col">
                <p><b>No transmitir información sensible:</b> No se debe transmitir información sensible a través de <code>JWT</code>, ya que estos son completamente decodificables. Debemos tratar toda la información transmitida como si fuera enviada en texto plano.</p>
            </div>
        </div>

        <!-- 2 -->
        <div class="row" style="margin-left: 32px">
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-2-circle-fill" viewBox="0 0 16 16" style="color: #3c80b3;">
                    <path d="M5 3.5h6A1.5 1.5 0 0 1 12.5 5v6a1.5 1.5 0 0 1-1.5 1.5H5A1.5 1.5 0 0 1 3.5 11V5A1.5 1.5 0 0 1 5 3.5"></path>
                </svg>
            </div>
            <div class="col">
                <p><b>Mantener los tokens pequeños:</b> Los <code><span class="" style="font-size: large;">JWT</span></code> no son un medio de transmisión de datos sino una forma de verificar la autenticación. Para obtener información de usuarios, se deben crear endpoints en la API que estén disponibles solo si se envía un token válido.</p>
            </div>
        </div>

        <!-- 3 -->
        <div class="row" style="margin-left: 32px">
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-3-circle-fill" viewBox="0 0 16 16" style="color: #3c80b3;">
                    <path d="M5 3.5h6A1.5 1.5 0 0 1 12.5 5v6a1.5 1.5 0 0 1-1.5 1.5H5A1.5 1.5 0 0 1 3.5 11V5A1.5 1.5 0 0 1 5 3.5"></path>
                </svg>
            </div>
            <div class="col">
                <p><b>Configurar tiempos de vida cortos:</b> Es recomendable configurar tiempos de vida cortos para los tokens, ya que cuanto mayor sea el tiempo de vida de un token, mayor es el riesgo de sufrir un ataque.</p>
            </div>
        </div>

        <!-- 4 -->
        <div class="row" style="margin-left: 32px">
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-4-circle-fill" viewBox="0 0 16 16" style="color: #3c80b3;">
                    <path d="M5 3.5h6A1.5 1.5 0 0 1 12.5 5v6a1.5 1.5 0 0 1-1.5 1.5H5A1.5 1.5 0 0 1 3.5 11V5A1.5 1.5 0 0 1 5 3.5"></path>
                </svg>
            </div>
            <div class="col">
                <p><b>Crear JWT opacos:</b> No se deben decodificar los tokens desde el cliente o frontend, ya que el código es público y existe el riesgo de que alguien acceda a las llaves privadas.</p>
            </div>
        </div>
    </div>
    <br>
</div></div>
            </div>
            <div class="pb-5">
            <div class="book_chapter pt-3" id="ch209483"><article class="flex_titulo_botonera" style="background-color: #E6E1E5;">
    <p class="titulo_principal">Ejemplo de autenticación y autorización con nodejs, express, JWT y mongoDB</p>
</article>
<div style="background-color: #FAFAFA; font-size: large; color: #010614 ;">
    <br>
    <div style="margin-left: 3%; margin-right: 3%;">



        <p></p><span id="docs-internal-guid-8396e091-7fff-9ba2-26d5-e64a19076376"><p dir="ltr" style="">Vamos a crear una <span class="" style="color: rgb(0, 61, 245);">API</span> sencilla que permita gestionar (registrar, obtener, eliminar y editar) publicaciones
        que se componen de un título, contenido, fecha de creación y categoría.&nbsp;</p>
      <div style="display: inline-block; border-radius: 8px; overflow: hidden; border: 1px solid #9A3282;">
    <p style="background-color: #9A3282; color: white; padding: 4px 16px; margin: 0;">
        <span style="font-size: large;"><b>Autenticación y Autorización</b></span>
    </p>
    <div style="background-color: white; padding: 16px;">
        <p><span style="font-size: large; color: #010614;">Vamos a agregar autenticación y autorización de usuarios, de forma tal que los usuarios deberán almacenarse en la base de datos y cada artículo debe estar vinculado al usuario que lo creó. La eliminación y edición de un artículo sólo debe permitirse para el usuario que lo creó.</span></p>
    </div>
</div>

        <br>
        <p></p>



        <!-- nada puede haber abajo -->

        </span>
    </div>
</div></div>
            </div>
            <div class="pb-5">
            <div class="book_chapter pt-3" id="ch209484"><article class="flex_titulo_botonera" style="background-color: #E6E1E5;">
    <p class="titulo_principal">Creación del proyecto</p>
</article>

<div style="background-color: #FAFAFA; font-size: large; color: #010614;">
    <br>
    <div style="margin-left: 3%; margin-right: 3%;">

        <p>Para comenzar, crearemos un servidor simple con <span style="color: rgb(0, 61, 245);">Node, Express, MongoDB, Mongoose y Nodemon</span>, como hemos visto en clases anteriores.</p>
        <p>Creamos una carpeta “<span style="color: rgb(0, 61, 245);">passport-example</span>” y ejecutamos el comando:</p>

        <!-- Inicio de caja de código -->
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 5px 5px 0 0; display: flex; justify-content: space-between;">
            <span style="align-self: center;">Terminal</span>
            <span style="align-self: center; cursor: pointer;" onclick="copyCodeToClipboard('codeContainer1')">
                <span id="copyText1">Copiar código</span>
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16" id="copyIcon1">
                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"></path>
                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"></path>
                </svg>
            </span>
        </div>
        <div style="background-color: #000; color: #fff; padding: 10px; border-radius: 0 0 5px 5px;">
            <pre style="background-color: #000; color: #fff; padding: 10px; border-radius: 5px; font-size: large; margin-top: 0;" id="codeContainer1">npm init -y</pre>
        </div>
        <!-- Fin de caja de código -->

        <p>Instalamos las dependencias:</p>

        <!-- Inicio de caja de código -->
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 5px 5px 0 0; display: flex; justify-content: space-between;">
            <span style="align-self: center;">Terminal</span>
            <span style="align-self: center; cursor: pointer;" onclick="copyCodeToClipboard('codeContainer2')">
                <span id="copyText2">Copiar código</span>
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16" id="copyIcon2">
                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"></path>
                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"></path>
                </svg>
            </span>
        </div>
        <div style="background-color: #000; color: #fff; padding: 10px; border-radius: 0 0 5px 5px;">
            <pre style="background-color: #000; color: #fff; padding: 10px; border-radius: 5px; font-size: large; margin-top: 0;" id="codeContainer2">npm i express mongoose nodemon</pre>
        </div>
        <!-- Fin de caja de código -->

        <p>Creamos el archivo principal app.js con un servidor sencillo en el <span style="color: rgb(0, 61, 245);">puerto 8000</span>.</p>

        <!-- Inicio de caja de código -->
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 5px 5px 0 0; display: flex; justify-content: space-between;">
            <span style="align-self: center;">JavaScript</span>
            <span style="align-self: center; cursor: pointer;" onclick="copyCodeToClipboard('codeContainer3')">
                <span id="copyText3">Copiar código</span>
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16" id="copyIcon3">
                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"></path>
                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"></path>
                </svg>
            </span>
        </div>
        <div style="background-color: #000; color: #fff; padding: 10px; border-radius: 0 0 5px 5px;">
            <pre style="background-color: #000; color: #fff; padding: 10px; border-radius: 5px; font-size: large; margin-top: 0;" id="codeContainer3">var express = require('express');
var app = express();
var bodyParser = require('body-parser');
var mongoose = require('mongoose');
mongoose.set('strictQuery', false);
require('dotenv').config();

// Connection to DB
mongoose.connect('mongodb://localhost/passport-example', function (err, res) {
   if (err) throw err;
   console.log('Connected to Database');
});

// Middlewares
app.use(bodyParser.urlencoded({ extended: false }));
app.use(bodyParser.json());

const usersRouter = require('./controllers/users');
const postsRouter = require('./controllers/posts');

// Routes
app.use('/api/posts', postsRouter);
app.use('/api/users', usersRouter);

const PORT = 8000;

// Start server
app.listen(8000, function () {
   console.log(`Node server running on </pre><pre style="background-color: #000; color: #fff; padding: 10px; border-radius: 5px; font-size: large; margin-top: 0;" id="codeContainer3">http://localhost:${PORT}`);
});
            </pre>
        </div>
        <!-- Fin de caja de código -->

        <p>Agregamos el comando para nodemon:</p>

        <!-- Inicio de caja de código -->
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 5px 5px 0 0; display: flex; justify-content: space-between;">
            <span style="align-self: center;">JSON</span>
            <span style="align-self: center; cursor: pointer;" onclick="copyCodeToClipboard('codeContainer4')">
                <span id="copyText4">Copiar código</span>
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16" id="copyIcon4">
                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"></path>
                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"></path>
                </svg>
            </span>
        </div>
        <div style="background-color: #000; color: #fff; padding: 10px; border-radius: 0 0 5px 5px;">
            <pre style="background-color: #000; color: #fff; padding: 10px; border-radius: 5px; font-size: large; margin-top: 0;" id="codeContainer4"> "scripts": {
   "test": "echo \"Error: no test specified\" &amp;&amp; exit 1",
   "dev": "nodemon app.js"
 },
            </pre>
        </div>
        <!-- Fin de caja de código -->

        <br>
    </div>
</div>

<script>
    function copyCodeToClipboard(containerId) {
        var codeToCopy = document.getElementById(containerId).innerText;
        navigator.clipboard.writeText(codeToCopy).then(function() {
            var copyIcon = document.getElementById('copyIcon' + containerId.slice(-1));
            var copyText = document.getElementById('copyText' + containerId.slice(-1));
            copyIcon.innerHTML = `
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M10.854 7.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7.5 9.793l2.646-2.647a.5.5 0 0 1 .708 0"/>
                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"/>
                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"/>
                </svg>`;
            copyText.textContent = 'Copiado';
            setTimeout(function() {
                copyIcon.innerHTML = `
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16" id="copyIcon${containerId.slice(-1)}">
                        <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"/>
                        <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"/>
                    </svg>`;
                copyText.textContent = 'Copiar código';
            }, 2000); // Cambiar de nuevo a "Copiar código" después de 2 segundos
        }, function(err) {
            console.error('Error al copiar el código: ', err);
        });
    }
</script></div>
            </div>
            <div class="pb-5">
            <div class="book_chapter pt-3" id="ch209485"><article class="flex_titulo_botonera" style="background-color: #E6E1E5;">
    <p class="titulo_principal"><span style="font-size: x-large;">Referencias entre colecciones</span></p>
</article>

<div style="background-color: #FAFAFA; font-size: large; color: #010614;">
    <br>
    <div style="margin-left: 3%; margin-right: 3%;">

        <p><span style="font-size: large;">Comencemos agregando información sobre los usuarios a la base de datos. Existe una relación de uno a varios entre el usuario </span><code style="font-size: large;">(user)</code>
            <span style="font-size: large;"> y las publicaciones (</span><code style="font-size: large;">posts</code><span style="font-size: large;">).</span>
        </p>

        <div class="" style="width: 90%; margin: 0 auto;">
            <div class="row">
                <div class="col-1" style="background-color: #ae11a0; border-radius: 4px 0px 0px 4px;">
                    <div class="d-flex justify-content-center" style="margin-top: 20px">
                        <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" fill="white" class="bi bi-card-text" viewBox="0 0 16 16"></svg>
                        <path d="M14.5 3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-13a.5.5 0 0 1-.5-.5v-9a.5.5 0 0 1 .5-.5zm-13-1A1.5 1.5 0 0 0 0 3.5v9A1.5 1.5 0 0 0 1.5 14h13a1.5 1.5 0 0 0 1.5-1.5v-9A1.5 1.5 0 0 0 14.5 2z"></path>
                        <path d="M3 5.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5M3 8a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9A.5.5 0 0 1 3 8m0 2.5a.5.5 0 0 1 .5-.5h6a.5.5 0 0 1 0 1h-6a.5.5 0 0 1-.5-.5"></path>
                    </div>
                </div>
                <div class="col-11" style="background-color: #F6E7F5; border: 1px solid #ae11a0; border-radius: 0px 4px 4px 0px;">
                    <p style="margin-top: 16px;"><b><span style="font-size: large;">Para tener en cuenta:</span></b></p>
                    <p><span style="font-size: large;">Si estuviéramos trabajando con una base de datos relacional, la implementación sería sencilla. Ambos recursos tendrían sus tablas de base de datos separadas, y la identificación del usuario que creó un artículo se almacenaría en la tabla de publicaciones como una clave externa. Cuando se trabaja con bases de datos de documentos, la situación es un poco diferente, ya que hay muchas formas diferentes de modelar la situación.</span></p>
                    <p></p><br>
                </div>
            </div>
        </div>

        <p></p>
        <p><span style="font-size: large;">La solución existente guarda todas las publicaciones de la colección de posts en la base de datos. Si no queremos cambiar esta colección existente, entonces la opción natural es guardar a los usuarios en su propia colección, </span><code style="font-size: large;">users</code>
            <span style="font-size: large;"> por ejemplo.</span>
        </p>
        <p><span style="font-size: large;">Al igual que con todas las bases de datos de documentos, podemos usar ID de objeto en </span><span style="color: rgb(0, 61, 245); font-size: large;">Mongo </span>
            <span style="font-size: large;">para hacer referencia a documentos en otras colecciones. Esto es similar al uso de claves externas en bases de datos relacionales.</span>
        </p>

        <!-- Inicio Cuadro amarillo borde violeta -->
        <div style="background-color: #FFFEEB; border-top: 2px solid #460E95; width: 96%; margin: 0 auto;">
            <div style="margin:16px">
                <p style="color: #5811BB; font-size: large; font-weight: 600"><span style="font-size: large;">Consulta y agregación</span></p>
                <p style="color: #010614; font-size: large; padding-bottom: 16px; margin-top: -12px"><span style="font-size: large;">
                    Tradicionalmente, las bases de datos de documentos como Mongo no admiten consultas de unión que están disponibles en bases de datos relacionales, utilizadas para agregar datos de varias tablas. Sin embargo, a partir de la versión 3.2, Mongo ha admitido consultas de agregación de búsqueda.
                </span></p>
            </div>
        </div>
        <br>
        <!-- Fin Cuadro amarillo borde violeta -->

        <p><span style="font-size: large;">Si estuviéramos usando una base de datos relacional, la publicación contendría una clave de referencia para el usuario que la creó. En las bases de datos de documentos podemos hacer lo mismo.</span></p>
        <p><span style="font-size: large;">Supongamos que la colección </span><code style="font-size: large;">users</code><span style="font-size: large;"> contiene dos usuarios:</span></p>

        <!-- Inicio de caja de código -->
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 5px 5px 0 0; display: flex; justify-content: space-between;">
            <span style="align-self: center; font-size: large;">JSON</span>
            <span style="align-self: center; cursor: pointer;" onclick="copyCodeToClipboard('codeContainer1')">
                <span id="copyText1" style="font-size: large;">Copiar código</span>
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16" id="copyIcon1">
                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"></path>
                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"></path>
                </svg>
            </span>
        </div>
        <div style="background-color: #000; color: #fff; padding: 10px; border-radius: 0 0 5px 5px;">
            <pre id="codeContainer1" style="background-color: #000; color: #fff; padding: 10px; border-radius: 5px; font-size: large; margin-top: 0; text-align: left;">[
  {
    username: 'mluukkai',
    _id: 123456,
  },
  {
    username: 'hellas',
    _id: 141414,
  }
];
            </pre>
        </div>
        <!-- Fin de caja de código -->

        <p><span style="font-size: large;"><br></span></p>
        <p><span style="font-size: large;">La colección </span><code style="font-size: large;">posts</code><span style="font-size: large;"> contiene tres publicaciones que tienen un campo </span><code style="font-size: large;">user</code>
            <span style="font-size: large;"> que hace referencia a un usuario en la colección </span><code style="font-size: large;">users</code><span style="font-size: large;">:</span></p>

        <!-- Inicio de caja de código -->
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 5px 5px 0 0; display: flex; justify-content: space-between;">
            <span style="align-self: center; font-size: large;">JSON</span>
            <span style="align-self: center; cursor: pointer;" onclick="copyCodeToClipboard('codeContainer2')">
                <span id="copyText2" style="font-size: large;">Copiar código</span>
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16" id="copyIcon2">
                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"></path>
                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"></path>
                </svg>
            </span>
        </div>
        <div style="background-color: #000; color: #fff; padding: 10px; border-radius: 0 0 5px 5px;">
            <pre id="codeContainer2" style="background-color: #000; color: #fff; padding: 10px; border-radius: 5px; font-size: large; margin-top: 0; text-align: left;">[
  {
    title: 'Billeteras y QR',
    content: 'Formas de pago: menos tarjetas y más billeteras y QR, </pre><pre id="codeContainer2" style="background-color: #000; color: #fff; padding: 10px; border-radius: 5px; font-size: large; margin-top: 0; text-align: left;">las nuevas tendencias para consumir',
    category: 'Tecnología',
    _id: 221212,
    user: 123456
  },
  {
    title: 'Clima en la ciudad',
    content: 'Se esperan 35°C y hay alerta por altas temperaturas',
    category: 'Clima',
    _id: 221255,
    user: 123456
  },
  {
    title: 'Plantas peligrosas',
    content: 'Hay algunas especies que pueden resultar tóxicas o </pre><pre id="codeContainer2" style="background-color: #000; color: #fff; padding: 10px; border-radius: 5px; font-size: large; margin-top: 0; text-align: left;">venenosas para los integrantes de la casa, sobre todo los niños y las mascotas.',
    category: 'Hogar',
    _id: 221244,
    user: 141414
  }
];
            </pre>
        </div>
        <!-- Fin de caja de código -->

        <p></p>
        <p><span style="font-size: large;">Las bases de datos de documentos no exigen que la clave externa se almacene en los recursos de </span><code style="font-size: large;">posts</code><span style="font-size: large;">, podría también almacenarse en la colección de </span><code style="font-size: large;">users</code>
            <span style="font-size: large;">, o incluso ambos:</span>
        </p>

        <!-- Inicio de caja de código -->
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 5px 5px 0 0; display: flex; justify-content: space-between;">
            <span style="align-self: center; font-size: large;">JSON</span>
            <span style="align-self: center; cursor: pointer;" onclick="copyCodeToClipboard('codeContainer3')">
                <span id="copyText3" style="font-size: large;">Copiar código</span>
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16" id="copyIcon3">
                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"></path>
                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"></path>
                </svg>
            </span>
        </div>
        <div style="background-color: #000; color: #fff; padding: 10px; border-radius: 0 0 5px 5px;">
            <pre id="codeContainer3" style="background-color: #000; color: #fff; padding: 10px; border-radius: 5px; font-size: large; margin-top: 0; text-align: left;">[
  {
    username: 'mluukkai',
    _id: 123456,
    posts: [221212, 221255],
  },
  {
    username: 'hellas',
    _id: 141414,
    posts: [221244],
  }
];
            </pre>
        </div>
        <!-- Fin de caja de código -->

        <p></p>
        <p><span style="font-size: large;">Dado que los usuarios pueden tener muchas publicaciones, los identificadores relacionados se almacenan en una matriz en el campo </span><code style="font-size: large;">posts</code>
            <span style="font-size: large;">.</span>
        </p>
    </div>
</div>

<script>
    function copyCodeToClipboard(containerId) {
        var codeToCopy = document.getElementById(containerId).innerText;
        navigator.clipboard.writeText(codeToCopy).then(function() {
            var copyIcon = document.getElementById('copyIcon' + containerId.charAt(containerId.length - 1));
            var copyText = document.getElementById('copyText' + containerId.charAt(containerId.length - 1));
            copyIcon.innerHTML = `
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check" viewBox="0 0 16 16">
                <path fill-rule="evenodd" d="M10.854 7.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7.5 9.793l2.646-2.647a.5.5 0 0 1 .708 0"/>
                <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"/>
                <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"/>
            </svg>`;
            copyText.textContent = 'Copiado';
            setTimeout(function() {
                copyIcon.innerHTML = `
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16" id="copyIcon${containerId.charAt(containerId.length - 1)}">
                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"/>
                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"/>
                </svg>`;
                copyText.textContent = 'Copiar código';
            }, 2000); // Cambiar de nuevo a "Copiar código" después de 2 segundos
        }, function(err) {
            console.error('Error al copiar el código: ', err);
        });
    }
</script></div>
            </div>
            <div class="pb-5">
            <div class="book_chapter pt-3" id="ch209486"><article class="flex_titulo_botonera" style="background-color: #E6E1E5;">
    <p class="titulo_principal">Esquema de Mongoose para usuarios</p>
</article>
<div style="background-color: #FAFAFA; font-size: large; color: #010614 ;">
    <br>
    <div style="margin-left: 3%; margin-right: 3%;">
        <p><span class="" style="font-size: large;">En este caso, tomaremos la decisión de almacenar los <span class="" style="color: rgb(0, 61, 245);">ID</span> de las publicaciones creadas por el usuario en el documento de usuario. Definamos el modelo
            para representar a un usuario en el archivo </span><code><span class="" style="font-size: large;">models/user.js</span></code><span class="" style="font-size: large;">:</span></p>

        <!-- Inicio de caja de código -->
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 5px 5px 0 0;">
            <span style="float: left;">JavaScript</span>
            <span style="float: right; cursor: pointer;" onclick="copyCodeToClipboard('codeContainer1')">
                <span id="copyText1">Copiar código</span>
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16" id="copyIcon1">
                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"></path>
                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"></path>
                </svg>
            </span>
        </div>
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 0;">
        </div>
        <div style="background-color: #000; color: #fff; padding: 10px; border-radius: 0 0 5px 5px;">
            <pre style="background-color: #000; color: #fff; padding: 10px; border-radius: 5px; font-size: large; margin-top: 0;" id="codeContainer1">const mongoose = require('mongoose');
const userSchema = new mongoose.Schema({
  username: String,
  name: String,
  passwordHash: String,
  posts: [
    {
      type: mongoose.Schema.Types.ObjectId,
      ref: 'Post'
    }
  ]
});

userSchema.set('toJSON', {
  transform: (document, returnedObject) =&gt; {
    returnedObject.id = returnedObject._id.toString();
    delete returnedObject._id;
    delete returnedObject.__v;
    delete returnedObject.passwordHash;
  }
});

const User = mongoose.model('User', userSchema);
module.exports = User;
            </pre>
        </div>
        <!-- Fin de caja de código -->

        <p></p>
        <p>Los identificadores de las publicaciones se almacenan dentro del documento del usuario como una matriz de ID de Mongo. La definición es la siguiente:</p>

        <!-- Inicio de caja de código -->
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 5px 5px 0 0;">
            <span style="float: left;">JavaScript</span>
            <span style="float: right; cursor: pointer;" onclick="copyCodeToClipboard('codeContainer2')">
                <span id="copyText2">Copiar código</span>
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16" id="copyIcon2">
                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"></path>
                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"></path>
                </svg>
            </span>
        </div>
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 0;">
        </div>
        <div style="background-color: #000; color: #fff; padding: 10px; border-radius: 0 0 5px 5px;">
            <pre style="background-color: #000; color: #fff; padding: 10px; border-radius: 5px; font-size: large; margin-top: 0;" id="codeContainer2">{
  type: mongoose.Schema.Types.ObjectId,
  ref: 'Post'
}
            </pre>
        </div>
        <!-- Fin de caja de código -->

        <p></p>
        <p><span class="" style="font-size: large;">El tipo de campo es </span><code><span class="" style="font-size: large;">ObjectId</span></code><span class="" style="font-size: large;"> que hace referencia a documentos de estilo-post (publicación). Mongo no sabe de manera inherente que este es un campo que hace referencia a posts, la sintaxis está puramente relacionada y definida por Mongoose.</span></p>

        <p><span class="" style="font-size: large;">Expandimos el esquema de post definida en el archivo </span><code><span class="" style="font-size: large;">model/post.js</span></code><span class="" style="font-size: large;"> para que cada post contenga información sobre el usuario que lo creó:</span></p>

        <!-- Inicio de caja de código -->
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 5px 5px 0 0;">
            <span style="float: left;">JavaScript</span>
            <span style="float: right; cursor: pointer;" onclick="copyCodeToClipboard('codeContainer3')">
                <span id="copyText3">Copiar código</span>
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16" id="copyIcon3">
                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"></path>
                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"></path>
                </svg>
            </span>
        </div>
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 0;">
        </div>
        <div style="background-color: #000; color: #fff; padding: 10px; border-radius: 0 0 5px 5px;">
            <pre style="background-color: #000; color: #fff; padding: 10px; border-radius: 5px; font-size: large; margin-top: 0;" id="codeContainer3">const postSchema = new mongoose.Schema({
  content: {
    type: String,
    required: true,
    minlength: 5
  },
  date: Date,
  category: {
    type: String,
    enum: [
      'Tecnología',
      'Hogar',
      'País',
      'Mundo',
      'Música',
      'Tendencias',
      'Salud'
    ]
  },
  user: {
    type: mongoose.Schema.Types.ObjectId,
    ref: 'User'
  }
});
            </pre>
        </div>
        <!-- Fin de caja de código -->
    </div>
</div>

<script>
    function copyCodeToClipboard(containerId) {
        var codeToCopy = document.getElementById(containerId).innerText;
        navigator.clipboard.writeText(codeToCopy).then(function() {
            var copyIcon = document.getElementById('copyIcon' + containerId.slice(-1));
            var copyText = document.getElementById('copyText' + containerId.slice(-1));
            copyIcon.innerHTML = `
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check" viewBox="0 0 16 16">
                <path fill-rule="evenodd" d="M10.854 7.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7.5 9.793l2.646-2.647a.5.5 0 0 1 .708 0"/>
                <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"/>
                <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"/>
            </svg>`;
            copyText.textContent = 'Copiado';
            setTimeout(function() {
                copyIcon.innerHTML = `
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16" id="copyIcon` + containerId.slice(-1) + `">
                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"/>
                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"/>
                </svg>`;
                copyText.textContent = 'Copiar código';
            }, 2000);
        }, function(err) {
            console.error('Error al copiar el código: ', err);
        });
    }
</script></div>
            </div>
            <div class="pb-5">
            <div class="book_chapter pt-3" id="ch209487"><article class="flex_titulo_botonera" style="background-color: #E6E1E5;">
    <p class="titulo_principal">Creando usuarios</p>
</article>
<div style="background-color: #FAFAFA; font-size: large; color: #010614 ;">
    <br>
    <div style="margin-left: 3%; margin-right: 3%;">
        <p><span class="" style="font-size: large;">Implementemos una ruta para crear nuevos usuarios. Los usuarios tienen un nombre de usuario único, un nombre y algo llamado </span><code><span class="" style="font-size: large;">passwordHash</span></code>
            <span class="" style="font-size: large;">. El hash de la contraseña es el resultado de una función hash unidireccional aplicada a la contraseña del usuario. Nunca es aconsejable almacenar contraseñas de texto plano sin cifrar en la base de datos.</span>
        </p>
        <p><span class="" style="font-size: large;">Instala<span class="" style="font-size: large;">mos el paquete </span><code><span class="" style="font-size: large;">bcrypt</span></code><span class="" style="font-size: large;"> para generar los hashes de contraseña:</span></span></p>

        <!-- Inicio de caja de código -->
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 5px 5px 0 0;">
            <span style="float: left;">Terminal</span>
            <span style="float: right; cursor: pointer;" onclick="copyCodeToClipboard('codeContainer1')">
                <span id="copyText1">Copiar código</span>
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16" id="copyIcon1">
                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"></path>
                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"></path>
                </svg>
            </span>
        </div>
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 0;">
        </div>
        <div style="background-color: #000; color: #fff; padding: 10px; border-radius: 0 0 5px 5px;">
            <pre style="background-color: #000; color: #fff; padding: 10px; border-radius: 5px; font-size: large; margin-top: 0;" id="codeContainer1">npm install bcrypt
            </pre>
        </div>
        <!-- Fin de caja de código -->
        <div style="margin-left: 3%; margin-right: 3%;"><br></div>Pongamos manos a la obra:&nbsp;</div>
    <div style="margin-left: 3%; margin-right: 3%;"><br>
        <div style="width: 100%; border-radius: 8px; overflow: hidden; border: 1px solid #9A3282;">
            <p style="background-color: #9A3282; color: white; padding: 4px 16px; margin: 0;"><b>¿que haremos?</b></p>
            <div style="background-color: white; padding: 16px;">
                <p><span style="font-size: large; color: #010614;"><span class="" style="font-size: large;">La creación de nuevos usuarios ocurre al realizar una solicitud HTTP POST a la ruta </span><code><span class="" style="font-size: large;">/users</span></code>
                    <span class="" style="font-size: large;">.</span>
                    </span>
                </p>
                <p><span style="font-size: large; color: #010614;"><span class="" style="font-size: large;">Definamos un enrutador separado para tratar con los usuarios en un nuevo archivo </span><code><span class="" style="font-size: large;">controllers/users.js</span></code>
                    <span class="" style="font-size: large;">.</span>
                    </span>
                </p>
            </div>
        </div>
        <p></p>
        <p>El contenido del archivo que define el enrutador es el siguiente:<br></p>

        <!-- Inicio de caja de código -->
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 5px 5px 0 0;">
            <span style="float: left;">JavaScript</span>
            <span style="float: right; cursor: pointer;" onclick="copyCodeToClipboard('codeContainer2')">
                <span id="copyText2">Copiar código</span>
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16" id="copyIcon2">
                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"></path>
                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"></path>
                </svg>
            </span>
        </div>
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 0;">
        </div>
        <div style="background-color: #000; color: #fff; padding: 10px; border-radius: 0 0 5px 5px;">
            <pre style="background-color: #000; color: #fff; padding: 10px; border-radius: 5px; font-size: large; margin-top: 0;" id="codeContainer2">const bcrypt = require('bcrypt');
const usersRouter = require('express').Router();
const User = require('../models/user');

usersRouter.post('/', async (request, response) =&gt; {
  const body = request.body;
  const saltRounds = 10;
  const passwordHash = await bcrypt.hash(body.password, saltRounds);

  const user = new User({
    username: body.username,
    name: body.name,
    passwordHash
  });

  const savedUser = await user.save();
  response.json(savedUser);
});

module.exports = usersRouter;
            </pre>
        </div>
        <!-- Fin de caja de código -->

        <p><span class="" style="font-size: large;"><br></span></p>
        <p><span class="" style="font-size: large;">Utilizamos el módulo </span><code><span class="" style="font-size: large;">bcrypt</span></code><span class="" style="font-size: large;"> para cifrar la contraseña del usuario antes de guardarla en la base de datos. La contraseña enviada en la solicitud no se almacena en la base de datos. Almacenamos el hash de la contraseña que se genera con la función </span><code><span class="" style="font-size: large;">bcrypt.hash</span></code>
            <span class="" style="font-size: large;">
                </span><span class="" style="font-size: large;">.</span></p>

        <div style="background-color: #FFFEEB; border-right: 6px solid #5811BB; padding: 10px;">
            <p data-sider-select-id="8349c92a-4dd2-456a-9ad2-af345ed621a8" style="text-align: right;"><span class="" style="font-size: large;">
        Las </span><code><span class="" style="font-size: large;">saltRounds</span></code><span class="" style="font-size: large;"> son un parámetro utilizado en la función de hash de contraseñas </span><code><span class="" style="font-size: large;">bcrypt</span></code>
                <span class="" style="font-size: large;">. Es el número de veces que se ejecuta el algoritmo de hash. A medida que aumenta el número de rondas de sal, se hace más difícil para un atacante descifrar las contraseñas almacenadas en la base de datos. Sin embargo, también aumenta
                    el tiempo que se tarda en generar el hash, por lo que se debe buscar un equilibrio adecuado.
                    </span>
            </p>
        </div>

        <p><span class=""><br></span></p>
        <p><span class="" style="font-size: large;">En este caso el número de </span><code><span class="" style="font-size: large;">saltRounds</span></code><span class="" style="font-size: large;"> usado es 10. Veremos más sobre esto cuando aprendamos sobre seguridad de aplicaciones y API REST.</span><br></p>
    </div>
</div>

<script>
    function copyCodeToClipboard(containerId) {
        var codeToCopy = document.getElementById(containerId).innerText;
        navigator.clipboard.writeText(codeToCopy).then(function() {
            var copyIcon = document.getElementById('copyIcon' + containerId.slice(-1));
            var copyText = document.getElementById('copyText' + containerId.slice(-1));
            copyIcon.innerHTML = `
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check" viewBox="0 0 16 16">
                <path fill-rule="evenodd" d="M10.854 7.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7.5 9.793l2.646-2.647a.5.5 0 0 1 .708 0"/>
                <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"/>
                <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"/>
            </svg>`;
            copyText.textContent = 'Copiado';
            setTimeout(function() {
                copyIcon.innerHTML = `
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16" id="copyIcon` + containerId.slice(-1) + `">
                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"/>
                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"/>
                </svg>`;
                copyText.textContent = 'Copiar código';
            }, 2000);
        }, function(err) {
            console.error('Error al copiar el código: ', err);
        });
    }
</script></div>
            </div>
            <div class="pb-5">
            <div class="book_chapter pt-3" id="ch209488"><article class="flex_titulo_botonera" style="background-color: #E6E1E5;">
    <p class="titulo_principal">Usuarios únicos</p>
</article>
<div style="background-color: #FAFAFA; font-size: large; color: #010614;">
    <br>
    <div style="margin-left: 3%; margin-right: 3%;">

        <p><span style="font-size: large;">Validemos la singularidad del nombre de usuario con la ayuda del paquete npm </span><code style="font-size: large;">mongoose-unique-validator</code><span style="font-size: large;">. Vamos a instalarlo:</span></p>

        <!-- Inicio de caja de código -->
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 5px 5px 0 0; display: flex; justify-content: space-between;">
            <span style="align-self: center; font-size: large;">JavaScript</span>
            <span style="align-self: center; cursor: pointer;" onclick="copyCodeToClipboard('codeContainer1')">
                <span id="copyText1" style="font-size: large;">Copiar código</span>
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16" id="copyIcon1">
                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"></path>
                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"></path>
                </svg>
            </span>
        </div>
        <div style="background-color: #000; color: #fff; padding: 10px; border-radius: 0 0 5px 5px;">
            <pre id="codeContainer1" style="background-color: #000; color: #fff; padding: 10px; font-size: large; margin-top: 0; text-align: left;">npm install mongoose-unique-validator
            </pre>
        </div>
        <!-- Fin de caja de código -->

        <p></p>
        <p><span style="font-size: large;">Debemos realizar los siguientes cambios en el esquema definido en el archivo </span><code style="font-size: large;">models/user.js</code><span style="font-size: large;">:</span></p>

        <!-- Inicio de caja de código -->
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 5px 5px 0 0; display: flex; justify-content: space-between;">
            <span style="align-self: center; font-size: large;">JavaScript</span>
            <span style="align-self: center; cursor: pointer;" onclick="copyCodeToClipboard('codeContainer2')">
                <span id="copyText2" style="font-size: large;">Copiar código</span>
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16" id="copyIcon2">
                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"></path>
                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"></path>
                </svg>
            </span>
        </div>
        <div style="background-color: #000; color: #fff; padding: 10px; border-radius: 0 0 5px 5px;">
            <pre id="codeContainer2" style="background-color: #000; color: #fff; padding: 10px; font-size: large; margin-top: 0; text-align: left;">const mongoose = require('mongoose');
const uniqueValidator = require('mongoose-unique-validator');
const userSchema = new mongoose.Schema({
  username: {
    type: String,
    unique: true
  },
  name: String,
  passwordHash: String,
  posts: [
    {
      type: mongoose.Schema.Types.ObjectId,
      ref: 'Post'
    }
  ]
});
userSchema.set('toJSON', {
  transform: (document, returnedObject) =&gt; {
    returnedObject.id = returnedObject._id.toString();
    delete returnedObject._id;
    delete returnedObject.__v;
    delete returnedObject.passwordHash;
  }
});
userSchema.plugin(uniqueValidator);
const User = mongoose.model('User', userSchema);
module.exports = User;
            </pre>
        </div>
        <!-- Fin de caja de código -->

        <p></p>
        <p><span style="font-size: large;">También podríamos implementar otras validaciones en la creación de usuarios. Podríamos comprobar que el nombre de usuario es lo suficientemente largo, que el nombre de usuario solo consta de caracteres permitidos o que la contraseña es lo suficientemente segura.</span></p>

        <p><span style="font-size: large;">Antes de continuar, agreguemos una implementación inicial de un controlador de ruta que devuelve todos los usuarios en la base de datos. En </span><code style="font-size: large;">controllers/users.js</code><span style="font-size: large;">:</span></p>

        <!-- Inicio de caja de código -->
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 5px 5px 0 0; display: flex; justify-content: space-between;">
            <span style="align-self: center; font-size: large;">JavaScript</span>
            <span style="float: right; cursor: pointer;" onclick="copyCodeToClipboard('codeContainer3')">
                <span id="copyText3" style="font-size: large;">Copiar código</span>
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16" id="copyIcon3">
                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"></path>
                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"></path>
                </svg>
            </span>
        </div>
        <div style="background-color: #000; color: #fff; padding: 10px; border-radius: 0 0 5px 5px;">
            <pre id="codeContainer3" style="background-color: #000; color: #fff; padding: 10px; font-size: large; margin-top: 0; text-align: left;">usersRouter.get('/', async (request, response) =&gt; {
  const users = await User.find({});
  response.json(users);
});
            </pre>
        </div>
        <!-- Fin de caja de código -->

        <p></p>
        <p><span style="font-size: large;">Vamos a probar crear un nuevo usuario con Postman. Utilizamos la url </span><code style="font-size: large;">http://localhost:8000/api/users</code><span style="font-size: large;"> con una petición POST y le pasamos los datos del nuevo usuario (username, name y password).</span></p>

        <p style="text-align: center;">
            <img src="https://aulasvirtuales.bue.edu.ar/pluginfile.php/2801042/mod_book/chapter/209488/134568009888.png" alt="" width="926" height="524" role="presentation" class="img-responsive atto_image_button_text-bottom">
        </p>

        <p><span style="font-size: large;">Podemos observar que obtenemos el usuario creado con un array de posts vacío, ya que aún no hemos agregado ningún post. Además, si hacemos un GET a </span><code style="font-size: large;">http://localhost:8000/api/users</code>
            <span style="font-size: large;"> podemos obtener la lista de todos los usuarios creados.</span>
        </p>

    </div>
</div>

<script>
    function copyCodeToClipboard(containerId) {
        var codeToCopy = document.getElementById(containerId).innerText;
        navigator.clipboard.writeText(codeToCopy).then(function() {
            var copyIcon = document.getElementById('copyIcon' + containerId.charAt(containerId.length - 1));
            var copyText = document.getElementById('copyText' + containerId.charAt(containerId.length - 1));
            copyIcon.innerHTML = `
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check" viewBox="0 0 16 16">
                <path fill-rule="evenodd" d="M10.854 7.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7.5 9.793l2.646-2.647a.5.5 0 0 1 .708 0"/>
                <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"/>
                <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"></path>
            </svg>`;
            copyText.textContent = 'Copiado';
            setTimeout(function() {
                copyIcon.innerHTML = `
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16" id="copyIcon${containerId.charAt(containerId.length - 1)}">
                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"/>
                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"></path>
                </svg>`;
                copyText.textContent = 'Copiar código';
            }, 2000); // Cambiar de nuevo a "Copiar código" después de 2 segundos
        }, function(err) {
            console.error('Error al copiar el código: ', err);
        });
    }
</script></div>
            </div>
            <div class="pb-5">
            <div class="book_chapter pt-3" id="ch209489"><article class="flex_titulo_botonera" style="background-color: #E6E1E5;">
    <p class="titulo_principal">Creación de una nueva publicación</p>
</article>
<div style="background-color: #FAFAFA; font-size: large; color: #010614;">
    <br>
    <div style="margin-left: 3%; margin-right: 3%;">

        <p><span class="" style="font-size: large;">El código para crear una nueva publicación debe permitir que la publicación se asigne al usuario que la creó. En </span><code><span class="" style="font-size: large;">/controllers/posts.js</span></code>
            <span class="" style="font-size: large;">:</span>
        </p>

        <!-- Inicio de caja de código -->
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 5px 5px 0 0;">
            <span style="float: left;">JavaScript</span>
            <span style="float: right; cursor: pointer;" onclick="copyCodeToClipboard()">
                <span id="copyText">Copiar código</span>
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16" id="copyIcon">
                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"></path>
                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"></path>
                </svg>
            </span>
        </div>
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 0;">
        </div>
        <div style="background-color: #000; color: #fff; padding: 10px; border-radius: 0 0 5px 5px;">
            <pre id="codeContainer" style="background-color: #000; color: #fff; padding: 10px; font-size: large;">const postsRouter = require('express').Router();
const Post = require('../models/post');
const User = require('../models/user');

postsRouter.get('/', async (request, response) =&gt; {
  const posts = await Post.find({});
  response.json(posts);
});

postsRouter.get('/:id', async (request, response) =&gt; {
  const post = await Post.findById(request.params.id);
  if (post) {
    response.json(post.toJSON());
  } else {
    response.status(404).end();
  }
});

postsRouter.post('/', async (request, response) =&gt; {
  const body = request.body;
  const user = await User.findById(body.userId);

  const post = new Post({
    title: body.title,
    content: body.content,
    category: body.category,
    date: new Date(),
    user: user._id
  });

  const savedPost = await post.save();
  user.posts = user.posts.concat(savedPost._id);
  await user.save();

  response.status(201).json(savedPost);
});

postsRouter.delete('/:id', async (request, response) =&gt; {
  await Post.findByIdAndRemove(request.params.id);
  response.status(204).end();
});

postsRouter.put('/:id', (request, response, next) =&gt; {
  const body = request.body;
  const post = {
    title: body.title,
    content: body.content,
    category: body.category
  };

  Post.findByIdAndUpdate(request.params.id, post, { new: true })
    .then((updatedPost) =&gt; {
      response.json(updatedPost);
    })
    .catch((error) =&gt; next(error));
});

module.exports = postsRouter;
            </pre>
        </div>
        <!-- Fin de caja de código -->

        <p><span class="" style="font-size: large;"></span></p>
        <p><span class="" style="font-size: large;">Además, vemos que el objeto </span><code><span class="" style="font-size: large;">user</span></code><span class="" style="font-size: large;"> también cambia, ya que el id de la publicación se almacena en el campo </span><code><span class="" style="font-size: large;">posts</span></code><span class="" style="font-size: large;">
            </span><span class="" style="font-size: large;">.</span><span class="" style="font-size: large;">
        </span></p>

        <p><span class="" style="font-size: large;">Intentemos crear una nueva publicación en Postman:</span></p>

        <p><span class="" style="font-size: large;"><span class="" style="font-size: large;">Enviamos una solicitud </span><span class="" style="color: rgb(0, 61, 245); font-size: large;">POST</span><span class="" style="font-size: large;"> a </span></span><code><span class="" style="font-size: large;">http://localhost:8000/api/posts</span></code><span class="" style="font-size: large;"> con el contenido de un post<span class="" style="color: rgb(0, 61, 245);"> (title, content, category y userId)</span>, y obtenemos como respuesta un código 201 Created y en el body la información del post con su nuevo id. Es importante notar que debemos enviarle el </span><code><span class="" style="font-size: large;">userId</span></code><span class="" style="font-size: large;">
            </span><span class="" style="font-size: large;"> correspondiente al usuario autor del post.</span>
        </p>

        <p style="text-align: center;">
            <img src="https://aulasvirtuales.bue.edu.ar/pluginfile.php/2801042/mod_book/chapter/209489/una.png" alt="" width="957" height="618" role="presentation" class="img-responsive atto_image_button_text-bottom">
        </p>

        <p><span class="" style="font-size: large;">Finalmente, si ahora buscamos obtener todos los usuarios haciendo GET a </span><code><span class="" style="font-size: large;">http://localhost:8000/api/users/</span></code><span class="" style="font-size: large;">, podemos observar que nos devuelve un array con el usuario creado (admin) y su lista de </span><code><span class="" style="font-size: large;">posts</span></code>
            <span class="" style="font-size: large;">:</span>
        </p>

        <p style="text-align: center;">
            <img src="https://aulasvirtuales.bue.edu.ar/pluginfile.php/2801042/mod_book/chapter/209489/dos.png" alt="" width="957" height="618" role="presentation" class="img-responsive atto_image_button_text-bottom">
        </p>

    </div>
</div>

<script>
    function copyCodeToClipboard() {
        var codeToCopy = document.getElementById("codeContainer").innerText;
        navigator.clipboard.writeText(codeToCopy).then(function() {
            var copyIcon = document.getElementById('copyIcon');
            var copyText = document.getElementById('copyText');
            copyIcon.innerHTML = `
            &lt;svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check" viewBox="0 0 16 16"&gt;
                &lt;path fill-rule="evenodd" d="M10.854 7.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7.5 9.793l2.646-2.647a.5.5 0 0 1 .708 0"/&gt;
                &lt;path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"/&gt;
                &lt;path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"&gt;&lt;/path&gt;
            &lt;/svg&gt;`;
            copyText.textContent = 'Copiado';
            setTimeout(function() {
                copyIcon.innerHTML = `
                &lt;svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16" id="copyIcon"&gt;
                    &lt;path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"/&gt;
                    &lt;path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"&gt;&lt;/path&gt;
                &lt;/svg&gt;`;
                copyText.textContent = 'Copiar código';
            }, 2000); // Cambiar de nuevo a "Copiar código" después de 2 segundos
        }, function(err) {
            console.error('Error al copiar el código: ', err);
        });
    }

    document.getElementById("codeContainer").addEventListener("paste", function(e) {
        e.preventDefault();
        var text = e.clipboardData.getData("text/plain");
        var coloredText = text.replace(/&/g, '&amp;').replace(/&lt;/g, '&lt;').replace(/&gt;/g, '&gt;').replace(/\\x1b\(([0-9]+)m(.*?)\\x1b\(0m/g, '&lt;span style="color: rgb($1);"&gt;$2&lt;/span&gt;');
        document.getElementById("codeContainer").innerHTML = coloredText;
    });
</script> </div>
            </div>
            <div class="pb-5">
            <div class="book_chapter pt-3" id="ch209490"><article class="flex_titulo_botonera" style="background-color: #E6E1E5;">
    <p class="titulo_principal">Combinar usuarios y posts</p>
</article>
<div style="background-color: #FAFAFA; font-size: large; color: #010614;">
    <br>
    <div style="margin-left: 3%; margin-right: 3%;">

        <p><span class="" style="font-size: large;">Vamos a hacer que nuestra API funcione de tal manera que cuando se realiza una solicitud HTTP GET a la ruta </span><code><span class="" style="font-size: large;">/api/users</span></code><span class="" style="font-size: large;">, los objetos de usuario también contengan el contenido de los posts del usuario, y no solo su identificación. En una base de datos relacional, esta funcionalidad se implementaría con una consulta de combinación.</span></p>

        <!-- Cuadro con formato solicitado para "Mongoose logra la unión..." -->
        <div class="" style="width: 90%; margin: 0 auto;">
            <div class="row">
                <div class="col-1" style="background-color: #ae11a0; border-radius: 4px 0px 0px 4px;">
                    <div class="d-flex justify-content-center" style="margin-top: 20px">
                        <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" fill="white" class="bi bi-card-text" viewBox="0 0 16 16">
                            <path d="M14.5 3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-13a.5.5 0 0 1-.5-.5v-9a.5.5 0 0 1 .5-.5zm-13-1A1.5 1.5 0 0 0 0 3.5v9A1.5 1.5 0 0 0 1.5 14h13a1.5 1.5 0 0 0 1.5-1.5v-9A1.5 1.5 0 0 0 14.5 2z"></path>
                            <path d="M3 5.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5M3 8a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9A.5.5 0 0 1 3 8m0 2.5a.5.5 0 0 1 .5-.5h6a.5.5 0 0 1 0 1h-6a.5.5 0 0 1-.5-.5"></path>
                        </svg>
                    </div>
                </div>
                <div class="col-11" style="background-color: #F6E7F5;border: 1px solid #ae11a0; border-radius: 0px 4px 4px 0px;">
                    <p style="margin-top: 16px;">Mongoose logra la unión haciendo múltiples consultas, lo cual es diferente de las consultas de unión en bases de datos relacionales que son transaccionales, lo que significa que el estado de la base de datos no cambia durante el tiempo
                        que se realiza la consulta.</p>
                    <p>Con las consultas de unión en Mongoose, nada puede garantizar que el estado entre las colecciones que se están uniendo sea coherente, lo que significa que si hacemos una consulta que une al usuario y las colecciones de posts, el estado
                        de las colecciones puede cambiar durante la consulta.</p>
                </div>
            </div>
        </div>
        <!-- Fin del cuadro -->

        <p><span class="" style="font-size: large;"><br></span></p>
        <p><span class="" style="font-size: large;">La unión de Mongoose se realiza con el método </span><code><span class="" style="font-size: large;">populate</span></code><span class="" style="font-size: large;">. Actualicemos la ruta que devuelve todos los usuarios primero, en </span><code><span class="" style="font-size: large;">controllers/users.js</span></code>
            <span class="" style="font-size: large;">
                </span><span class="" style="font-size: large;">:</span>
        </p>

        <!-- Inicio de caja de código -->
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 5px 5px 0 0;">
            <span style="float: left;">JavaScript</span>
            <span style="float: right; cursor: pointer;" onclick="copyCodeToClipboard('codeContainer1')">
                <span id="copyText1">Copiar código</span>
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16" id="copyIcon1">
                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"></path>
                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"></path>
                </svg>
            </span>
        </div>
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 0;">
        </div>
        <div style="background-color: #000; color: #fff; padding: 10px; border-radius: 0 0 5px 5px;">
            <pre id="codeContainer1" style="background-color: #000; color: #fff; padding: 10px; font-size: large;">usersRouter.get('/', async (request, response) =&gt; {
  const users = await User.find({}).populate('posts');
  response.json(users);
});
            </pre>
        </div>
        <!-- Fin de caja de código -->

        <p><span class="" style="font-size: large;"><br></span></p>
        <p><span class="" style="font-size: large;">El método </span><code><span class="" style="font-size: large;">populate</span></code><span class="" style="font-size: large;"> se encadena después de que el método </span><code><span class="" style="font-size: large;">find</span></code>
            <span class="" style="font-size: large;"> realiza la consulta inicial. El parámetro dado al método </span><code><span class="" style="font-size: large;">populate</span></code><span class="" style="font-size: large;"> define que los objetos ids que hacen referencia a </span><code><span class="" style="font-size: large;">posts</span></code>
            <span class="" style="font-size: large;"> en el campo </span><code><span class="" style="font-size: large;">posts</span></code><span class="" style="font-size: large;"> del documento </span><code><span class="" style="font-size: large;">user</span></code>
            <span class="" style="font-size: large;"> serán reemplazados por los documentos de </span><code><span class="" style="font-size: large;">post</span></code><span class="" style="font-size: large;"> referenciados.</span></p>

        <p><span class="" style="font-size: large;">Ahora, si hacemos un GET a </span><code><span class="" style="font-size: large;">http://localhost:8000/api/users/</span></code><span class="" style="font-size: large;">, veremos que obtenemos el listado de posts del usuario, no solo con el id sino también con la información de cada post:</span></p>

        <p style="text-align: center;"><img src="https://aulasvirtuales.bue.edu.ar/pluginfile.php/2801042/mod_book/chapter/209490/tres.png" alt="" width="957" height="618" role="presentation" class="img-responsive atto_image_button_text-bottom"><br></p><p style="text-align: left;">Sintaxis:</p>

        <!-- Inicio de caja de código -->
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 5px 5px 0 0;">
            <span style="float: left;">JavaScript</span>
            <span style="float: right; cursor: pointer;" onclick="copyCodeToClipboard('codeContainer2')">
                <span id="copyText2">Copiar código</span>
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16" id="copyIcon2">
                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"></path>
                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"></path>
                </svg>
            </span>
        </div>
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 0;">
        </div>
        <div style="background-color: #000; color: #fff; padding: 10px; border-radius: 0 0 5px 5px;">
            <pre id="codeContainer2" style="background-color: #000; color: #fff; padding: 10px; font-size: large;">usersRouter.get('/', async (request, response) =&gt; {
  const users = await User.find({}).populate('posts', { title: 1, date: 1 });
  response.json(users);
});
            </pre>
        </div>
        <!-- Fin de caja de código -->

    </div>
</div>

<!-- Script para copiar código -->
<script>
    function copyCodeToClipboard(containerId) {
        var codeToCopy = document.getElementById(containerId).innerText;
        navigator.clipboard.writeText(codeToCopy).then(function() {
            var copyIcon = document.getElementById('copyIcon' + containerId.replace('codeContainer', ''));
            var copyText = document.getElementById('copyText' + containerId.replace('codeContainer', ''));
            copyIcon.innerHTML = `
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M10.854 7.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7.5 9.793l2.646-2.647a.5.5 0 0 1 .708 0"/>
                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"/>
                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"></path>
                </svg>`;
            copyText.textContent = 'Copiado';
            setTimeout(function() {
                copyIcon.innerHTML = `
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16">
                        <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"/>
                        <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"></path>
                    </svg>`;
                copyText.textContent = 'Copiar código';
            }, 2000); // Cambiar de nuevo a "Copiar código" después de 2 segundos
        }, function(err) {
            console.error('Error al copiar el código: ', err);
        });
    }
</script>
<!-- Fin del script para copiar código --></div>
            </div>
            <div class="pb-5">
            <div class="book_chapter pt-3" id="ch209491"><article class="flex_titulo_botonera" style="background-color: #E6E1E5;">
    <p class="titulo_principal">Autenticación de usuarios con token</p>
</article>
<div style="background-color: #FAFAFA; font-size: large; color: #010614;">
    <br>
    <div style="margin-left: 3%; margin-right: 3%;">

        <span id="docs-internal-guid-6987832e-7fff-a57a-4ebe-6718559955c5">
            <p dir="ltr">Los usuarios deben poder iniciar sesión en nuestra aplicación, y cuando un usuario inicia sesión, su información de usuario debe adjuntarse automáticamente a cualquier publicación nueva que cree.</p>
            
            <!-- Actualización de título con formato especial -->
            <div style="background-color:#87CEEB; display: inline-flex; height: 6px;">
                <p style="font-size: x-large; color: #010614; margin-top: -22px; padding-right: 4px" data-sider-select-id="93101215-b3ea-463e-83f8-5745366f7f57">Login</p>
            </div>

            <p dir="ltr"><span class="" style="font-size: large;"></span></p>
            <p dir="ltr"><span class="" style="font-size: large;">Primero implementemos la funcionalidad para iniciar sesión. Instalamos la librería </span><code><span class="" style="font-size: large;">jsonwebtoken</span></code><span class="" style="font-size: large;">, que nos permite generar </span>
            <span class="" style="font-size: large;">
                </span><span class="" style="color: rgb(0, 61, 245); font-size: large;">tokens web JSON</span><span class="" style="font-size: large;">.</span></p>

            <!-- Caja de código para npm install jsonwebtoken -->
            <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 5px 5px 0 0;">
                <span style="float: left;">Shell</span>
                <span style="float: right; cursor: pointer;" onclick="copyCodeToClipboard('codeContainer1')">
                    <span id="copyText1">Copiar código</span>
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16" id="copyIcon1">
                        <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"></path>
                        <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"></path>
                    </svg>
                </span>
            </div>
            <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 0;"></div>
            <div style="background-color: #000; color: #fff; padding: 10px; border-radius: 0 0 5px 5px;">
                <pre id="codeContainer1" style="background-color: #000; color: #fff; padding: 10px; font-size: large;">npm install jsonwebtoken
                </pre>
            </div>
            <!-- Fin de caja de código -->

            <p dir="ltr"><span class=""></span></p>
            <p dir="ltr"><span class="">El código para la funcionalidad de inicio de sesión va a los controladores de </span><code><span class="" style="font-size: large;">controllers/login.js</span></code><span class="">.</span><br></p>

            <!-- Caja de código para controllers/login.js -->
            <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 5px 5px 0 0;">
                <span style="float: left;">JavaScript</span>
                <span style="float: right; cursor: pointer;" onclick="copyCodeToClipboard('codeContainer2')">
                    <span id="copyText2">Copiar código</span>
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16" id="copyIcon2">
                        <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"></path>
                        <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"></path>
                    </svg>
                </span>
            </div>
            <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 0;"></div>
            <div style="background-color: #000; color: #fff; padding: 10px; border-radius: 0 0 5px 5px;">
                <pre id="codeContainer2" style="background-color: #000; color: #fff; padding: 10px; font-size: large;">const jwt = require('jsonwebtoken');
const bcrypt = require('bcrypt');
const loginRouter = require('express').Router();
const User = require('../models/user');

loginRouter.post('/', async (request, response) =&gt; {
  const body = request.body;
  const user = await User.findOne({ username: body.username });
  const passwordCorrect =
    user === null
      ? false
      : await bcrypt.compare(body.password, user.passwordHash);

  if (!(user &amp;&amp; passwordCorrect)) {
    return response.status(401).json({
      error: 'invalid username or password'
    });
  }

  const userForToken = {
    username: user.username,
    id: user._id
  };

  const token = jwt.sign(userForToken, process.env.SECRET);

  response
    .status(200)
    .send({ token, username: user.username, name: user.name });
});

module.exports = loginRouter;
                </pre>
            </div>
            <!-- Fin de caja de código -->

            <p dir="ltr"></p>
            <p dir="ltr"><span class="" style="font-size: large;">El código comienza buscando al usuario en la base de datos por el nombre de usuario adjunto a la solicitud. A continuación, verifica la contraseña, también adjunta a la solicitud. Debido a que las contraseñas en sí no se guardan en la base de
            datos, sino hash calculadas a partir de las contraseñas, el método </span><code><span class="" style="font-size: large;">bcrypt.compare</span></code><span class="" style="font-size: large;"> se usa para verificar si la contraseña es correcta:</span></p>

            <!-- Caja de código para bcrypt.compare -->
            <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 5px 5px 0 0;">
                <span style="float: left;">JavaScript</span>
                <span style="float: right; cursor: pointer;" onclick="copyCodeToClipboard('codeContainer3')">
                    <span id="copyText3">Copiar código</span>
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16" id="copyIcon3">
                        <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"></path>
                        <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"></path>
                    </svg>
                </span>
            </div>
            <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 0;"></div>
            <div style="background-color: #000; color: #fff; padding: 10px; border-radius: 0 0 5px 5px;">
                <pre id="codeContainer3" style="background-color: #000; color: #fff; padding: 10px; font-size: large;">await bcrypt.compare(body.password, user.passwordHash);
                </pre>
            </div>
            <!-- Fin de caja de código -->

            <p dir="ltr"></p>
            <p dir="ltr">Si no se encuentra el usuario o la contraseña es incorrecta, se responde a la solicitud con el código de estado 401 <span><span class="" style="color: rgb(0, 61, 245);">Unauthorized</span></span>. El motivo del error se explica en el cuerpo de
            respuesta.
            </p>
            <p dir="ltr">El código de respuesta HTTP 401 <span><span class="" style="color: rgb(0, 61, 245);">Unauthorized</span></span><span class="" style="color: rgb(0, 61, 245);"> </span>generalmente se utiliza para indicar que el cliente no tiene permiso o no tiene
            el nivel de autorización necesario para acceder al recurso solicitado.</p>
            <p dir="ltr"><span class="" style="font-size: large;">Si la contraseña es correcta, se crea un token con el método </span><code><span class="" style="font-size: large;">jwt.sign</span></code><span class="" style="font-size: large;">. El token contiene el nombre de usuario y la identificación de usuario en un formulario firmado digitalmente.</span></p>

            <!-- Caja de código para userForToken y token -->
            <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 5px 5px 0 0;">
                <span style="float: left;">JavaScript</span>
                <span style="float: right; cursor: pointer;" onclick="copyCodeToClipboard('codeContainer4')">
                    <span id="copyText4">Copiar código</span>
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16" id="copyIcon4">
                        <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"></path>
                        <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"></path>
                    </svg>
                </span>
            </div>
            <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 0;"></div>
            <div style="background-color: #000; color: #fff; padding: 10px; border-radius: 0 0 5px 5px;">
                <pre id="codeContainer4" style="background-color: #000; color: #fff; padding: 10px; font-size: large;">const userForToken = {
    username: user.username,
    id: user._id
};
const token = jwt.sign(userForToken, process.env.SECRET);
                </pre>
            </div>
            <!-- Fin de caja de código -->

            <p dir="ltr"></p>
            <p dir="ltr"><span class="" style="font-size: large;">El token se firma digitalmente usando una cadena de variable de entorno </span><span><code style="">SECRET</code></span><span class="" style="font-size: large;"> como secreto. La firma digital garantiza que solo las partes que conocen el secreto puedan generar un token válido. El valor de la variable de entorno
            debe establecerse en el archivo </span><code><span class="" style="font-size: large;">.env</span></code><span class="" style="font-size: large;">. A fines prácticos, utilizaremos cualquier string, aunque podríamos generar una clave secreta como hemos visto anteriormente.</span></p>

            <!-- Caja de código para archivo .env -->
            <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 5px 5px 0 0;">
                <span style="float: left;">Shell</span>
                <span style="float: right; cursor: pointer;" onclick="copyCodeToClipboard('codeContainer5')">
                    <span id="copyText5">Copiar código</span>
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16" id="copyIcon5">
                        <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"></path>
                        <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"></path>
                    </svg>
                </span>
            </div>
            <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 0;"></div>
            <div style="background-color: #000; color: #fff; padding: 10px; border-radius: 0 0 5px 5px;">
                <pre id="codeContainer5" style="background-color: #000; color: #fff; padding: 10px; font-size: large;">SECRET=esteesunsecretkey
                </pre>
            </div>
            <!-- Fin de caja de código -->

            <p dir="ltr"></p>
            <p dir="ltr"><span class="" style="font-size: large;">Una solicitud exitosa se responde con el código de estado 200 </span><span class="" style="color: rgb(0, 61, 245); font-size: large;">OK</span><span class="" style="font-size: large;">. El token generado y el nombre de usuario del usuario se devuelven al cuerpo de la respuesta.</span></p>
            <p dir="ltr"><span class="" style="font-size: large;">Ahora, el código de inicio de sesión solo debe agregarse a la aplicación agregando el nuevo enrutador a </span><code><span class="" style="font-size: large;">app.js</span></code><span class="" style="font-size: large;">.</span></p>

            <!-- Caja de código para agregar loginRouter a app.js -->
            <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 5px 5px 0 0;">
                <span style="float: left;">JavaScript</span>
                <span style="float: right; cursor: pointer;" onclick="copyCodeToClipboard('codeContainer6')">
                    <span id="copyText6">Copiar código</span>
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16" id="copyIcon6">
                        <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"></path>
                        <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"></path>
                    </svg>
                </span>
            </div>
            <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 0;"></div>
            <div style="background-color: #000; color: #fff; padding: 10px; border-radius: 0 0 5px 5px;">
                <pre id="codeContainer6" style="background-color: #000; color: #fff; padding: 10px; font-size: large;">const loginRouter = require('./controllers/login');
//...
app.use('/api/login', loginRouter);
                </pre>
            </div>
            <!-- Fin de caja de código -->

            <!-- Formato solicitado para los textos -->
            <div style="background-color: #FAFAFA; font-size: large; color: #010614 ;">
                <div style="margin-left: 3%; margin-right: 3%;"><br></div><div style="margin-left: 3%; margin-right: 3%;">Resultado:</div><div style="margin-left: 3%; margin-right: 3%;"><br>
                    <!-- 1 -->
                    <div class="row" style="margin-left: 32px">
                        <div>
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-1-circle-fill" viewBox="0 0 16 16" style=" color: #062558">
                                <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0ZM9.283 4.002H7.971L6.072 5.385v1.271l1.834-1.318h.065V12h1.312V4.002Z"></path>
                            </svg>
                        </div>
                        <div class="col">
                            <p><span style="font-weight: 600">Un inicio de sesión exitoso:</span> Devuelve los detalles del usuario y el token.</p>
                        </div>
                    </div>

                    <!-- 2 -->
                    <div class="row" style="margin-left: 32px">
                        <div>
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-2-circle-fill" viewBox="0 0 16 16" style=" color: #062558">
                                <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0ZM6.646 6.24c0-.691.493-1.306 1.336-1.306.756 0 1.313.492 1.313 1.236 0 .697-.469 1.23-.902 1.705l-2.971 3.293V12h5.344v-1.107H7.268v-.077l1.974-2.22.096-.107c.688-.763 1.287-1.428 1.287-2.43 0-1.266-1.031-2.215-2.613-2.215-1.758 0-2.637 1.19-2.637 2.402v.065h1.271v-.07Z"></path>
                            </svg>
                        </div>
                        <div class="col">
                            <p><span style="font-weight: 600">Un nombre de usuario o contraseña incorrectos:</span> Devuelve un mensaje de error y el código de estado correcto.</p>
                        </div>
                    </div>
                </div>
            </div>
        </span>
    </div>
</div>

<!-- Script para copiar código -->
<script>
    function copyCodeToClipboard(containerId) {
        var codeToCopy = document.getElementById(containerId).innerText;
        navigator.clipboard.writeText(codeToCopy).then(function() {
            var copyIcon = document.getElementById('copyIcon' + containerId.replace('codeContainer', ''));
            var copyText = document.getElementById('copyText' + containerId.replace('codeContainer', ''));
            copyIcon.innerHTML = `
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M10.854 7.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7.5 9.793l2.646-2.647a.5.5 0 0 1 .708 0"/>
                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"/>
                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"/>
                </svg>`;
            copyText.textContent = 'Copiado';
            setTimeout(function() {
                copyIcon.innerHTML = `
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16">
                        <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"/>
                        <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"/>
                    </svg>`;
                copyText.textContent = 'Copiar código';
            }, 2000); // Cambiar de nuevo a "Copiar código" después de 2 segundos
        }, function(err) {
            console.error('Error al copiar el código: ', err);
        });
    }
</script>
<!-- Fin del script para copiar código --></div>
            </div>
            <div class="pb-5">
            <div class="book_chapter pt-3" id="ch209492"><article class="flex_titulo_botonera" style="background-color: #E6E1E5;">
    <p class="titulo_principal">Limitación de la creación de nuevos posts a los usuarios registrados</p>
</article>
<div style="background-color: #FAFAFA; font-size: large; color: #010614 ;">
    <br>
    <div style="margin-left: 3%; margin-right: 3%;">



        <p></p><span id="docs-internal-guid-c3c8dc8e-7fff-26f9-d32b-23934250cbcf"><p dir="ltr" style="">Cambiemos la creación de nuevas publicaciones para que solo sea posible si la solicitud POST tiene un token válido adjunto. Luego, la publicación se guarda en la lista de publicaciones del usuario identificado por el token.</p><div style="width: 100%; border-radius: 8px; overflow: hidden; border: 1px solid #9A3282;">
    <p style="background-color: #9A3282; color: white; padding: 4px 16px; margin: 0;">
        <span style="font-size: large;"><b>Encabezado Authorization</b></span>
    </p>
    <div style="background-color: white; padding: 16px;">
        <p><span style="font-size: large; color: #010614;">Hay varias formas de enviar el token desde el navegador al servidor. Usaremos el encabezado Authorization. El encabezado también indica qué esquema de autenticación se utiliza. Esto puede ser necesario si el servidor ofrece varias formas de autenticación.</span></p>
    </div>
</div>
<p dir="ltr" style=""><br></p><p dir="ltr" style="">La identificación del esquema le dice al servidor cómo se deben interpretar las credenciales adjuntas. Utilizaremos el esquema Bearer.</p></span><br>
        <p></p>



        <!-- nada puede haber abajo -->

    </div>
</div></div>
            </div>
            <div class="pb-5">
            <div class="book_chapter pt-3" id="ch209493"><article class="flex_titulo_botonera" style="background-color: #E6E1E5;">
    <p class="titulo_principal">Bearer</p>
</article>
<div style="background-color: #FAFAFA; font-size: large; color: #010614;">
    <br>
    <div style="margin-left: 3%; margin-right: 3%;">

        <p> <code><span style="font-size: large;" class="">Bearer  </span></code><span style="font-size: large;" class=""> es un tipo de esquema de autenticación utilizado en la autenticación de recursos HTTP. En este esquema, un token es incluido en el encabezado de la solicitud HTTP como un valor de la autorización. El servidor recibe el token
            de portador y lo utiliza para validar la solicitud y determinar el usuario autenticado.</span></p>

        <div style="width: 100%; border-radius: 8px; overflow: hidden; border: 1px solid #9A3282;">
            <p style="background-color: #9A3282; color: white; padding: 4px 16px; margin: 0;">
                <span style="font-size: large;"><b>Sintaxis de uso del token en una solicitud HTTP</b></span>
            </p>
            <div style="background-color: white; padding: 16px;">
                <p><span style="font-size: large; color: #010614;">para incluir un token en una solicitud HTTP es "Authorization: Bearer &lt;token&gt;".</span></p>
            </div>
        </div>

        <p></p>
        <p><span style="font-size: large;">En la práctica, esto significa que si el token es, por ejemplo, la cadena </span><code><span style="font-size: large;">eyJhbGciOiJIUzI1NiIsInR5c2VybmFtZSI6Im1sdXVra2FpIiwiaW</span></code>
            <span style="font-size: large;">, el encabezado de autorización tendrá el valor:</span>
        </p>
        <p></p>

        <!-- Inicio de caja de código -->
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 5px 5px 0 0; display: flex; justify-content: space-between;">
            <span style="align-self: center; font-size: large;">Shell</span>
            <span style="align-self: center; cursor: pointer;" onclick="copyCodeToClipboard('codeContainer1')">
                <span id="copyText1" style="font-size: large;">Copiar código</span>
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16" id="copyIcon1">
                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"></path>
                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"></path>
                </svg>
            </span>
        </div>
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 0;"></div>
        <div style="background-color: #000; color: #fff; padding: 10px; border-radius: 0 0 5px 5px;">
            <pre id="codeContainer1" style="background-color: #000; color: #fff; padding: 10px; font-size: large;">Bearer eyJhbGciOiJIUzI1NiIsInR5c2VybmFtZSI6Im1sdXVra2FpIiwiaW</pre>
        </div>
        <!-- Fin de caja de código -->

        <p></p>
        <p>La función de creación de nuevos posts cambiará de este modo:</p>

        <!-- Inicio de caja de código -->
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 5px 5px 0 0; display: flex; justify-content: space-between;">
            <span style="align-self: center; font-size: large;">JavaScript</span>
            <span style="align-self: center; cursor: pointer;" onclick="copyCodeToClipboard('codeContainer2')">
                <span id="copyText2" style="font-size: large;">Copiar código</span>
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16" id="copyIcon2">
                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"></path>
                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"></path>
                </svg>
            </span>
        </div>
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 0;"></div>
        <div style="background-color: #000; color: #fff; padding: 10px; border-radius: 0 0 5px 5px;">
            <pre id="codeContainer2" style="background-color: #000; color: #fff; padding: 10px; font-size: large;">const jwt = require('jsonwebtoken');
const getTokenFrom = (request) =&gt; {
  const authorization = request.get('authorization');
  if (authorization &amp;&amp; authorization.toLowerCase().startsWith('bearer ')) {
    return authorization.substring(7);
  }
  return null;
};

postsRouter.post('/', async (request, response) =&gt; {
  const body = request.body;
  const token = getTokenFrom(request);
  const decodedToken = jwt.verify(token, process.env.SECRET);

  if (!token || !decodedToken.id) {
    return response.status(401).json({ error: 'token missing or invalid' });
  }

  const user = await User.findById(decodedToken.id);
  const post = new Post({
    title: body.title,
    content: body.content,
    category: body.category,
    date: new Date(),
    user: user._id
  });

  const savedPost = await post.save();
  user.posts = user.posts.concat(savedPost._id);
  await user.save();
  response.status(201).json(savedPost);
});
            </pre>
        </div>
        <!-- Fin de caja de código -->

        <p></p>
        <p><span style="font-size: large;">La función auxiliar </span><code><span style="font-size: large;">getTokenFrom</span></code><span style="font-size: large;"> aísla el token del encabezado de authorization. La validez del token se comprueba con </span><code><span style="font-size: large;">jwt.verify</span></code>
            <span style="font-size: large;">. El método también decodifica el token, o devuelve el objeto en el que se basó el token:</span></p>

        <!-- Inicio de caja de código -->
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 5px 5px 0 0; display: flex; justify-content: space-between;">
            <span style="align-self: center; font-size: large;">JavaScript</span>
            <span style="align-self: center; cursor: pointer;" onclick="copyCodeToClipboard('codeContainer3')">
                <span id="copyText3" style="font-size: large;">Copiar código</span>
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16" id="copyIcon3">
                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"></path>
                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"></path>
                </svg>
            </span>
        </div>
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 0;"></div>
        <div style="background-color: #000; color: #fff; padding: 10px; border-radius: 0 0 5px 5px;">
            <pre id="codeContainer3" style="background-color: #000; color: #fff; padding: 10px; font-size: large;">const decodedToken = jwt.verify(token, process.env.SECRET);</pre>
        </div>
        <!-- Fin de caja de código -->

        <p><br></p>
        <p><span style="font-size: large;">El objeto decodificado del token contiene los campos </span><code><span style="font-size: large;">username</span></code><span style="font-size: large;"> e </span><code><span style="font-size: large;">id</span></code>
            <span style="font-size: large;">
                </span><span style="font-size: large;">, que le dice al servidor quién hizo la solicitud.</span><span style="font-size: large;">
        </span></p>

        <p><span style="font-size: large;">Si no hay ningún token, o el objeto decodificado del token no contiene la identidad del usuario (</span><code><span style="font-size: large;">decodedToken.id</span></code><span style="font-size: large;"> no está definido), el código de estado de error 401 </span><span><span style="color: rgb(0, 61, 245); font-size: large;">Unauthorized</span></span>
            <span style="font-size: large;">
                </span><span style="font-size: large;"> es devuelto y el motivo del error se explica en el cuerpo de la respuesta:</span>
        </p>
        <p><br></p>

        <!-- Inicio de caja de código -->
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 5px 5px 0 0; display: flex; justify-content: space-between;">
            <span style="align-self: center; font-size: large;">JavaScript</span>
            <span style="align-self: center; cursor: pointer;" onclick="copyCodeToClipboard('codeContainer4')">
                <span id="copyText4" style="font-size: large;">Copiar código</span>
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16" id="copyIcon4">
                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"></path>
                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"></path>
                </svg>
            </span>
        </div>
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 0;"></div>
        <div style="background-color: #000; color: #fff; padding: 10px; border-radius: 0 0 5px 5px;">
            <pre id="codeContainer4" style="background-color: #000; color: #fff; padding: 10px; font-size: large;">if (!token || !decodedToken.id) {
  return response.status(401).json({ error: 'token missing or invalid' });
}</pre>
        </div>
        <!-- Fin de caja de código -->

        <p><br></p>
        <p>Cuando se resuelve la identidad del autor de la solicitud, la ejecución continúa como antes.</p>

        <p><span style="font-size: large;">Vamos a probar crear una publicación usando Postman. Elegimos el método </span><span style="color: rgb(0, 61, 245); font-size: large;">POST</span><span style="font-size: large;"> y la url </span>
            <a href="http://localhost:8000/api/posts"><span style="font-size: large;">http://localhost:8000/api/posts</span></a><span style="font-size: large;">.</span></p>

        <p><span style="font-size: large;">Debemos ir a la pestaña </span><span style="color: rgb(0, 61, 245); font-size: large;">Headers</span><span style="font-size: large;"> y utilizar el encabezado</span><span><span style="font-weight: bold; color: rgb(0, 61, 245); font-size: large;"> </span>
            <span style="color: rgb(0, 61, 245); font-size: large;">Authorization</span></span><span style="font-size: large;">
            </span><span style="font-size: large;">
            con el valor “</span><code><span style="font-size: large;">Bearer {{token}}</span></code><span style="font-size: large;">”, donde el segundo valor es el token devuelto por la operación iniciar sesión.</span></p>

        <p style="text-align: left;">
            <img src="https://aulasvirtuales.bue.edu.ar/pluginfile.php/2801042/mod_book/chapter/209493/seis.png" alt="" width="957" height="350" role="presentation" class="img-responsive atto_image_button_text-bottom"><span style="text-align: left;"><span style="font-size: large;">Agregamos en&nbsp;</span>
            <span class="font-size: large;">Body</span><span class="font-size: large;">&nbsp;el&nbsp;</span><span class="font-size: large;">JSON&nbsp;</span><span class="font-size: large;">con
            los datos de la publicación a crear </span><code><span style="font-size: large;">(title, content y category)</span></code><span class="font-size: large;">.&nbsp;</span></span><span style="text-align: left; font-size: large;" class="">Ya no es necesario&nbsp;</span><span style="text-align: left; font-size: large;" class="">enviar el&nbsp;</span><span style="text-align: left; font-size: large;" class="">userId</span><span style="font-size: large;">
            </span><span style="text-align: left; font-size: large;" class="">&nbsp;correspondiente al autor de la publicación, ya que se obtiene automáticamente desde el token</span><b style="text-align: left;"><span class="font-size: large;">.</span></b></p>
        <div style="margin-left: 3%; margin-right: 3%;">
            <p style="text-align: center;">
                <img src="https://aulasvirtuales.bue.edu.ar/pluginfile.php/2801042/mod_book/chapter/209493/siete.png" alt="" width="829" height="616" role="presentation" class="img-responsive atto_image_button_text-bottom">
            </p>
            <br>
        </div>
    </div>
</div>

<script>
    function copyCodeToClipboard(containerId) {
        const container = document.getElementById(containerId);
        const range = document.createRange();
        range.selectNode(container);
        window.getSelection().removeAllRanges();
        window.getSelection().addRange(range);
        document.execCommand('copy');
        window.getSelection().removeAllRanges();

        const copyText = document.getElementById(`copyText${containerId.slice(-1)}`);
        copyText.innerText = 'Copiado!';
        setTimeout(() => copyText.innerText = 'Copiar código', 1500);
    }
</script></div>
            </div>
            <div class="pb-5">
            <div class="book_chapter pt-3" id="ch209494"><article class="flex_titulo_botonera" style="background-color: #E6E1E5;">
    <p class="titulo_principal"><span class="" style="font-size: xx-large;">Manejo de errores</span></p>
</article>
<div style="background-color: #FAFAFA; font-size: large; color: #010614;">
    <br>
    <div style="margin-left: 3%; margin-right: 3%;">

        <p><span class="" style="font-size: large;">La verificación del token también puede causar un </span><code><span class="" style="font-size: large;">JsonWebTokenError</span></code><span class="" style="font-size: large;">. Si, por ejemplo, eliminamos algunos caracteres del token e intentamos crear una nueva nota, esto sucede:</span></p>

        <!-- Inicio de caja de código -->
        <div style="background-color: #444; color: #fff; padding: 5px; border-radius: 5px 5px 0 0; display: flex; justify-content: space-between;">
            <span style="font-size: large;">Error</span>
            <span style="cursor: pointer;" onclick="copyCodeToClipboard('codeContainer1')">
                <span id="copyText1" style="font-size: large;">Copiar código</span>
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16" id="copyIcon1">
                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"></path>
                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"></path>
                </svg>
            </span>
        </div>
        <div style="background-color: #000; color: #fff; padding: 10px; border-radius: 0 0 5px 5px;">
            <pre id="codeContainer1" style="background-color: #000; color: #fff; padding: 10px; font-size: large;">JsonWebTokenError: invalid signature at Object.module.exports [as verify]</pre>
        </div>
        <!-- Fin de caja de código -->

        <p><span class="" style="font-size: large;"></span></p>
        <p><span class="" style="font-size: large;">Hay muchas razones posibles para un error de decodificación. El token puede ser defectuoso (como en nuestro ejemplo), falsificado o vencido.</span></p>
        <p><span class="" style="font-size: large;">Vamos a crear un middleware </span><code><span class="" style="font-size: large;">errorHandler</span></code><span class="" style="font-size: large;"> para tener en cuenta los diferentes errores de decodificación.</span></p>
        <p><span class="" style="font-size: large;">En </span><code><span class="" style="font-size: large;">middlewares/middleware.js</span></code><span class="" style="font-size: large;">:</span></p>
        <p><span class="" style="font-size: large;"></span></p>

        <!-- Inicio de caja de código -->
        <div style="background-color: #444; color: #fff; padding: 5px; border-radius: 5px 5px 0 0; display: flex; justify-content: space-between;">
            <span style="font-size: large;">JavaScript</span>
            <span style="cursor: pointer;" onclick="copyCodeToClipboard('codeContainer2')">
                <span id="copyText2" style="font-size: large;">Copiar código</span>
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16" id="copyIcon2">
                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"></path>
                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"></path>
                </svg>
            </span>
        </div>
        <div style="background-color: #444; color: #fff; padding: 5px; border-radius: 0;"></div>
        <div style="background-color: #000; color: #fff; padding: 10px; border-radius: 0 0 5px 5px;">
            <pre id="codeContainer2" style="background-color: #000; color: #fff; padding: 10px; font-size: large;">const errorHandler = (error, request, response, next) =&gt; {
  console.log(error.message);
  if (error.name === 'CastError') {
    return response.status(400).send({ error: 'malformatted id' });
  } else if (error.name === 'ValidationError') {
    return response.status(400).json({ error: error.message });
  } else if (error.name === 'JsonWebTokenError') {
    return response.status(401).json({
      error: 'invalid token'
    });
  }
  next(error);
};

module.exports = {
  errorHandler
};</pre>
        </div>
        <!-- Fin de caja de código -->

        <p><span class="" style="font-size: large;"></span></p>
        <p><span class="" style="font-size: large;">Y lo importamos en </span><code><span class="" style="font-size: large;">app.js</span></code><span class="" style="font-size: large;">:</span></p>

        <!-- Inicio de caja de código -->
        <div style="background-color: #444; color: #fff; padding: 5px; border-radius: 5px 5px 0 0; display: flex; justify-content: space-between;">
            <span style="font-size: large;">JavaScript</span>
            <span style="cursor: pointer;" onclick="copyCodeToClipboard('codeContainer3')">
                <span id="copyText3" style="font-size: large;">Copiar código</span>
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16" id="copyIcon3">
                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"></path>
                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"></path>
                </svg>
            </span>
        </div>
        <div style="background-color: #444; color: #fff; padding:5px; border-radius: 0;"></div>
        <div style="background-color: #000; color: #fff; padding: 10px; border-radius: 0 0 5px 5px;">
            <pre id="codeContainer3" style="background-color: #000; color: #fff; padding: 10px; font-size: large;">const middleware = require('./middlewares/middleware');
//...
app.use(middleware.errorHandler);</pre>
        </div>
        <!-- Fin de caja de código -->

        <br>
        <p></p>

        <!-- nada puede haber abajo -->

    </div>
</div>

<script>
    function copyCodeToClipboard(containerId) {
        const container = document.getElementById(containerId);
        const range = document.createRange();
        range.selectNodeContents(container);
        window.getSelection().removeAllRanges();
        window.getSelection().addRange(range);
        document.execCommand('copy');
        window.getSelection().removeAllRanges();

        const copyText = document.getElementById(`copyText${containerId.slice(-1)}`);
        copyText.innerText = 'Copiado!';
        setTimeout(() => copyText.innerText = 'Copiar código', 1500);
    }
</script></div>
            </div>
            <div class="pb-5">
            <div class="book_chapter pt-3" id="ch209495"><article class="flex_titulo_botonera" style="background-color: #E6E1E5;">
    <p class="titulo_principal">Caché, cookies y sesiones</p>
</article>
<div style="background-color: #FAFAFA; font-size: large; color: #010614 ;">
    <br>
    <div style="margin-left: 3%; margin-right: 3%;">
        <div style="background-color:#87CEEB; display: inline-flex; height: 6px;">
            <p style="font-size: x-large; color: #010614; margin-top: -22px; padding-right: 4px;">Tipos de caché</p>
            <p style="font-size: x-large; color: #010614; margin-top: -22px; padding-right: 4px;"><br></p>
            <p style="font-size: x-large; color: #010614; margin-top: -22px; padding-right: 4px;"><br></p>
        </div>
        <p dir="ltr" style=""></p>
        <p dir="ltr" style="">En general podemos identificar dos tipos de caché, los locales y los compartidos.</p>

        <p dir="ltr" style="text-align: center; font-weight: bold;">
            <img src="https://aulasvirtuales.bue.edu.ar/pluginfile.php/2801042/mod_book/chapter/209495/ocho.png" alt=" " width="1129" height="501" class="img-responsive atto_image_button_text-bottom">
        </p>

        <p dir="ltr" style="">Prácticamente todos los usuarios tienen un caché local que viene incluido por defecto con su navegador, este puede servir para que las páginas que visitamos carguen más rápido o bien para que podamos ver un sitio incluso cuando no tengamos internet.
            Este caché local sólo sirve para un usuario, aquél que accede al sitio web en su computadora.</p>

        <p dir="ltr" style="">Por otro lado, un caché compartido puede estar compartido entre múltiples usuarios, existen servicios que ofrecen la posibilidad de funcionar como intermediarios entre los usuarios y el servidor, un buen ejemplo de ello es <span class="" style="color: rgb(0, 61, 245);">Cloudflare</span>.</p>

        <div style="display: inline-block; border-radius: 8px; overflow: hidden; border: 1px solid #9A3282;">
            <p style="background-color: #9A3282; color: white; padding: 4px 16px; margin: 0;">
                <span style="font-size: large;"><b>Beneficios de los cachés compartidos</b></span>
            </p>
            <div style="background-color: white; padding: 16px;">
                <p><span style="font-size: large; color: #010614;">Los cachés compartidos son bastante interesantes porque pueden ofrecer beneficios de performance y velocidad incluso a usuarios que visitan por primera vez nuestro sitio web. Algunos de estos servicios replican las copias que se han generado en múltiples ubicaciones del mundo, acercándolas más a los usuarios que eventualmente requerirán estas copias.</span></p>
            </div>
        </div>
        <br>
    </div>
</div></div>
            </div>
            <div class="pb-5">
            <div class="book_chapter pt-3" id="ch209496"><article class="flex_titulo_botonera" style="background-color: #E6E1E5;">
    <p class="titulo_principal">Qué son las cookies y las sesiones</p>
</article>
<div style="background-color: #FAFAFA; font-size: large; color: #010614 ;">
    <br>
    <div style="margin-left: 3%; margin-right: 3%;">
        <p style=""><span style="font-size: large; color: rgb(1, 6, 20);">Las <span class="" style="color: rgb(0, 61, 245);">sesiones y cookies </span>son utilizadas en todo proyecto web para manejar las identidades de los usuarios entre cada request o petición que se realiza entre el cliente (<span class="" style="color: rgb(0, 61, 245);">browser</span>) y el servidor.</span></p>
        
        <p style=""><span style="font-size: large; color: rgb(1, 6, 20);">Como vimos en la primera clase, una de las características del protocolo http es que es stateless, es decir, no conserva un estado para ninguna petición que recibe. Esto significa que el servidor no tiene memoria, no recuerda nada entre peticiones, por lo que no sabe si una petición ya vino, qué usuario es, cuáles son sus datos, etc. Sin embargo, las cookies y las sesiones permiten a los sitios web mantener el estado de una sesión de usuario a través de varias solicitudes <span class="" style="color: rgb(0, 61, 245);">HTTP</span>.</span></p>
        
        <p style=""><span style="font-size: large; color: rgb(1, 6, 20);">Las cookies y sesiones son mecanismos a través de los cuales podemos identificar una petición y almacenar información de nuestros usuarios, como sus preferencias, si inició sesión o no, etc.</span></p>
        
        <p style=""><img src="https://aulasvirtuales.bue.edu.ar/pluginfile.php/2801042/mod_book/chapter/209496/nueve.png" alt="" width="1129" height="295" role="presentation" class="img-responsive atto_image_button_text-bottom"><br></p>

        <p style=""><span style="color: rgb(1, 6, 20); font-size: large;">Las cookies son pequeñas piezas de datos que se almacenan en el navegador del usuario y se envían junto con cada solicitud al servidor. limitadas por</span></p>
        
        <p style=""><span style="color: rgb(1, 6, 20); font-size: large;">los browsers a 4kb. Esto permite al servidor reconocer al usuario y mantener información del estado de la sesión, como, por ejemplo, el carrito de compras en una tienda en línea. Las cookies son datos que se almacenan en el navegador, y son enviados al servidor en cada petición que hacemos del cliente al servidor mismo.</span></p><p style=""><span style="color: rgb(1, 6, 20); font-size: large;"><br></span></p>

        <div style="display: inline-block; border-radius: 8px; overflow: hidden; border: 1px solid #9A3282;">
            <p style="background-color: #9A3282; color: white; padding: 4px 16px; margin: 0;">
                <span style="font-size: large;"><b>Limitaciones de las cookies</b></span>
            </p>
            <div style="background-color: white; padding: 16px;">
                <p><span style="font-size: large; color: #010614;">Las cookies tienen varias limitaciones, por un lado la cantidad de información que podemos almacenar en cookies está limitada por el navegador, por otro lado, el usuario es libre de alterar las cookies como él prefiera, alterando así el funcionamiento de una aplicación. Además si algo funciona mal en relación a las cookies, no está bajo el control del desarrollador, ya que los datos están en la computadora del usuario.</span></p>
            </div>
        </div>
        
        <p style=""><span style="color: rgb(1, 6, 20); font-size: large;"><br></span></p><p style=""><span style="color: rgb(1, 6, 20); font-size: large;">Las sesiones por otro lado, también permiten almacenar información del estado de una sesión de usuario, pero en lugar de almacenarse en el navegador, la información se almacena en el servidor. Cuando un usuario inicia una sesión en un sitio web, se le asigna un<span class="" style="color: rgb(0, 61, 245);"> ID </span>de sesión único, que se envía al navegador del usuario en forma de cookie. Cada vez que el usuario hace una solicitud al servidor, este ID se envía junto con la solicitud, permitiendo al servidor recuperar el estado de la sesión correspondiente.</span></p><p style=""><span style="color: rgb(1, 6, 20); font-size: large;"><br></span></p>
        
        <div style="background-color: #FFFEEB; border-top: 2px solid #460E95; width: 96%; margin: 0 auto;">
            <div style="margin:16px">
                <p style="color: #5811BB; font-size: large; font-weight: 600">Ventajas de las sesiones</p>
                <p style="color: #010614 ; font-size: large; padding-bottom: 16px; margin-top: -12px">Es que se almacenan en el servidor, por lo que podemos guardar mucha más información que en las cookies, además, podemos usar uno de múltiples almacenes para sesiones, desde guardarlas en archivos, usar la memoria <span class="" style="color: rgb(0, 61, 245);">RAM</span>, hasta guardar las sesiones en una base de datos especial para este tipo de información. Otra ventaja es que las sesiones no pueden modificarse desde el cliente, ya que aunque el identificador de una sesión es guardado en una cookie, modificarlo significa que la información del usuario y el usuario ya no están conectados, y esto por sí mismo no presenta un riesgo de seguridad. Por otro lado, almacenar información sensible como el ID del usuario en una cookie puede prestarse a que se modifique y entonces sí exponga a nuestro servidor a una brecha de seguridad. Además, es común que las aplicaciones web encripten las cookies para que estas no puedan ser leídas o modificadas en texto plano, para eso también hay distintas implementaciones con algoritmos de encriptación.</p>
            </div>
        </div>
        
        <p style="color: rgb(1, 6, 20); font-size: large;">En general, se recomienda no almacenar información sensible o de importancia para nuestras aplicación en cookies, y usar en su lugar sesiones para este tipo de información.<br></p>
        <!-- nada puede haber abajo -->
        <br>
    </div>
</div></div>
            </div>
            <div class="pb-5">
            <div class="book_chapter pt-3" id="ch209497"><article class="flex_titulo_botonera" style="background-color: #E6E1E5;">
    <p class="titulo_principal">Passport</p>
</article>
<div style="background-color: #FAFAFA; font-size: large; color: #010614;">
    <br>
    <div style="margin-left: 3%; margin-right: 3%;">

        <p><span style="font-size: large;">Passport es un middleware para <span class="" style="color: rgb(0, 61, 245);">Node.js </span>que se utiliza para la autenticación de usuarios. Proporciona una variedad de estrategias de autenticación, como iniciar
            sesión con nombre de usuario y contraseña, iniciar sesión con <span class="" style="color: rgb(0, 61, 245);">OAuth</span> (como Facebook o Twitter), y autenticación de <span class="" style="color: rgb(0, 61, 245);">token JW</span>T. Passport
            se integra fácilmente con Express para permitir a los desarrolladores agregar fácilmente la autenticación a sus aplicaciones.</span>
        </p>

        <p><span style="font-size: large;">Passport nos provee de más de 140 mecanismos de autenticación para escoger. Todas estas estrategias son independientes entre sí y están empaquetadas como módulos node separados, los cuales no están incluidos por defecto cuando instalamos el middleware Passport:</span></p>

        <!-- Inicio de caja de código para la instalación de passport -->
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 5px 5px 0 0;">
            <span style="float: left;">Shell</span>
            <span style="float: right; cursor: pointer;" onclick="copyCodeToClipboard('codeContainer1')">
                <span id="copyText1">Copiar código</span>
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16" id="copyIcon1">
                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"></path>
                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"></path>
                </svg>
            </span>
        </div>
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 0;"></div>
        <div style="background-color: #000; color: #fff; padding: 10px; border-radius: 0 0 5px 5px;">
            <pre id="codeContainer1" style="background-color: #000; color: #fff; padding: 10px; font-size: large;">npm install passport</pre>
        </div>
        <!-- Fin de caja de código -->

        <p><span style="font-size: large;"></span></p>
        <p><span style="font-size: large;">En el próximo ejemplo, utilizaremos la estrategia de autenticación local de Passport y autenticaremos a los usuarios en una instancia de MongoDB configurada localmente, almacenando los detalles de usuario en la base de datos. Para usar la Estrategia de autenticación local, necesitamos instalar el módulo passport-local:</span></p>

        <!-- Inicio de caja de código para la instalación de passport-local -->
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 5px 5px 0 0;">
            <span style="float: left;">Shell</span>
            <span style="float: right; cursor: pointer;" onclick="copyCodeToClipboard('codeContainer2')">
                <span id="copyText2">Copiar código</span>
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16" id="copyIcon2">
                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"></path>
                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"></path>
                </svg>
            </span>
        </div>
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 0;"></div>
        <div style="background-color: #000; color: #fff; padding: 10px; border-radius: 0 0 5px 5px;">
            <pre id="codeContainer2" style="background-color: #000; color: #fff; padding: 10px; font-size: large;">npm install passport-local</pre>
        </div>
        <!-- Fin de caja de código -->

        <p></p>
    </div>
</div>

<!-- Script para copiar código -->
<script>
    function copyCodeToClipboard(containerId) {
        var codeToCopy = document.getElementById(containerId).innerText;
        navigator.clipboard.writeText(codeToCopy).then(function() {
            var copyIcon = document.getElementById('copyIcon' + containerId.replace('codeContainer', ''));
            var copyText = document.getElementById('copyText' + containerId.replace('codeContainer', ''));
            copyIcon.innerHTML = `
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M10.854 7.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7.5 9.793l2.646-2.647a.5.5 0 0 1 .708 0"/>
                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"/>
                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"/>
                </svg>
            `;
            copyText.innerText = 'Copiado';
        });
    }
</script></div>
            </div>
            <div class="pb-5">
            <div class="book_chapter pt-3" id="ch209498"><article class="flex_titulo_botonera" style="background-color: #E6E1E5;">
    <p class="titulo_principal">Autenticar Aplicaciones Node.js con Passport</p>
</article>
<div style="background-color: #FAFAFA; font-size: large; color: #010614;">
    <br>
    <div style="margin-left: 3%; margin-right: 3%;">

        <p>Vamos a crear una aplicación sencilla para probar Passport. Vamos a utilizar <span class="" style="color: rgb(0, 61, 245);">Express-Generator</span>, visto en clases anteriores, para generar una aplicación estándar simplemente ejecutando el comando
            en el terminal:</p>

        <!-- Inicio de caja de código -->
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 5px 5px 0 0;">
            <span style="float: left;">Shell</span>
            <span style="float: right; cursor: pointer;" onclick="copyCodeToClipboard('codeContainer1')">
                <span id="copyText1">Copiar código</span>
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16" id="copyIcon1">
                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"></path>
                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"></path>
                </svg>
            </span>
        </div>
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 0;"></div>
        <div style="background-color: #000; color: #fff; padding: 10px; border-radius: 0 0 5px 5px;">
            <pre id="codeContainer1" style="background-color: #000; color: #fff; padding: 10px; font-size: large;">express passport-example</pre>
        </div>
        <!-- Fin de caja de código -->

        <p><br></p>
        <p>La estructura de aplicación generada debería tener este aspecto:</p>

        <p style="text-align: center;">
            <img src="https://aulasvirtuales.bue.edu.ar/pluginfile.php/2801042/mod_book/chapter/209498/10.png" alt="" width="284" height="408" role="presentation" class="img-responsive atto_image_button_text-bottom">
        </p>

        <p><span class="" style="font-size: large;">Agregamos las dependencias para el módulo    </span><code><span class="" style="font-size: large;">passport   </span></code><span class="" style="font-size: large;"> y  </span><code><span class="" style="font-size: large;">passport-local </span></code>
            <span class="" style="font-size: large;">
                </span><span class="" style="font-size: large;">:</span>
        </p>

        <!-- Inicio de caja de código -->
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 5px 5px 0 0;">
            <span style="float: left;">Shell</span>
            <span style="float: right; cursor: pointer;" onclick="copyCodeToClipboard('codeContainer2')">
                <span id="copyText2">Copiar código</span>
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16" id="copyIcon2">
                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"></path>
                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"></path>
                </svg>
            </span>
        </div>
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 0;"></div>
        <div style="background-color: #000; color: #fff; padding: 10px; border-radius: 0 0 5px 5px;">
            <pre id="codeContainer2" style="background-color: #000; color: #fff; padding: 10px; font-size: large;">npm install passport passport-local</pre>
        </div>
        <!-- Fin de caja de código -->

        <p><br></p>
        <p><span class="" style="font-size: large;">Para MongoDB, vamos a instalar  </span><code><span class="" style="font-size: large;">Mongoose </span></code><span class="" style="font-size: large;">:</span></p>

        <!-- Inicio de caja de código -->
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 5px 5px 0 0;">
            <span style="float: left;">Shell</span>
            <span style="float: right; cursor: pointer;" onclick="copyCodeToClipboard('codeContainer3')">
                <span id="copyText3">Copiar código</span>
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16" id="copyIcon3">
                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"></path>
                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"></path>
                </svg>
            </span>
        </div>
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 0;"></div>
        <div style="background-color: #000; color: #fff; padding: 10px; border-radius: 0 0 5px 5px;">
            <pre id="codeContainer3" style="background-color: #000; color: #fff; padding: 10px; font-size: large;">npm install mongoose</pre>
        </div>
        <!-- Fin de caja de código -->

        <p></p>
        <p><span class="" style="font-size: large;"><span class="" style="font-size: large;">Además, podemos agregar  </span><code><span class="" style="font-size: large;">Nodemon </span></code><span class="" style="font-size: large;"> para no tener que reiniciar el servidor por cada cambio.</span></span>
        </p>

        <p><span class="" style="font-size: large;">Archivo </span><code><span class="" style="font-size: large; color: rgb(0, 61, 245);">app.js</span></code><span class="" style="font-size: large; color: rgb(0, 61, 245);">:</span></p>

        <!-- Inicio de caja de código -->
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 5px 5px 0 0;">
            <span style="float: left;">JavaScript</span>
            <span style="float: right; cursor: pointer;" onclick="copyCodeToClipboard('codeContainer4')">
                <span id="copyText4">Copiar código</span>
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16" id="copyIcon4">
                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"></path>
                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"></path>
                </svg>
            </span>
        </div>
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 0;"></div>
        <div style="background-color: #000; color: #fff; padding: 10px; border-radius: 0 0 5px 5px;">
            <pre id="codeContainer4" style="background-color: #000; color: #fff; padding: 10px; font-size: large;">var express = require('express');
var path = require('path');
var logger = require('morgan');
var cookieParser = require('cookie-parser');
var bodyParser = require('body-parser');
var app = express();
// view engine setup
app.set('views', path.join(__dirname, 'views'));
app.set('view engine', 'jade');
app.use(logger('dev'));
app.use(bodyParser.json());
app.use(bodyParser.urlencoded());
app.use(cookieParser());
app.use(express.static(path.join(__dirname, 'public')));
// Configuring Passport
var passport = require('passport');
app.use(passport.initialize());
app.use(passport.session());
// Initialize Passport
var initPassport = require('./passport/init');
initPassport(passport);
var routes = require('./routes/index')(passport);
app.use('/', routes);
/// catch 404 and forward to error handler
app.use(function (req, res, next) {
  var err = new Error('Not Found');
  err.status = 404;
  next(err);
});
// development error handler
// will print stacktrace
if (app.get('env') === 'development') {
  app.use(function (err, req, res, next) {
    res.status(err.status || 500);
    res.render('error', {
      message: err.message,
      error: err
    });
  });
}
module.exports = app;</pre>
        </div>
        <!-- Fin de caja de código -->

        <p><br></p>
        <p><span class="" style="font-size: large;">Se inicializa Passport y se configura el middleware </span><code><span class="" style="font-size: large;">passport.session()</span></code><span class="" style="font-size: large;"> para utilizar la sesión en el almacenamiento del usuario autenticado.</span></p>

    </div>
</div>

<script>
    function copyCodeToClipboard(containerId) {
        const codeContainer = document.getElementById(containerId);
        const copyText = document.getElementById('copyText' + containerId.slice(-1));
        navigator.clipboard.writeText(codeContainer.innerText).then(() => {
            copyText.innerText = 'Copiado';
            setTimeout(() => {
                copyText.innerText = 'Copiar código';
            }, 2000);
        });
    }
</script></div>
            </div>
            <div class="pb-5">
            <div class="book_chapter pt-3" id="ch209499"><article class="flex_titulo_botonera" style="background-color: #E6E1E5;">
    <p class="titulo_principal">Creación del modelo de Mongoose</p>
</article>
<div style="background-color: #FAFAFA; font-size: large; color: #010614;">
    <br>
    <div style="margin-left: 3%; margin-right: 3%;">

        <p><span class="" style="font-size: large;">Vamos a crear un modelo de usuario en Mongoose y guardarlo en </span><code><span class="" style="font-size: large;">models/user.js</span></code><span class="" style="font-size: large;">:</span></p>

        <!-- Inicio de caja de código -->
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 5px 5px 0 0;">
            <span style="float: left;">JavaScript</span>
            <span style="float: right; cursor: pointer;" onclick="copyCodeToClipboard('codeContainer1')">
                <span id="copyText1">Copiar código</span>
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16" id="copyIcon1">
                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"></path>
                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"></path>
                </svg>
            </span>
        </div>
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 0;"></div>
        <div style="background-color: #000; color: #fff; padding: 10px; border-radius: 0 0 5px 5px;">
            <pre id="codeContainer1" style="background-color: #000; color: #fff; padding: 10px; font-size: large;">var mongoose = require('mongoose');
module.exports = mongoose.model('User', {
  username: String,
  password: String,
  email: String,
  name: String
});</pre>
        </div>
        <!-- Fin de caja de código -->

    </div>
</div>

<script>
    function copyCodeToClipboard(containerId) {
        const codeContainer = document.getElementById(containerId);
        const copyText = document.getElementById('copyText' + containerId.slice(-1));
        navigator.clipboard.writeText(codeContainer.innerText).then(() => {
            copyText.innerText = 'Copiado';
            setTimeout(() => {
                copyText.innerText = 'Copiar código';
            }, 2000);
        });
    }
</script></div>
            </div>
            <div class="pb-5">
            <div class="book_chapter pt-3" id="ch209500"><!-- Título principal -->
<article class="flex_titulo_botonera" style="background-color: #E6E1E5;">
    <p class="titulo_principal">Configuración</p>
</article>
<div style="background-color: #FAFAFA; font-size: large; color: #010614;">
    <br>
    <div style="margin-left: 3%; margin-right: 3%;">

        <!-- Subtítulo: Configuración de Mongo -->
        <div style="background-color:#87CEEB; display: inline-flex; height: 6px;">
            <p style="font-size: x-large; color: #010614; margin-top: -22px; padding-right: 4px">Configuración de Mongo</p>
        </div>
        <p></p>
        <p><span class="" style="font-size: large;">En el archivo </span><code><span class="" style="font-size: large;">app.js:</span></code></p>

        <!-- Inicio de caja de código -->
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 5px 5px 0 0; display: flex; justify-content: space-between;">
            <span style="align-self: center;">JavaScript</span>
            <span style="align-self: center; cursor: pointer;" onclick="copyCode('codeContainerMongo')">
                <span id="copyTextMongo" style="font-size: large;">Copiar código</span>
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16" id="copyIconMongo">
                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"></path>
                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"></path>
                </svg>
            </span>
        </div>
        <div style="background-color: #000; color: #fff; padding: 10px; border-radius: 0 0 5px 5px;">
            <pre id="codeContainerMongo" style="background-color: #000; color: #fff; padding: 10px; font-size: large;">var mongoose = require('mongoose');
mongoose.connect('mongodb://localhost/passport-example');</pre>
        </div>
        <!-- Fin de caja de código -->

        <br>
        <!-- Subtítulo: Configuración de Passport -->
        <div style="background-color:#87CEEB; display: inline-flex; height: 6px;">
            <p style="font-size: x-large; color: #010614; margin-top: -22px; padding-right: 4px">Configuración de Passport</p>
        </div>
        <p></p>
        <p><span class="" style="font-size: large;">Passport sólo proporciona el mecanismo para manejar la autenticación, dejando la responsabilidad de implementar la sesión a nosotros mismos. Vamos a utilizar </span><code><span class="" style="font-size: large;">express-session</span></code>.</p>

        <p>Express-session es un <span class="" style="color: rgb(0, 61, 245);">middleware</span> para <span class="" style="color: rgb(0, 61, 245);">Express.js</span> que permite almacenar y acceder a la información de la sesión en una aplicación web.</p>

        <p>La sesión se inicia cuando un usuario se autentica en la aplicación y se guarda en el servidor. Algunas funcionalidades son:</p>

        <!-- Inicio de viñetas -->
        <div class="row" style="margin-left: 32px">
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-1-circle-fill" viewBox="0 0 16 16" style="color: #3c80b3;">
                    <path d="M5 3.5h6A1.5 1.5 0 0 1 12.5 5v6a1.5 1.5 0 0 1-1.5 1.5H5A1.5 1.5 0 0 1 3.5 11V5A1.5 1.5 0 0 1 5 3.5"></path>
                </svg>
            </div>
            <div class="col">
                <p><span style="font-weight: 600; font-size: large;">Guardar y recuperar información:</span> Puedes almacenar los datos de sesión.</p>
            </div>
        </div>

        <div class="row" style="margin-left: 32px">
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-2-circle-fill" viewBox="0 0 16 16" style="color: #3c80b3;">
                    <path d="M5 3.5h6A1.5 1.5 0 0 1 12.5 5v6a1.5 1.5 0 0 1-1.5 1.5H5A1.5 1.5 0 0 1 3.5 11V5A1.5 1.5 0 0 1 5 3.5"></path>
                </svg>
            </div>
            <div class="col">
                <p><span style="font-weight: 600; font-size: large;">Expiración de sesión:</span> Puedes configurar tiempos de expiración.</p>
            </div>
        </div>

        <div class="row" style="margin-left: 32px">
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-3-circle-fill" viewBox="0 0 16 16" style="color: #3c80b3;">
                    <path d="M5 3.5h6A1.5 1.5 0 0 1 12.5 5v6a1.5 1.5 0 0 1-1.5 1.5H5A1.5 1.5 0 0 1 3.5 11V5A1.5 1.5 0 0 1 5 3.5"></path>
                </svg>
            </div>
            <div class="col">
                <p><span style="font-weight: 600; font-size: large;">Renovación de sesiones:</span> Renovar sesiones activamente.</p>
            </div>
        </div>

        <div class="row" style="margin-left: 32px">
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-4-circle-fill" viewBox="0 0 16 16" style="color: #3c80b3;">
                    <path d="M5 3.5h6A1.5 1.5 0 0 1 12.5 5v6a1.5 1.5 0 0 1-1.5 1.5H5A1.5 1.5 0 0 1 3.5 11V5A1.5 1.5 0 0 1 5 3.5"></path>
                </svg>
            </div>
            <div class="col">
                <p><span style="font-weight: 600; font-size: large;">Destrucción de sesiones:</span> Eliminar sesiones cuando sea necesario.</p>
            </div>
        </div>
        <!-- Fin de viñetas -->
        <br>
        <p><span class="" style="font-size: large;">Para instalar </span><code><span class="" style="font-size: large;">express-session</span></code><span class="" style="font-size: large;">:</span></p>

        <!-- Inicio de caja de código -->
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 5px 5px 0 0; display: flex; justify-content: space-between;">
            <span style="align-self: center;">Shell</span>
            <span style="align-self: center; cursor: pointer;" onclick="copyCode('codeContainerInstall')">
                <span id="copyTextInstall">Copiar código</span>
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16" id="copyIconInstall">
                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"></path>
                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"></path>
                </svg>
            </span>
        </div>
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 0;">
        </div>
        <div style="background-color: #000; color: #fff; padding: 10px; border-radius: 0 0 5px 5px;">
            <pre id="codeContainerInstall" style="background-color: #000; color: #fff; padding: 10px; font-size: large;">npm install --save express-session</pre>
        </div>
        <!-- Fin de caja de código -->

        <p></p>
        <p>Luego, en <span class="" style="color: rgb(0, 61, 245);">app.js:</span></p>

        <!-- Inicio de caja de código -->
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 5px 5px 0 0; display: flex; justify-content: space-between;">
            <span style="align-self: center;">JavaScript</span>
            <span style="align-self: center; cursor: pointer;" onclick="copyCode('codeContainerAppJS')">
                <span id="copyTextAppJS">Copiar código</span>
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16" id="copyIconAppJS">
                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"></path>
                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"></path>
                </svg>
            </span>
        </div>
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 0;">
        </div>
        <div style="background-color: #000; color: #fff; padding: 10px; border-radius: 0 0 5px 5px;">
            <pre id="codeContainerAppJS" style="background-color: #000; color: #fff; padding: 10px; font-size: large;">var passport = require('passport');
var expressSession = require('express-session');
app.use(expressSession({ secret: 'mySecretKey' }));
app.use(passport.initialize());
app.use(passport.session());</pre>
        </div>
        <!-- Fin de caja de código -->

    </div>
</div>

<!-- Script para copiar el código -->
<script>
    function copyCode(containerId) {
        const container = document.getElementById(containerId);
        const range = document.createRange();
        range.selectNode(container);
        window.getSelection().removeAllRanges();
        window.getSelection().addRange(range);
        document.execCommand('copy');
        window.getSelection().removeAllRanges();

        const copyText = document.getElementById('copyText' + containerId.replace('codeContainer', ''));
        copyText.innerText = 'Copiado!';
        setTimeout(() => copyText.innerText = 'Copiar código', 1500);
    }
</script></div>
            </div>
            <div class="pb-5">
            <div class="book_chapter pt-3" id="ch209501"><!-- Título principal -->
<article class="flex_titulo_botonera" style="background-color: #E6E1E5;">
    <p class="titulo_principal">Serializar y deserializar instancias de usuario</p>
</article>
<div style="background-color: #FAFAFA; font-size: large; color: #010614;">
    <br>
    <div style="margin-left: 3%; margin-right: 3%;">

        <p><span class="" style="font-size: large;">Passport también necesita serializar y deserializar la instancia de usuario de un almacén de sesiones para poder dar soporte a las sesiones de inicio de sesión, de modo que cada solicitud subsiguiente no contenga las credenciales del usuario. Proporciona dos métodos </span><code><span class="" style="font-size: large;">serializeUser</span></code><span class="" style="font-size: large;"> y </span><code><span class="" style="font-size: large;">deserializeUser</span></code><span class="" style="font-size: large;"> para este propósito. Crearemos un archivo </span><code><span class="" style="font-size: large;">passport/init.js</span></code><span class="" style="font-size: large;"> para inicializar la configuración de Passport.</span></p>

        <!-- Inicio de caja de código -->
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 5px 5px 0 0;">
            <span style="float: left;">JavaScript</span>
            <span style="float: right; cursor: pointer;" onclick="copyCodeToClipboard('codeContainerPassport')">
                <span id="copyTextPassport">Copiar código</span>
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16" id="copyIconPassport">
                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"></path>
                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"></path>
                </svg>
            </span>
        </div>
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 0;">
        </div>
        <div style="background-color: #000; color: #fff; padding: 10px; border-radius: 0 0 5px 5px;">
            <pre id="codeContainerPassport" style="background-color: #000; color: #fff; padding: 10px; font-size: large;">var login = require('./login');
var signup = require('./signup');
var User = require('../models/user');
module.exports = function (passport) {
    passport.serializeUser(function (user, done) {
        console.log('serializing user: ');
        console.log(user);
        done(null, user._id);
    });

    passport.deserializeUser(function (id, done) {
        User.findById(id, function (err, user) {
            console.log('deserializing user:', user);
            done(err, user);
        });
    });

    login(passport);
    signup(passport);
};
            </pre>
        </div>
        <!-- Fin de caja de código -->

        <p><br></p><p><span class="" style="font-size: large;">El archivo importa dos módulos, </span><code><span class="" style="font-size: large;">login</span></code><span class="" style="font-size: large;"> y </span><code><span class="" style="font-size: large;">signup</span></code><span class="" style="font-size: large;">, que contendrán la configuración de las estrategias de inicio de sesión y registro de usuario de Passport, respectivamente. También importa el modelo de usuario, que se utiliza para deserializar un usuario a partir de su ID de sesión.</span></p>

        <!-- Inicio de viñetas -->
        <!-- 1 -->
        <div class="row" style="margin-left: 32px">
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-1-circle-fill" viewBox="0 0 16 16" style="color: #3c80b3;">
                    <path d="M5 3.5h6A1.5 1.5 0 0 1 12.5 5v6a1.5 1.5 0 0 1-1.5 1.5H5A1.5 1.5 0 0 1 3.5 11V5A1.5 1.5 0 0 1 5 3.5"></path>
                </svg>
            </div>
            <div class="col">
                <p><span style="font-weight: 600; font-size: large;">Función serializeUser:</span> Utilizada por Passport para almacenar la información del usuario en la sesión. En este caso, solo se almacena el ID del usuario en la sesión.</p>
            </div>
        </div>

        <!-- 2 -->
        <div class="row" style="margin-left: 32px">
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-2-circle-fill" viewBox="0 0 16 16" style="color: #3c80b3;">
                    <path d="M5 3.5h6A1.5 1.5 0 0 1 12.5 5v6a1.5 1.5 0 0 1-1.5 1.5H5A1.5 1.5 0 0 1 3.5 11V5A1.5 1.5 0 0 1 5 3.5"></path>
                </svg>
            </div>
            <div class="col">
                <p><span style="font-weight: 600; font-size: large;">Función deserializeUser:</span> Utilizada por Passport para recuperar la información del usuario de la sesión.</p>
            </div>
        </div>

        <p><span class="" style="font-size: large;">La función </span><code><span class="" style="font-size: large;">deserializeUser</span></code><span class="" style="font-size: large;"> utiliza el ID almacenado en la sesión para buscar al usuario correspondiente en la base de datos y deserializarlo.</span></p>

    </div>
</div>

<!-- Script para copiar el código -->
<script>
    function copyCodeToClipboard(containerId) {
        var codeToCopy = document.getElementById(containerId).innerText;
        navigator.clipboard.writeText(codeToCopy).then(function() {
            var copyIcon = document.getElementById('copyIconPassport');
            var copyText = document.getElementById('copyTextPassport');
            copyIcon.innerHTML = `
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check" viewBox="0 0 16 16">
                <path fill-rule="evenodd" d="M10.854 7.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7.5 9.793l2.646-2.647a.5.5 0 0 1 .708 0"/>
                <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"/>
                <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"/>
            </svg>`;
            copyText.textContent = 'Copiado';
            setTimeout(function() {
                copyIcon.innerHTML = `
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16" id="copyIconPassport">
                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"/>
                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"/>
                </svg>`;
                copyText.textContent = 'Copiar código';
            }, 2000);
        }, function(err) {
            console.error('Error al copiar el código: ', err);
        });
    }
</script></div>
            </div>
            <div class="pb-5">
            <div class="book_chapter pt-3" id="ch209502"><!-- Título principal -->
<article class="flex_titulo_botonera" style="background-color: #E6E1E5;">
    <p class="titulo_principal">Uso de estrategias de Passport</p>
</article>
<div style="background-color: #FAFAFA; font-size: large; color: #010614;">
    <br>
    <div style="margin-left: 3%; margin-right: 3%;">

        <!-- Texto de explicación -->
        <p><span class="" style="font-size: large;">Ahora vamos a definir las estrategias de <span class="" style="color: rgb(0, 61, 245);">Passport</span> para manejar el inicio de sesión y la suscripción.</span></p>

        <p><span class="" style="font-size: large;">Vamos a utilizar </span><code><span class="" style="font-size: large;">connect-flash</span></code><span class="" style="font-size: large;"> para el manejo de errores.</span></p>

        <div style="display: inline-block; border-radius: 8px; overflow: hidden; border: 1px solid #9A3282;">
            <p style="background-color: #9A3282; color: white; padding: 4px 16px; margin: 0;">
                <span style="font-size: large;"><b>Connect-Flash</b></span>
            </p>
            <div style="background-color: white; padding: 16px;">
                <p><span style="font-size: large; color: #010614;">Es un Middleware de Express.js que permite a una aplicación enviar mensajes de error o de éxito a través de una sesión.</span></p>
            </div>
        </div>

        <!-- Comando de instalación -->
        <p><span class="">Para instalar </span><code><span class="" style="font-size: large;">connect-flash:</span></code><br></p>

        <!-- Inicio de caja de código -->
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 5px 5px 0 0; display: flex; justify-content: space-between;">
            <span style="align-self: center;">Shell</span>
            <span style="align-self: center; cursor: pointer;" onclick="copyCodeToClipboard('codeContainerPassport')">
                <span id="copyTextPassport">Copiar código</span>
            </span>
        </div>
        <div style="background-color: #000; color: #fff; padding: 10px; border-radius: 0 0 5px 5px;">
            <pre id="codeContainerPassport" style="background-color: #000; color: #fff; padding: 10px; font-size: large;">npm install connect-flash</pre>
        </div>
        <!-- Fin de caja de código -->

    </div>
</div>

<!-- Script para copiar el código -->
<script>
    function copyCodeToClipboard(containerId) {
        const container = document.getElementById(containerId);
        const range = document.createRange();
        range.selectNode(container);
        window.getSelection().removeAllRanges();
        window.getSelection().addRange(range);
        document.execCommand('copy');
        window.getSelection().removeAllRanges();

        const copyText = document.getElementById('copyText' + containerId.replace('codeContainer', ''));
        copyText.innerText = 'Copiado!';
        setTimeout(() => copyText.innerText = 'Copiar código', 1500);
    }
</script></div>
            </div>
            <div class="pb-5">
            <div class="book_chapter pt-3" id="ch209503"><!-- Título principal -->
<article class="flex_titulo_botonera" style="background-color: #E6E1E5;">
    <p class="titulo_principal">Estrategia de acceso</p>
</article>
<div style="background-color: #FAFAFA; font-size: large; color: #010614;">
    <br>
    <div style="margin-left: 3%; margin-right: 3%;">

        <p>En el archivo <span class="" style="color: rgb(0, 61, 245);">passport/login.js,</span> la estrategia de inicio de sesión se ve así:</p>

        <!-- Inicio de caja de código -->
<div style="background-color: #444; color: #fff; padding: 10px; border-radius: 5px 5px 0 0;">
    <span style="float: left;">JavaScript</span>
    <span style="float: right; cursor: pointer;" onclick="copyCodeToClipboard('codeContainerLogin', 'copyTextLogin', 'copyIconLogin')">
        <span id="copyTextLogin">Copiar código</span>
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16" id="copyIconLogin">
            <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"></path>
            <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"></path>
        </svg>
    </span>
</div>
<div style="background-color: #444; color: #fff; padding: 10px; border-radius: 0;">
</div>
<div style="background-color: #000; color: #fff; padding: 10px; border-radius: 0 0 5px 5px;">
    <pre id="codeContainerLogin" style="background-color: #000; color: #fff; padding: 10px; font-size: large;">var LocalStrategy = require('passport-local').Strategy;
var User = require('../models/user');
var bCrypt = require('bcryptjs');
module.exports = function (passport) {
  passport.use(
    'login',
    new LocalStrategy(
      {
        passReqToCallback: true
      },
      function (req, username, password, done) {
        User.findOne({ username: username }, function (err, user) {
          if (err) return done(err);
          if (!user) {
            console.log('User Not Found with username ' + username);
            return done(null, false, req.flash('message', 'User Not found.'));
          }
          if (!isValidPassword(user, password)) {
            console.log('Invalid Password');
            return done(null, false, req.flash('message', 'Invalid Password'));
          }
          return done(null, user);
        });
      }
    )
  );
  var isValidPassword = function (user, password) {
    return bCrypt.compareSync(password, user.password);
  };
};</pre>
</div>

        <!-- Fin de caja de código -->

        <p></p>
        <p><span class="" style="font-size: large;">El primer parámetro de </span><code><span class="" style="font-size: large;">passport.use()</span></code><span class="" style="font-size: large;"> es el nombre de la estrategia...</span></p>

        <p><span class="" style="font-size: large;">Para instalar </span><code><span class="" style="font-size: large;">bcrypt</span></code><span class="" style="font-size: large;">:</span></p>

        <!-- Inicio de caja de código -->
<div style="background-color: #444; color: #fff; padding: 10px; border-radius: 5px 5px 0 0;">
    <span style="float: left;">Shell</span>
    <span style="float: right; cursor: pointer;" onclick="copyCodeToClipboard('codeContainerBcrypt', 'copyTextBcrypt', 'copyIconBcrypt')">
        <span id="copyTextBcrypt">Copiar código</span>
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16" id="copyIconBcrypt">
            <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"></path>
            <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"></path>
        </svg>
    </span>
</div>
<div style="background-color: #444; color: #fff; padding: 10px; border-radius: 0;">
</div>
<div style="background-color: #000; color: #fff; padding: 10px; border-radius: 0 0 5px 5px;">
    <pre id="codeContainerBcrypt" style="background-color: #000; color: #fff; padding: 10px; font-size: large;">npm install bcrypt</pre>
</div>

        <!-- Fin de caja de código -->

    </div>
</div><script>
    function copyCodeToClipboard(containerId, copyTextId, copyIconId) {
        var codeToCopy = document.getElementById(containerId).innerText;
        navigator.clipboard.writeText(codeToCopy).then(function() {
            var copyText = document.getElementById(copyTextId);
            var copyIcon = document.getElementById(copyIconId);
            copyText.textContent = 'Copiado';
            copyIcon.innerHTML = `
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M10.854 7.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7.5 9.793l2.646-2.647a.5.5 0 0 1 .708 0"/>
                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"/>
                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"/>
                </svg>`;
            setTimeout(function() {
                copyText.textContent = 'Copiar código';
                copyIcon.innerHTML = `
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16">
                        <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"/>
                        <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"/>
                    </svg>`;
            }, 2000); // Cambia a 'Copiar código' después de 2 segundos
        }, function(err) {
            console.error('Error al copiar el código: ', err);
        });
    }
</script></div>
            </div>
            <div class="pb-5">
            <div class="book_chapter pt-3" id="ch209504"><!-- Título principal -->
<article class="flex_titulo_botonera" style="background-color: #E6E1E5;">
    <p class="titulo_principal">Estrategia de registro</p>
</article>
<div style="background-color: rgb(250, 250, 250); font-size: large;">
    <br>
    <div style="margin-left: 3%; margin-right: 3%;">

        <p style="color: rgb(1, 6, 20);">Ahora, definimos la siguiente estrategia que manejará el registro de un nuevo usuario.</p>
        <p style="color: rgb(1, 6, 20);"><span class="" style="font-size: large;">Dentro de esta función, se establece una nueva estrategia de inicio de sesión con Passport llamada     </span><code><span class="" style="font-size: large;">signup</span></code><span class="" style="font-size: large;"> utilizando la clase   </span><code><span class="" style="font-size: large;">LocalStrategy  </span></code><span class="" style="font-size: large;"> importada desde   </span><code><span class="" style="font-size: large;">passport-local  </span></code><span class="" style="font-size: large;">. La estrategia</span><code><span class="" style="font-size: large;">signup</span></code><span class="" style="font-size: large;"> recibe una solicitud (</span><code><span class="" style="font-size: large;">req</span></code><span class="" style="font-size: large;">), un nombre de usuario
            (</span><code><span class="" style="font-size: large;">username</span></code><span class="" style="font-size: large;">), una contraseña (</span><code><span class="" style="font-size: large;">password</span></code><span class="" style="font-size: large;">) y una función de llamada (</span><code><span class="" style="font-size: large;">done</span></code><span class="" style="font-size: large;">) como parámetros. Luego, se define una función llamada "</span><code><span class="" style="font-size: large;">findOrCreateUser</span></code><span class="" style="font-size: large;">" que busca un usuario en una base de datos MongoDB con el nombre de usuario proporcionado. Si el
            usuario ya existe, se imprime un mensaje en la consola y se devuelve un error utilizando la función "done". En caso contrario, se crea un nuevo usuario, se establecen sus credenciales locales y se guarda en la base de datos.</span></p>
        <p style="color: rgb(1, 6, 20);">En el archivo<span class="" style="color: rgb(0, 61, 245);"> passport/signup.js</span></p>

        <!-- Inicio de caja de código -->
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 5px 5px 0 0;">
            <span style="float: left;">JavaScript</span>
            <span style="float: right; cursor: pointer;" onclick="copyCodeToClipboard('codeContainerSignup', 'copyTextSignup', 'copyIconSignup')">
                <span id="copyTextSignup">Copiar código</span>
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16" id="copyIconSignup">
                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"></path>
                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"></path>
                </svg>
            </span>
        </div>
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 0;">
        </div>
        <div style="background-color: #000; color: #fff; padding: 10px; border-radius: 0 0 5px 5px;">
            <pre id="codeContainerSignup" style="background-color: #000; color: #fff; padding: 10px; font-size: large;">var LocalStrategy = require('passport-local').Strategy;
var User = require('../models/user');
var bCrypt = require('bcryptjs');
module.exports = function (passport) {
    passport.use('signup', new LocalStrategy({
        passReqToCallback: true
    }, function (req, username, password, done) {
        findOrCreateUser = function () {
            User.findOne({ username: username }, function (err, user) {
                if (err) {
                    console.log('Error in SignUp: ' + err);
                    return done(err);
                }
                if (user) {
                    console.log('User already exists with username: ' + username);
                    return done(null, false, req.flash('message', 'User Already Exists'));
                } else {
                    var newUser = new User();
                    newUser.username = username;
                    newUser.password = createHash(password);
                    newUser.email = req.param('email');
                    newUser.firstName = req.param('firstName');
                    newUser.lastName = req.param('lastName');

                    newUser.save(function (err) {
                        if (err) {
                            console.log('Error in Saving user: ' + err);
                            throw err;
                        }
                        console.log('User Registration successful');
                        return done(null, newUser);
                    });
                }
            });
        };
        process.nextTick(findOrCreateUser);
    }));
    
    var createHash = function (password) {
        return bCrypt.hashSync(password, bCrypt.genSaltSync(10), null);
    };
};</pre>
        </div>
        <!-- Fin de caja de código -->

        <p style="color: rgb(1, 6, 20);"><br></p>
        <p style="color: rgb(1, 6, 20);"><span class="" style="font-size: large;">La función "</span><code><span class="" style="font-size: large;">findOrCreateUser</span></code><span class="" style="font-size: large;">" se ejecuta dentro de un "</span><code><span class="" style="font-size: large;">nextTick</span></code><span class="" style="font-size: large;">" del proceso, lo que significa que se retrasa su ejecución hasta el próximo ciclo del bucle de eventos. También se define una función llamada "</span><code><span class="" style="font-size: large;">createHash</span></code><span class="" style="font-size: large;">" que utiliza </span><code><span class="" style="font-size: large;">bCrypt</span></code><span class="" style="font-size: large;"> para
            generar un hash de la contraseña proporcionada.</span></p>

    </div>
</div>

<!-- Script para copiar el código -->
<script>
    function copyCodeToClipboard(containerId, copyTextId, copyIconId) {
        var codeToCopy = document.getElementById(containerId).innerText;
        navigator.clipboard.writeText(codeToCopy).then(function() {
            var copyText = document.getElementById(copyTextId);
            var copyIcon = document.getElementById(copyIconId);
            copyText.textContent = 'Copiado';
            copyIcon.innerHTML = `
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M10.854 7.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7.5 9.793l2.646-2.647a.5.5 0 0 1 .708 0"/>
                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"/>
                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"/>
                </svg>`;
            setTimeout(function() {
                copyText.textContent = 'Copiar código';
                copyIcon.innerHTML = `
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16">
                        <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"/>
                        <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"/>
                    </svg>`;
            }, 2000);
        });
    }
</script></div>
            </div>
            <div class="pb-5">
            <div class="book_chapter pt-3" id="ch209505"><!-- Título principal -->
<article class="flex_titulo_botonera" style="background-color: #E6E1E5;">
    <p class="titulo_principal">Creación de rutas</p>
</article>
<div style="background-color: #FAFAFA; font-size: large; color: #010614;">
    <br>
    <div style="margin-left: 3%; margin-right: 3%;">

        <p style="text-align: left;">Ahora definimos nuestras rutas para la aplicación;</p>
        <p style="text-align: center;">
            <img src="https://aulasvirtuales.bue.edu.ar/pluginfile.php/2801042/mod_book/chapter/209505/11.png" alt="" width="695" height="580" role="presentation" class="img-responsive atto_image_button_text-bottom">
        </p>

        <p><span style="font-size: large;">En el siguiente módulo que toma la instancia de <span style="color: rgb(0, 61, 245);">Passport</span> creada en </span><code><span style="font-size: large;">app.js</span></code><span style="font-size: large;">. Guardamos este módulo en </span><code><span style="font-size: large;">routes/index.js</span></code><span style="font-size: large;">:</span></p>

        <!-- Inicio de caja de código -->
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 5px 5px 0 0; display: flex; justify-content: space-between;">
            <span style="align-self: center;">JavaScript</span>
            <span style="align-self: center; cursor: pointer;" onclick="copyCodeToClipboard('codeContainerRoutes', 'copyTextRoutes')">
                <span id="copyTextRoutes">Copiar código</span>
            </span>
        </div>
        <div style="background-color: #000; color: #fff; padding: 10px; border-radius: 0 0 5px 5px;">
            <pre id="codeContainerRoutes" style="background-color: #000; color: #fff; padding: 10px; font-size: large;">var express = require('express');
var router = express.Router();
var isAuthenticated = function (req, res, next) {
    if (req.isAuthenticated()) return next();
    res.redirect('/');
};
module.exports = function (passport) {
    /* GET login page. */
    router.get('/', function (req, res) {
        res.render('index', { message: req.flash('message') });
    });

    /* Handle Login POST */
    router.post('/login', passport.authenticate('login', {
        successRedirect: '/home',
        failureRedirect: '/',
        failureFlash: true
    }));

    /* GET Registration Page */
    router.get('/signup', function (req, res) {
        res.render('register', { message: req.flash('message') });
    });

    /* Handle Registration POST */
    router.post('/signup', passport.authenticate('signup', {
        successRedirect: '/home',
        failureRedirect: '/signup',
        failureFlash: true
    }));

    /* GET Home Page */
    router.get('/home', isAuthenticated, function (req, res) {
        res.render('home', { user: req.user });
    });

    /* Handle Logout */
    router.get('/signout', function (req, res, next) {
        req.logout(function (err) {
            if (err) {
                return next(err);
            }
            res.redirect('/');
        });
    });

    return router;
};</pre>
        </div>
        <!-- Fin de caja de código -->

        <p><span style="font-size: large;"></span></p>
        <p><span style="font-size: large;">La parte más importante del fragmento de código anterior es el uso de </span><code><span style="font-size: large;">passport.authenticate()</span></code><span style="font-size: large;"> para delegar la autenticación.</span></p>

    </div>
</div>

<!-- Script para copiar el código -->
<script>
    function copyCodeToClipboard(containerId, copyTextId) {
        const container = document.getElementById(containerId);
        const range = document.createRange();
        range.selectNode(container);
        window.getSelection().removeAllRanges();
        window.getSelection().addRange(range);
        document.execCommand('copy');
        window.getSelection().removeAllRanges();

        const copyText = document.getElementById(copyTextId);
        copyText.textContent = 'Copiado!';
        setTimeout(() => copyText.textContent = 'Copiar código', 1500);
    }
</script></div>
            </div>
            <div class="pb-5">
            <div class="book_chapter pt-3" id="ch209506"><!-- Título principal -->
<article class="flex_titulo_botonera" style="background-color: #E6E1E5;">
    <p class="titulo_principal">Creación de vistas de Jade</p>
</article>

<div style="background-color: #FAFAFA; font-size: large; color: #010614;">
    <br>
    <div style="margin-left: 3%; margin-right: 3%;">
        <p style="color: #010614;">
            <span class="" style="font-size: large;"><span class="" style="color: rgb(0, 61, 245);">Jade</span> es un lenguaje de plantillas para generar código HTML.</span>
        </p>
        <p><span class="" style="font-size: large;">A continuación, creamos las dos vistas siguientes para nuestra aplicación:</span></p>

        <!-- Sección de lista numerada -->
        <div style="background-color: #FAFAFA; font-size: large; color: #010614;">
            <div style="margin-left: 3%; margin-right: 3%;">
                <br>
                <!-- 1 -->
                <div class="row" style="margin-left: 32px;">
                    <div>
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-1-circle-fill" viewBox="0 0 16 16" style="color: #062558;">
                            <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0ZM9.283 4.002H7.971L6.072 5.385v1.271l1.834-1.318h.065V12h1.312V4.002Z"></path>
                        </svg>
                    </div>
                    <div class="col">
                        <p><span style="font-weight: 600;">layout.jade:</span> Contiene la información básica de diseño y estilo.</p>
                    </div>
                </div>

                <!-- 2 -->
                <div class="row" style="margin-left: 32px;">
                    <div>
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-2-circle-fill" viewBox="0 0 16 16" style="color: #062558;">
                            <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0ZM6.646 6.24c0-.691.493-1.306 1.336-1.306.756 0 1.313.492 1.313 1.236 0 .697-.469 1.23-.902 1.705l-2.971 3.293V12h5.344v-1.107H7.268v-.077l1.974-2.22.096-.107c.688-.763 1.287-1.428 1.287-2.43 0-1.266-1.031-2.215-2.613-2.215-1.758 0-2.637 1.19-2.637 2.402v.065h1.271v-.07Z"></path>
                        </svg>
                    </div>
                    <div class="col">
                        <p><span style="font-weight: 600;">index.jade:</span> Contiene la página de inicio de sesión que incluye el formulario de inicio de sesión y da la opción de crear una nueva cuenta.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Inicio de caja de código -->
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 5px 5px 0 0; display: flex; justify-content: space-between;">
            <span style="align-self: center;">Jade</span>
            <span style="align-self: center; cursor: pointer;" onclick="copyCodeToClipboard('codeContainerJade', 'copyTextJade', 'copyIconJade')">
                <span id="copyTextJade">Copiar código</span>
            </span>
        </div>
        <div style="background-color: #000; color: #fff; padding: 10px; border-radius: 0 0 5px 5px;">
            <pre id="codeContainerJade" style="background-color: #000; color: #fff; padding: 10px; font-size: large; margin-top: 0;">doctype html
html
head
title= title
link(rel='stylesheet', href='/stylesheets/style.css')
link(rel='stylesheet',</pre><pre id="codeContainerJade" style="background-color: #000; color: #fff; padding: 10px; font-size: large; margin-top: 0;"> href='http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css')
 body
 block content
            </pre>
        </div>
        <!-- Fin de caja de código -->

        <p><br></p>
        <p><span class="" style="font-size: large;">En </span><code><span class="" style="font-size: large;">views/index.jade</span></code><span class="" style="font-size: large;">:</span></p>

        <!-- Inicio de caja de código -->
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 5px 5px 0 0; display: flex; justify-content: space-between;">
            <span style="align-self: center;">Jade</span>
            <span style="align-self: center; cursor: pointer;" onclick="copyCodeToClipboard('codeContainerIndex', 'copyTextIndex', 'copyIconIndex')">
                <span id="copyTextIndex">Copiar código</span>
            </span>
        </div>
        <div style="background-color: #000; color: #fff; padding: 10px; border-radius: 0 0 5px 5px;">
            <pre id="codeContainerIndex" style="background-color: #000; color: #fff; padding: 10px; font-size: large; margin-top: 0;">extends layout
block content
div.container
div.row
div.col-sm-6.col-md-4.col-md-offset-4
h1.text-center.login-title Sign in to our Passport app
div.account-wall
img(class='profile-img',</pre><pre id="codeContainerIndex" style="background-color: #000; color: #fff; padding: 10px; font-size: large; margin-top: 0;">src='https://lh5.googleusercontent.com/-b0-k99FZlyE/photo.jpg?sz=120')
form(class='form-signin', action='/login', method='POST')
input(type='text', name='username', class='form-control', </pre><pre id="codeContainerIndex" style="background-color: #000; color: #fff; padding: 10px; font-size: large; margin-top: 0;">placeholder='Username', required, autofocus)
input(type='password', name='password', class='form-control', </pre><pre id="codeContainerIndex" style="background-color: #000; color: #fff; padding: 10px; font-size: large; margin-top: 0;">placeholder='Password', required)
button(class='btn btn-lg btn-primary btn-block', type='submit') </pre><pre id="codeContainerIndex" style="background-color: #000; color: #fff; padding: 10px; font-size: large; margin-top: 0;">Sign in
a(href='/signup', class='text-center new-account') Create an account
            </pre>
        </div>
        <!-- Fin de caja de código -->

        <p><span class="" style="font-size: large;"><br></span></p>
        <p><span class="" style="font-size: large;">Este código contiene una plantilla Jade que extiende de la otra plantilla </span><code><span class="" style="font-size: large;">layout</span></code><span class="" style="font-size: large;">, la cual contiene la estructura básica del HTML y los enlaces a hojas de estilo.</span></p>
    </div>

</div>

<!-- Script para copiar el código -->
<script>
    function copyCodeToClipboard(containerId, copyTextId) {
        const container = document.getElementById(containerId);
        const range = document.createRange();
        range.selectNode(container);
        window.getSelection().removeAllRanges();
        window.getSelection().addRange(range);
        document.execCommand('copy');
        window.getSelection().removeAllRanges();

        const copyText = document.getElementById(copyTextId);
        copyText.textContent = 'Copiado!';
        setTimeout(() => copyText.textContent = 'Copiar código', 1500);
    }
</script></div>
            </div>
            <div class="pb-5">
            <div class="book_chapter pt-3" id="ch209507"><!-- Título principal -->
<article class="flex_titulo_botonera" style="background-color: #E6E1E5;">
    <p class="titulo_principal">Continuando con vistas de Jade</p>
</article>

<div style="background-color: #FAFAFA; font-size: large; color: #010614;">
    <br>
    <div style="margin-left: 3%; margin-right: 3%;">

        <p>Necesitamos dos vistas más para los detalles de registro y para la página principal de la aplicación:</p>

        <!-- Sección numerada -->
        <div class="row" style="margin-left: 32px;">
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-1-circle-fill" viewBox="0 0 16 16" style="color: #062558;">
                    <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0ZM9.283 4.002H7.971L6.072 5.385v1.271l1.834-1.318h.065V12h1.312V4.002Z"></path>
                </svg>
            </div>
            <div class="col">
                <p><span style="font-weight: 600;">register.jade:</span> Contiene el formulario de registro.</p>
            </div>
        </div>

        <div class="row" style="margin-left: 32px;">
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-2-circle-fill" viewBox="0 0 16 16" style="color: #062558;">
                    <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0ZM6.646 6.24c0-.691.493-1.306 1.336-1.306.756 0 1.313.492 1.313 1.236 0 .697-.469 1.23-.902 1.705l-2.971 3.293V12h5.344v-1.107H7.268v-.077l1.974-2.22.096-.107c.688-.763 1.287-1.428 1.287-2.43 0-1.266-1.031-2.215-2.613-2.215-1.758 0-2.637 1.19-2.637 2.402v.065h1.271v-.07Z"></path>
                </svg>
            </div>
            <div class="col">
                <p><span style="font-weight: 600;">home.jade:</span> Dice hola y muestra los detalles del usuario.</p>
            </div>
        </div>

        <!-- Sección de vistas jade -->
        <p><span class="" style="font-size: large;">En </span><code><span class="" style="font-size: large;">views/register.jade</span></code><span class="" style="font-size: large;">:</span></p>

        <!-- Inicio de caja de código -->
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 5px 5px 0 0;">
            <span style="float: left;">Jade</span>
            <span style="float: right; cursor: pointer;" onclick="copyCodeToClipboard('codeContainerRegister', 'copyTextRegister', 'copyIconRegister')">
                <span id="copyTextRegister">Copiar código</span>
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16" id="copyIconRegister">
                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"></path>
                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"></path>
                </svg>
            </span>
        </div>
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 0;">
        </div>
        <div style="background-color: #000; color: #fff; padding: 10px; border-radius: 0 0 5px 5px;">
            <pre id="codeContainerRegister" style="background-color: #000; color: #fff; padding: 10px; font-size: large; margin-top: 0;">extends layout
block content
div.container
div.row
div.col-sm-6.col-md-4.col-md-offset-4
h1.text-center.login-title Registration Details
div.signup-wall
form(class='form-signin', action='/signup', method='POST')
input(type='text', name='username', class='form-control', </pre><pre id="codeContainerRegister" style="background-color: #000; color: #fff; padding: 10px; font-size: large; margin-top: 0;">placeholder='Username', required, autofocus)
input(type='password', name='password', class='form-control nomargin', </pre><pre id="codeContainerRegister" style="background-color: #000; color: #fff; padding: 10px; font-size: large; margin-top: 0;">placeholder='Password', required)
input(type='email', name='email', class='form-control', </pre><pre id="codeContainerRegister" style="background-color: #000; color: #fff; padding: 10px; font-size: large; margin-top: 0;">placeholder='Email', required)
input(type='text', name='firstName', class='form-control', </pre><pre id="codeContainerRegister" style="background-color: #000; color: #fff; padding: 10px; font-size: large; margin-top: 0;">placeholder='First Name', required)
input(type='text', name='lastName', class='form-control', </pre><pre id="codeContainerRegister" style="background-color: #000; color: #fff; padding: 10px; font-size: large; margin-top: 0;">placeholder='Last Name', required)
button(class='btn btn-lg btn-primary btn-block', type='submit') Register
span.clearfix
#message
if message
h1.text-center.error-message #{message}
            </pre>
        </div>
        <!-- Fin de caja de código -->

        <p><br></p><p><span class="" style="font-size: large;">Esta plantilla jade también extiende de la plantilla base </span><code><span class="" style="font-size: large;">layout</span></code><span class="" style="font-size: large;">. Al igual que en la plantilla anterior, se reemplaza el bloque </span><code><span class="" style="font-size: large;">content</span></code><span class="" style="font-size: large;"> de la plantilla base con una estructura de divs y un formulario de registro. En el formulario se incluyen campos de entrada para el nombre de usuario, la contraseña, el correo, el nombre y el apellido, y un botón para enviar el formulario.</span></p>

        <p style="text-align: center;"><img src="https://aulasvirtuales.bue.edu.ar/pluginfile.php/2801042/mod_book/chapter/209507/13.png" alt="Registro" width="695" height="580" class="img-responsive atto_image_button_text-bottom"></p>

        <p><span class="" style="font-size: large;">En </span><code><span class="" style="font-size: large;">views/home.jade</span></code><span class="" style="font-size: large;">:</span></p>

        <!-- Inicio de caja de código -->
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 5px 5px 0 0;">
            <span style="float: left;">Jade</span>
            <span style="float: right; cursor: pointer;" onclick="copyCodeToClipboard('codeContainerHome', 'copyTextHome', 'copyIconHome')">
                <span id="copyTextHome">Copiar código</span>
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16" id="copyIconHome">
                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"></path>
                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"></path>
                </svg>
            </span>
        </div>
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 0;">
        </div>
        <div style="background-color: #000; color: #fff; padding: 10px; border-radius: 0 0 5px 5px;">
            <pre id="codeContainerHome" style="background-color: #000; color: #fff; padding: 10px; font-size: large; margin-top: 0;">extends layout
block content
div.container
div.row
div.col-sm-6.col-md-4.col-md-offset-4
#user
h1.text-center.login-title Welcome #{user.firstName}.</pre><pre id="codeContainerHome" style="background-color: #000; color: #fff; padding: 10px; font-size: large; margin-top: 0;"> Check your details below:
 div.signup-wall
 ul.user-details
 li Username ---&gt; #{user.username}
 li Email  ---&gt; #{user.email}
 li First Name ---&gt; #{user.firstName}
 li Last Name ---&gt; #{user.lastName}
  a(href='/signout', class='text-center new-account') Sign Out
            </pre>
        </div>
        <!-- Fin de caja de código -->

        <p><br></p><p><span class="" style="font-size: large;">En esta plantilla se presenta una lista con los detalles del usuario: nombre de usuario, correo electrónico, nombre y apellido. También se incluye un enlace para cerrar sesión </span><span class="" style="color: rgb(0, 61, 245); font-size: large;">(</span><i><span class="" style="color: rgb(0, 61, 245); font-size: large;">Sign Out</span></i><span class="" style="color: rgb(0, 61, 245); font-size: large;">)</span><span class="" style="font-size: large;">. Se utiliza la sintaxis de interpolación </span><code><span class="" style="font-size: large;">#{}</span></code><span class="" style="font-size: large;"> para mostrar los valores de las variables dentro del HTML generado.</span></p>

    </div>
</div>

<!-- Script para copiar el código -->
<script>
    function copyCodeToClipboard(containerId, copyTextId, copyIconId) {
        var codeToCopy = document.getElementById(containerId).innerText;
        navigator.clipboard.writeText(codeToCopy).then(function() {
            var copyText = document.getElementById(copyTextId);
            var copyIcon = document.getElementById(copyIconId);
            copyText.textContent = 'Copiado';
            copyIcon.innerHTML = `
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check" viewBox="0 0 16 16">
                <path fill-rule="evenodd" d="M10.854 7.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7.5 9.793l2.646-2.647a.5.5 0 0 1 .708 0"/>
                <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"/>
                <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"/>
            </svg>`;
            setTimeout(function() {
                copyText.textContent = 'Copiar código';
                copyIcon.innerHTML = `
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16">
                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"/>
                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"/>
                </svg>`;
            }, 2000);
        });
    }
</script></div>
            </div>
            <div class="pb-5">
            <div class="book_chapter pt-3" id="ch209508"><!-- Título principal -->
<article class="flex_titulo_botonera" style="background-color: #E6E1E5;">
    <p class="titulo_principal">Implementación de la funcionalidad de cierre de sesión</p>
</article>

<div style="background-color: #FAFAFA; font-size: large; color: #010614;">
    <br>
    <div style="margin-left: 3%; margin-right: 3%;">

        <p><span class="" style="font-size: large;">Se le permite a Passport, middleware, agregar ciertas propiedades y métodos a objetos de solicitud y respuesta, y hace un uso adecuado de la misma agregando un método muy útil </span><code><span class="" style="font-size: large;">request.logout()</span></code><span class="" style="font-size: large;"> que invalida la sesión de usuario, además de otras propiedades.</span></p>

        <p><span class="" style="font-size: large;">En </span><code><span class="" style="font-size: large;">routes/index.js</span></code><span class="" style="font-size: large;">:</span></p>

        <!-- Inicio de caja de código -->
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 5px 5px 0 0;">
            <span style="float: left;">JavaScript</span>
            <span style="float: right; cursor: pointer;" onclick="copyCodeToClipboard('codeContainerLogout', 'copyTextLogout', 'copyIconLogout')">
                <span id="copyTextLogout">Copiar código</span>
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16" id="copyIconLogout">
                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"></path>
                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"></path>
                </svg>
            </span>
        </div>
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 0;">
        </div>
        <div style="background-color: #000; color: #fff; padding: 10px; border-radius: 0 0 5px 5px;">
            <pre id="codeContainerLogout" style="background-color: #000; color: #fff; padding: 10px; font-size: large; margin-top: 0;">router.get('/signout', function (req, res, next) {
    req.logout();
    res.redirect('/');
});
            </pre>
        </div>
        <!-- Fin de caja de código -->

    </div>
</div>

<!-- Script para copiar el código -->
<script>
    function copyCodeToClipboard(containerId, copyTextId, copyIconId) {
        var codeToCopy = document.getElementById(containerId).innerText;
        navigator.clipboard.writeText(codeToCopy).then(function() {
            var copyText = document.getElementById(copyTextId);
            var copyIcon = document.getElementById(copyIconId);
            copyText.textContent = 'Copiado';
            copyIcon.innerHTML = `
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check" viewBox="0 0 16 16">
                <path fill-rule="evenodd" d="M10.854 7.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7.5 9.793l2.646-2.647a.5.5 0 0 1 .708 0"/>
                <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"/>
                <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"/>
            </svg>`;
            setTimeout(function() {
                copyText.textContent = 'Copiar código';
                copyIcon.innerHTML = `
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16">
                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"/>
                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"/>
                </svg>`;
            }, 2000);
        });
    }
</script></div>
            </div>
            <div class="pb-5">
            <div class="book_chapter pt-3" id="ch209509"><!-- Título principal -->
<article class="flex_titulo_botonera" style="background-color: #E6E1E5;">
    <p class="titulo_principal">Proteger las rutas</p>
</article>

<div style="background-color: #FAFAFA; font-size: large; color: #010614;">
    <br>
    <div style="margin-left: 3%; margin-right: 3%;">

        <p><span class="" style="font-size: large;"><span class="" style="color: rgb(0, 61, 245);">Passport</span> también nos da la posibilidad de proteger el acceso a una ruta que se considera no apta para un usuario anónimo. Esto significa que si algún usuario intenta acceder a </span><span style="color: rgb(0, 46, 184);"><u><span class="" style="font-size: large;">http://localhost:8000/home</span></u></span><span class="" style="font-size: large;"> sin autenticarse en la aplicación, será redirigido a la página principal.</span></p>

        <p><span class="" style="font-size: large;">En </span><code><span class="" style="font-size: large;">routes/index.js</span></code><span class="" style="font-size: large;">:</span></p>

        <!-- Inicio de caja de código -->
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 5px 5px 0 0;">
            <span style="float: left;">JavaScript</span>
            <span style="float: right; cursor: pointer;" onclick="copyCodeToClipboard('codeContainerRoutes', 'copyTextRoutes', 'copyIconRoutes')">
                <span id="copyTextRoutes">Copiar código</span>
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16" id="copyIconRoutes">
                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"></path>
                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"></path>
                </svg>
            </span>
        </div>
        <div style="background-color: #444; color: #fff; padding: 10px; border-radius: 0;">
        </div>
        <div style="background-color: #000; color: #fff; padding: 10px; border-radius: 0 0 5px 5px;">
            <pre id="codeContainerRoutes" style="background-color: #000; color: #fff; padding: 10px; font-size: large; margin-top: 0;">var express = require('express');
var router = express.Router();

var isAuthenticated = function (req, res, next) {
    if (req.isAuthenticated()) return next();
    res.redirect('/');
};

module.exports = function (passport) {
    router.get('/', function (req, res) {
        res.render('index', { message: req.flash('message') });
    });

    router.post('/login',
        passport.authenticate('login', {
            successRedirect: '/home',
            failureRedirect: '/',
            failureFlash: true
        })
    );

    router.get('/signup', function (req, res) {
        res.render('register', { message: req.flash('message') });
    });

    router.post('/signup',
        passport.authenticate('signup', {
            successRedirect: '/home',
            failureRedirect: '/signup',
            failureFlash: true
        })
    );

    router.get('/home', isAuthenticated, function (req, res) {
        res.render('home', { user: req.user });
    });

    router.get('/signout', function (req, res) {
        req.logout();
        res.redirect('/');
    });

    return router;
};
            </pre>
        </div>
        <!-- Fin de caja de código -->

    </div>
</div>

<!-- Script para copiar el código -->
<script>
    function copyCodeToClipboard(containerId, copyTextId, copyIconId) {
        var codeToCopy = document.getElementById(containerId).innerText;
        navigator.clipboard.writeText(codeToCopy).then(function() {
            var copyText = document.getElementById(copyTextId);
            var copyIcon = document.getElementById(copyIconId);
            copyText.textContent = 'Copiado';
            copyIcon.innerHTML = `
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check" viewBox="0 0 16 16">
                <path fill-rule="evenodd" d="M10.854 7.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7.5 9.793l2.646-2.647a.5.5 0 0 1 .708 0"/>
                <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"/>
                <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"/>
            </svg>`;
            setTimeout(function() {
                copyText.textContent = 'Copiar código';
                copyIcon.innerHTML = `
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16">
                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"/>
                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"/>
                </svg>`;
            }, 2000);
        });
    }
</script></div>
            </div>
            <div class="pb-5">
            <div class="book_chapter pt-3" id="ch209510"><!-- Título principal -->
<article class="flex_titulo_botonera" style="background-color: #E6E1E5;">
    <p class="titulo_principal">Probar la aplicación con Passport</p>
</article>

<div style="background-color: #FAFAFA; font-size: large; color: #010614;">
    <br>
    <div style="margin-left: 3%; margin-right: 3%;">

        <p>Si ingresamos a <span style="color: rgb(0, 46, 184);"><u>http://localhost:3000</u></span> podremos ver que se renderiza la plantilla de <span class="" style="color: rgb(0, 61, 245);">Jade</span> con el formulario para iniciar sesión:</p>

        <!-- Imagen del formulario de inicio de sesión -->
        <p dir="ltr" style="text-align: center;">
            <img src="https://aulasvirtuales.bue.edu.ar/pluginfile.php/2801042/mod_book/chapter/209510/14.png" alt="" width="695" height="580" role="presentation" class="img-responsive atto_image_button_text-bottom">
        </p>

        <p>Además, tenemos un link “<span class="" style="color: rgb(0, 61, 245);">Create an account</span>” para acceder a la otra plantilla que nos permite registrar un usuario, en <span style="color: rgb(0, 46, 184);"><u>http://localhost:3000/signup</u></span>:</p>
        
        <!-- Imagen del formulario de registro -->
        <p dir="ltr" style="text-align: center;">
            <img src="https://aulasvirtuales.bue.edu.ar/pluginfile.php/2801042/mod_book/chapter/209510/15.png" alt="" width="695" height="580" role="presentation" class="img-responsive atto_image_button_text-bottom">
        </p>

        <p>Vamos a registrar un usuario. Veremos cómo al completar los campos y hacer clic en <span class="" style="color: rgb(0, 61, 245);">“register</span>” se carga nuestro usuario en la base de datos y se nos redirige a la página <span style="color: rgb(0, 46, 184);"><u>http://localhost:3000/home</u></span> donde podremos ver los datos del usuario registrado:</p>
        
        <!-- Imagen de los datos del usuario registrado -->
        <p dir="ltr" style="text-align: center;">
            <img src="https://aulasvirtuales.bue.edu.ar/pluginfile.php/2801042/mod_book/chapter/209510/16.png" alt="" width="695" height="580" role="presentation" class="img-responsive atto_image_button_text-bottom">
        </p>

        <p>Podemos observar que, si recargamos la página, la sesión permanece activa igualmente.</p>
        <p>Si hacemos clic en "Sign out", haremos una petición a la ruta <span style="color: rgb(0, 46, 184);">/signout</span>, la cual nos permitirá cerrar la sesión correspondiente.</p>

    </div>
</div>

<!-- Script para copiar el código -->
<script>
    function copyCodeToClipboard(containerId, copyTextId, copyIconId) {
        var codeToCopy = document.getElementById(containerId).innerText;
        navigator.clipboard.writeText(codeToCopy).then(function() {
            var copyText = document.getElementById(copyTextId);
            var copyIcon = document.getElementById(copyIconId);
            copyText.textContent = 'Copiado';
            copyIcon.innerHTML = `
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check" viewBox="0 0 16 16">
                <path fill-rule="evenodd" d="M10.854 7.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7.5 9.793l2.646-2.647a.5.5 0 0 1 .708 0"/>
                <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"/>
                <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"/>
            </svg>`;
            setTimeout(function() {
                copyText.textContent = 'Copiar código';
                copyIcon.innerHTML = `
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16">
                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"/>
                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"/>
                </svg>`;
            }, 2000);
        });
    }
</script></div>
            </div>
    </div>
</div><div id="format-tiles-js-config"  data-modalAllowedModNames="[&quot;page&quot;,&quot;pdf&quot;,&quot;url&quot;,&quot;html&quot;]" data-modalAllowedCmids="[712824,712825,712839,712840,712841,712842,712843,712844,712845,712846,712849,712850,712858,712859,712860,712862,712865,712866,712869,712870,712873,712874,712877,712878,712881,712882,712885,712886,712889,712890,712892,712894,712897,712898,712901]" data-defaultcourseicon="pie-chart"></div></div>
    </section>
</div>
<script>
//<![CDATA[
var require = {
    baseUrl : 'https://aulasvirtuales.bue.edu.ar/lib/requirejs.php/1757558299/',
    // We only support AMD modules with an explicit define() statement.
    enforceDefine: true,
    skipDataMain: true,
    waitSeconds : 0,

    paths: {
        jquery: 'https://aulasvirtuales.bue.edu.ar/lib/javascript.php/1757558299/lib/jquery/jquery-3.6.1.min',
        jqueryui: 'https://aulasvirtuales.bue.edu.ar/lib/javascript.php/1757558299/lib/jquery/ui-1.13.2/jquery-ui.min',
        jqueryprivate: 'https://aulasvirtuales.bue.edu.ar/lib/javascript.php/1757558299/lib/requirejs/jquery-private'
    },

    // Custom jquery config map.
    map: {
      // '*' means all modules will get 'jqueryprivate'
      // for their 'jquery' dependency.
      '*': { jquery: 'jqueryprivate' },
      // Stub module for 'process'. This is a workaround for a bug in MathJax (see MDL-60458).
      '*': { process: 'core/first' },

      // 'jquery-private' wants the real jQuery module
      // though. If this line was not here, there would
      // be an unresolvable cyclic dependency.
      jqueryprivate: { jquery: 'jquery' }
    }
};

//]]>
</script>
<script src="https://aulasvirtuales.bue.edu.ar/lib/javascript.php/1757558299/lib/requirejs/require.min.js"></script>
<script>
//<![CDATA[
M.util.js_pending("core/first");
require(['core/first'], function() {
require(['core/prefetch'])
;
require(["media_videojs/loader"], function(loader) {
    loader.setUp('es');
});;
M.util.js_pending('theme_academiaba/theme'); require(['theme_academiaba/theme'], function(amd) {M.util.js_complete('theme_academiaba/theme');});;

M.util.js_pending('theme_boost/loader');
require(['theme_boost/loader'], function() {
  M.util.js_complete('theme_boost/loader');
});
;
M.util.js_pending('core/notification'); require(['core/notification'], function(amd) {amd.init(2801042, []); M.util.js_complete('core/notification');});;
M.util.js_pending('core/log'); require(['core/log'], function(amd) {amd.setConfig({"level":"trace"}); M.util.js_complete('core/log');});;
M.util.js_pending('core/page_global'); require(['core/page_global'], function(amd) {amd.init(); M.util.js_complete('core/page_global');});;
M.util.js_pending('core/utility'); require(['core/utility'], function(amd) {M.util.js_complete('core/utility');});;
M.util.js_pending('core/storage_validation'); require(['core/storage_validation'], function(amd) {amd.init(1760959197); M.util.js_complete('core/storage_validation');});
    M.util.js_complete("core/first");
});
//]]>
</script>
<script src="https://aulasvirtuales.bue.edu.ar/lib/javascript.php/1757558299/lib/editor/atto/plugins/htmlbootstrapeditor/content.js"></script>
<script src="https://aulasvirtuales.bue.edu.ar/lib/javascript.php/1757558299/admin/tool/htmlbootstrapeditor/content.js"></script>
<script src="https://aulasvirtuales.bue.edu.ar/lib/javascript.php/1757558299/admin/tool/htmlbootstrapeditor/editor.js"></script>
<script>
//<![CDATA[
M.str = {"moodle":{"lastmodified":"\u00daltima modificaci\u00f3n","name":"Nombre","error":"Error","info":"Informaci\u00f3n","yes":"S\u00ed","no":"No","cancel":"Cancelar","confirm":"Confirmar","areyousure":"\u00bfEst\u00e1 seguro?","closebuttontitle":"Cerrar","unknownerror":"Error desconocido","file":"Archivo","url":"URL","collapseall":"Colapsar todo","expandall":"Expandir todo"},"repository":{"type":"Tipo","size":"Tama\u00f1o","invalidjson":"Cadena JSON no v\u00e1lida","nofilesattached":"No se han adjuntado archivos","filepicker":"Selector de archivos","logout":"Salir","nofilesavailable":"No hay archivos disponibles","norepositoriesavailable":"Lo sentimos, ninguno de sus repositorios actuales puede devolver archivos en el formato solicitado.","fileexistsdialogheader":"El archivo existe","fileexistsdialog_editor":"Un archivo con ese nombre ha sido anexado al texto que Usted est\u00e1 editando","fileexistsdialog_filemanager":"Ya ha sido anexado un archivo con ese nombre","renameto":"Cambiar el nombre a \"{$a}\"","referencesexist":"Existen {$a} enlaces a este archivo","select":"Seleccionar"},"admin":{"confirmdeletecomments":"Est\u00e1 a punto de eliminar comentarios, \u00bfest\u00e1 seguro?","confirmation":"Confirmaci\u00f3n"},"debug":{"debuginfo":"Informaci\u00f3n de depuraci\u00f3n","line":"L\u00ednea","stacktrace":"Trazado de la pila (stack)"},"langconfig":{"labelsep":":"}};
//]]>
</script>
<script>
//<![CDATA[
(function() {Y.use("moodle-filter_mathjaxloader-loader",function() {M.filter_mathjaxloader.configure({"mathjaxconfig":"MathJax.Hub.Config({\r\nconfig: [\"Accessible.js\", \"Safe.js\"],\r\nerrorSettings: { message: [\"!\"] },\r\nskipStartupTypeset: true,\r\nmessageStyle: \"none\"\r\n});","lang":"es"});
});
M.util.help_popups.setup(Y);
 M.util.js_pending('random68f61bd4f03942'); Y.on('domready', function() { M.util.js_complete("init");  M.util.js_complete('random68f61bd4f03942'); });
})();
//]]>
</script>

</body>
</html>